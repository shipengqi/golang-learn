<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="åŸºäº GitHub Actions çš„ CI/CD # GitHub Actions æ˜¯ GitHub ä¸ºæ‰˜ç®¡åœ¨ github.com ç«™ç‚¹çš„é¡¹ç›®æä¾›çš„æŒç»­é›†æˆæœåŠ¡ã€‚
åœ¨æ„å»ºæŒç»­é›†æˆä»»åŠ¡æ—¶ï¼Œéœ€è¦å®Œæˆå¾ˆå¤šæ“ä½œï¼Œæ¯”å¦‚å…‹éš†ä»£ç ã€ç¼–è¯‘ä»£ç ã€è¿è¡Œå•å…ƒæµ‹è¯•ã€æ„å»ºå’Œå‘å¸ƒé•œåƒç­‰ã€‚GitHub æŠŠè¿™äº›æ“ä½œç§°ä¸º Actionsã€‚
Actions æ˜¯å¯ä»¥å…±äº«çš„ï¼Œå¼€å‘è€…å¯ä»¥å°† Actions ä¸Šä¼ åˆ° GitHub çš„ Actions å¸‚åœºã€‚å¦‚æœéœ€è¦æŸä¸ª Actionï¼Œç›´æ¥å¼•ç”¨å³å¯ã€‚ æ•´ä¸ªæŒç»­é›†æˆè¿‡ç¨‹ï¼Œå°±å˜æˆäº†ä¸€ä¸ª Actions çš„ç»„åˆã€‚
Action å…¶å®æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¯ä»¥å°† Action å­˜æ”¾åœ¨ GitHub ä»£ç ä»“åº“ä¸­ï¼Œé€šè¿‡ <userName>/<repoName> çš„è¯­æ³•å¼•ç”¨ Actionã€‚ä¾‹å¦‚ï¼Œactions/checkout@v2 è¡¨ç¤º https://github.com/actions/checkout è¿™ä¸ªä»“åº“ï¼Œtag æ˜¯ v2ã€‚
GitHub Actions æœ¯è¯­ # workflowï¼šä¸€ä¸ª .yml æ–‡ä»¶å¯¹åº”ä¸€ä¸ª workflowï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æŒç»­é›†æˆã€‚ä¸€ä¸ª GitHub ä»“åº“å¯ä»¥åŒ…å«å¤šä¸ª workflowï¼Œåªè¦æ˜¯åœ¨ .github/workflow ç›®å½•ä¸‹çš„ .yml æ–‡ä»¶éƒ½ä¼šè¢« GitHub æ‰§è¡Œã€‚ jobï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª job æ„æˆï¼Œæ¯ä¸ª job ä»£è¡¨ä¸€ä¸ªæŒç»­é›†æˆä»»åŠ¡ã€‚ stepï¼šæ¯ä¸ª job ç”±å¤šä¸ª step æ„æˆï¼Œä¸€æ­¥æ­¥å®Œæˆã€‚ actionï¼šæ¯ä¸ª step å¯ä»¥ä¾æ¬¡æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼ˆactionï¼‰ã€‚ onï¼šä¸€ä¸ª workflow çš„è§¦å‘æ¡ä»¶ï¼Œå†³å®šäº†å½“å‰çš„ workflow åœ¨ä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œã€‚ workflow # GitHub Actions é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ä»£ç ä»“åº“çš„ ."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="GitHub Actions"><meta property="og:description" content="åŸºäº GitHub Actions çš„ CI/CD # GitHub Actions æ˜¯ GitHub ä¸ºæ‰˜ç®¡åœ¨ github.com ç«™ç‚¹çš„é¡¹ç›®æä¾›çš„æŒç»­é›†æˆæœåŠ¡ã€‚
åœ¨æ„å»ºæŒç»­é›†æˆä»»åŠ¡æ—¶ï¼Œéœ€è¦å®Œæˆå¾ˆå¤šæ“ä½œï¼Œæ¯”å¦‚å…‹éš†ä»£ç ã€ç¼–è¯‘ä»£ç ã€è¿è¡Œå•å…ƒæµ‹è¯•ã€æ„å»ºå’Œå‘å¸ƒé•œåƒç­‰ã€‚GitHub æŠŠè¿™äº›æ“ä½œç§°ä¸º Actionsã€‚
Actions æ˜¯å¯ä»¥å…±äº«çš„ï¼Œå¼€å‘è€…å¯ä»¥å°† Actions ä¸Šä¼ åˆ° GitHub çš„ Actions å¸‚åœºã€‚å¦‚æœéœ€è¦æŸä¸ª Actionï¼Œç›´æ¥å¼•ç”¨å³å¯ã€‚ æ•´ä¸ªæŒç»­é›†æˆè¿‡ç¨‹ï¼Œå°±å˜æˆäº†ä¸€ä¸ª Actions çš„ç»„åˆã€‚
Action å…¶å®æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¯ä»¥å°† Action å­˜æ”¾åœ¨ GitHub ä»£ç ä»“åº“ä¸­ï¼Œé€šè¿‡ <userName>/<repoName> çš„è¯­æ³•å¼•ç”¨ Actionã€‚ä¾‹å¦‚ï¼Œactions/checkout@v2 è¡¨ç¤º https://github.com/actions/checkout è¿™ä¸ªä»“åº“ï¼Œtag æ˜¯ v2ã€‚
GitHub Actions æœ¯è¯­ # workflowï¼šä¸€ä¸ª .yml æ–‡ä»¶å¯¹åº”ä¸€ä¸ª workflowï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æŒç»­é›†æˆã€‚ä¸€ä¸ª GitHub ä»“åº“å¯ä»¥åŒ…å«å¤šä¸ª workflowï¼Œåªè¦æ˜¯åœ¨ .github/workflow ç›®å½•ä¸‹çš„ .yml æ–‡ä»¶éƒ½ä¼šè¢« GitHub æ‰§è¡Œã€‚ jobï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª job æ„æˆï¼Œæ¯ä¸ª job ä»£è¡¨ä¸€ä¸ªæŒç»­é›†æˆä»»åŠ¡ã€‚ stepï¼šæ¯ä¸ª job ç”±å¤šä¸ª step æ„æˆï¼Œä¸€æ­¥æ­¥å®Œæˆã€‚ actionï¼šæ¯ä¸ª step å¯ä»¥ä¾æ¬¡æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼ˆactionï¼‰ã€‚ onï¼šä¸€ä¸ª workflow çš„è§¦å‘æ¡ä»¶ï¼Œå†³å®šäº†å½“å‰çš„ workflow åœ¨ä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œã€‚ workflow # GitHub Actions é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ä»£ç ä»“åº“çš„ ."><meta property="og:type" content="article"><meta property="og:url" content="https://shipengqi.github.io/golang-learn/docs/project/09_actions/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-12-03T21:59:10+08:00"><title>GitHub Actions | Go Learning</title><link rel=manifest href=/golang-learn/manifest.json><link rel=icon href=/golang-learn/favicon.png><link rel=stylesheet href=/golang-learn/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/golang-learn/flexsearch.min.js></script>
<script defer src=/golang-learn/en.search.min.fe92e04ba07cc0f41f6a75f1c80d85bf2fac1dc49d6e5098de44895faeebc1f1.js integrity="sha256-/pLgS6B8wPQfanXxyA2Fvy+sHcSdblCY3kSJX67rwfE=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/golang-learn/><span>Go Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/golang-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><span>ğŸš è¯­è¨€åŸºç¡€</span><ul><li><a href=/golang-learn/docs/basic/01_basic_type/>åŸºç¡€æ•°æ®ç±»å‹</a></li><li><a href=/golang-learn/docs/basic/02_array/>æ•°ç»„</a></li><li><a href=/golang-learn/docs/basic/03_slice/>åˆ‡ç‰‡</a></li><li><a href=/golang-learn/docs/basic/04_map/>å“ˆå¸Œè¡¨</a></li><li><a href=/golang-learn/docs/basic/05_function/>å‡½æ•°</a></li><li><a href=/golang-learn/docs/basic/09_pointer/>æŒ‡é’ˆ</a></li></ul></li><li><a href=/golang-learn/docs/concurrency/>âš¡ å¹¶å‘ç¼–ç¨‹</a><ul><li><a href=/golang-learn/docs/concurrency/01_mutex/>äº’æ–¥é”</a></li><li><a href=/golang-learn/docs/concurrency/02_rwmutex/>è¯»å†™é”</a></li><li><a href=/golang-learn/docs/concurrency/03_waitgroup/>WaitGroup</a></li><li><a href=/golang-learn/docs/concurrency/04_cond/>æ¡ä»¶å˜é‡</a></li><li><a href=/golang-learn/docs/concurrency/05_once/>Once</a></li><li><a href=/golang-learn/docs/concurrency/06_pool/>Pool</a></li><li><a href=/golang-learn/docs/concurrency/07_context/>Context</a></li><li><a href=/golang-learn/docs/concurrency/08_atomic/>åŸå­æ“ä½œ</a></li><li><a href=/golang-learn/docs/concurrency/09_channel/>Channel</a></li><li><a href=/golang-learn/docs/concurrency/10_sema/>ä¿¡å·é‡</a></li><li><a href=/golang-learn/docs/concurrency/11_singleflight/>SingleFlight</a></li><li><a href=/golang-learn/docs/concurrency/12_errorgroup/>ErrGroup</a></li></ul></li><li><span>ğŸ› ï¸ å®è·µ</span><ul><li><a href=/golang-learn/docs/practice/01_build/>Go ç¼–è¯‘</a></li><li><a href=/golang-learn/docs/practice/02_go_race/>Go æ•°æ®ç«äº‰æ£€æµ‹å™¨</a></li><li><a href=/golang-learn/docs/practice/04_pprof/>Go æ€§èƒ½åˆ†æï¼ˆä¸Šï¼‰</a></li><li><a href=/golang-learn/docs/practice/05_trace/>Go æ€§èƒ½åˆ†æï¼ˆä¸‹ï¼‰</a></li><li><a href=/golang-learn/docs/practice/06_performance/>Go æ€§èƒ½ä¼˜åŒ–</a></li><li><a href=/golang-learn/docs/practice/07_coredump/>Go Core Dump è°ƒè¯•</a></li><li><a href=/golang-learn/docs/practice/08_mod/>Go Modules</a></li><li><a href=/golang-learn/docs/practice/09_gin/>Gin é™æ€æœåŠ¡å™¨</a></li><li><a href=/golang-learn/docs/practice/10_remote_dev/>Go è¿œç¨‹å¼€å‘è°ƒè¯•</a></li></ul></li><li><span>ğŸ› ï¸ Go å·¥ç¨‹å®è·µ</span><ul><li><a href=/golang-learn/docs/project/01_specs/>é¡¹ç›®è§„èŒƒ</a></li><li><a href=/golang-learn/docs/project/02_structure/>é¡¹ç›®çš„ç›®å½•ç»“æ„</a></li><li><a href=/golang-learn/docs/project/03_code/>ä»£ç è§„èŒƒ</a></li><li><a href=/golang-learn/docs/project/04_commitizen/>Commit è§„èŒƒ</a></li><li><a href=/golang-learn/docs/project/05_version/>ç‰ˆæœ¬è§„èŒƒ</a></li><li><a href=/golang-learn/docs/project/06_api_doc/>API æ–‡æ¡£</a></li><li><a href=/golang-learn/docs/project/07_flow/>Git å·¥ä½œæµç¨‹</a></li><li><a href=/golang-learn/docs/project/08_make/>é¡¹ç›®ç®¡ç†</a></li><li><a href=/golang-learn/docs/project/09_actions/ class=active>GitHub Actions</a></li><li><a href=/golang-learn/docs/project/10_dependabot/>GitHub Dependabot</a></li><li><a href=/golang-learn/docs/project/11_templates/>GitHub æ¨¡æ¿</a></li><li><a href=/golang-learn/docs/project/12_goreleaser/>GoReleaser</a></li></ul></li><li><a href=/golang-learn/docs/advance/>ğŸ” åº•å±‚åŸç†</a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/golang-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>GitHub Actions</strong>
<label for=toc-control><img src=/golang-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#åŸºäº-github-actions-çš„-cicd>åŸºäº GitHub Actions çš„ CI/CD</a><ul><li><a href=#github-actions-æœ¯è¯­>GitHub Actions æœ¯è¯­</a></li><li><a href=#workflow>workflow</a><ul><li><a href=#åŸºç¡€é…ç½®>åŸºç¡€é…ç½®</a></li><li><a href=#è®¾ç½®-job-çš„ä¾èµ–å…³ç³»>è®¾ç½® job çš„ä¾èµ–å…³ç³»</a></li><li><a href=#ä½¿ç”¨æ„å»ºçŸ©é˜µ>ä½¿ç”¨æ„å»ºçŸ©é˜µ</a></li><li><a href=#ä½¿ç”¨-secrets>ä½¿ç”¨ Secrets</a></li></ul></li><li><a href=#å¸¸ç”¨-actions>å¸¸ç”¨ actions</a><ul><li><a href=#é™æ€ä»£ç æ£€æŸ¥>é™æ€ä»£ç æ£€æŸ¥</a></li><li><a href=#è‡ªåŠ¨å‘å¸ƒ>è‡ªåŠ¨å‘å¸ƒ</a></li><li><a href=#ä½¿ç”¨-artifact-å­˜å‚¨æ–‡ä»¶>ä½¿ç”¨ Artifact å­˜å‚¨æ–‡ä»¶</a></li><li><a href=#ä½¿ç”¨ç¼“å­˜åŠ å¿«-workflow>ä½¿ç”¨ç¼“å­˜åŠ å¿« workflow</a></li><li><a href=#è‡ªåŠ¨æ‰“-label>è‡ªåŠ¨æ‰“ Label</a></li><li><a href=#åœ¨ä¸€ä¸ª-pr-åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨-assign-reviewer>åœ¨ä¸€ä¸ª PR åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨ assign reviewer</a></li><li><a href=#å…³é—­ä¸æ´»è·ƒçš„-issue-å’Œ-pr>å…³é—­ä¸æ´»è·ƒçš„ Issue å’Œ PR</a></li><li><a href=#ä½¿ç”¨-gitleaks-è¿›è¡Œé™æ€ä»£ç åˆ†æ>ä½¿ç”¨ Gitleaks è¿›è¡Œé™æ€ä»£ç åˆ†æ</a></li><li><a href=#ä½¿ç”¨-grype-æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´>ä½¿ç”¨ Grype æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´</a></li><li><a href=#ä½¿ç”¨-codeql-è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ>ä½¿ç”¨ CodeQL è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ</a></li><li><a href=#è‡ªåŠ¨æäº¤-action-è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶>è‡ªåŠ¨æäº¤ action è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶</a></li><li><a href=#æ‰«æ-pr-ä¸­çš„ä¾èµ–å…³ç³»>æ‰«æ PR ä¸­çš„ä¾èµ–å…³ç³»</a></li><li><a href=#å¦‚ä½•åœ¨-action-ä¸­è®¿é—®-github>å¦‚ä½•åœ¨ Action ä¸­è®¿é—® GitHub</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=åŸºäº-github-actions-çš„-cicd>åŸºäº GitHub Actions çš„ CI/CD
<a class=anchor href=#%e5%9f%ba%e4%ba%8e-github-actions-%e7%9a%84-cicd>#</a></h1><p>GitHub Actions æ˜¯ GitHub ä¸ºæ‰˜ç®¡åœ¨ github.com ç«™ç‚¹çš„é¡¹ç›®æä¾›çš„æŒç»­é›†æˆæœåŠ¡ã€‚</p><p>åœ¨æ„å»ºæŒç»­é›†æˆä»»åŠ¡æ—¶ï¼Œéœ€è¦å®Œæˆå¾ˆå¤šæ“ä½œï¼Œæ¯”å¦‚å…‹éš†ä»£ç ã€ç¼–è¯‘ä»£ç ã€è¿è¡Œå•å…ƒæµ‹è¯•ã€æ„å»ºå’Œå‘å¸ƒé•œåƒç­‰ã€‚GitHub æŠŠè¿™äº›æ“ä½œç§°ä¸º Actionsã€‚</p><p>Actions æ˜¯å¯ä»¥å…±äº«çš„ï¼Œå¼€å‘è€…å¯ä»¥å°† Actions ä¸Šä¼ åˆ° GitHub çš„ <a href="https://github.com/marketplace?type=actions">Actions å¸‚åœº</a>ã€‚å¦‚æœéœ€è¦æŸä¸ª Actionï¼Œç›´æ¥å¼•ç”¨å³å¯ã€‚
æ•´ä¸ªæŒç»­é›†æˆè¿‡ç¨‹ï¼Œå°±å˜æˆäº†ä¸€ä¸ª Actions çš„ç»„åˆã€‚</p><p>Action å…¶å®æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œå¯ä»¥å°† Action å­˜æ”¾åœ¨ GitHub ä»£ç ä»“åº“ä¸­ï¼Œé€šè¿‡ <code>&lt;userName>/&lt;repoName></code> çš„è¯­æ³•å¼•ç”¨ Actionã€‚ä¾‹å¦‚ï¼Œ<code>actions/checkout@v2</code> è¡¨ç¤º <code>https://github.com/actions/checkout</code> è¿™ä¸ªä»“åº“ï¼Œ<code>tag</code> æ˜¯ <code>v2</code>ã€‚</p><h2 id=github-actions-æœ¯è¯­>GitHub Actions æœ¯è¯­
<a class=anchor href=#github-actions-%e6%9c%af%e8%af%ad>#</a></h2><ul><li><code>workflow</code>ï¼šä¸€ä¸ª <code>.yml</code> æ–‡ä»¶å¯¹åº”ä¸€ä¸ª workflowï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡æŒç»­é›†æˆã€‚ä¸€ä¸ª GitHub ä»“åº“å¯ä»¥åŒ…å«å¤šä¸ª workflowï¼Œåªè¦æ˜¯åœ¨ <code>.github/workflow</code> ç›®å½•ä¸‹çš„
<code>.yml</code> æ–‡ä»¶éƒ½ä¼šè¢« GitHub æ‰§è¡Œã€‚</li><li><code>job</code>ï¼šä¸€ä¸ª workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª <code>job</code> æ„æˆï¼Œæ¯ä¸ª <code>job</code> ä»£è¡¨ä¸€ä¸ªæŒç»­é›†æˆä»»åŠ¡ã€‚</li><li><code>step</code>ï¼šæ¯ä¸ª <code>job</code> ç”±å¤šä¸ª <code>step</code> æ„æˆï¼Œä¸€æ­¥æ­¥å®Œæˆã€‚</li><li><code>action</code>ï¼šæ¯ä¸ª <code>step</code> å¯ä»¥ä¾æ¬¡æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼ˆactionï¼‰ã€‚</li><li><code>on</code>ï¼šä¸€ä¸ª workflow çš„è§¦å‘æ¡ä»¶ï¼Œå†³å®šäº†å½“å‰çš„ workflow åœ¨ä»€ä¹ˆæ—¶å€™è¢«æ‰§è¡Œã€‚</li></ul><h2 id=workflow>workflow
<a class=anchor href=#workflow>#</a></h2><p>GitHub Actions é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ä»£ç ä»“åº“çš„ <code>.github/workflows</code> ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åç¼€ä¸º <code>.yml</code>ã€<code>.yaml</code>ã€‚GitHub åªè¦å‘ç° <code>.github/workflows</code> ç›®å½•é‡Œé¢æœ‰ <code>.yml</code> æ–‡ä»¶ï¼Œå°±ä¼šè‡ªåŠ¨è¿è¡Œè¯¥æ–‡ä»¶ã€‚</p><h3 id=åŸºç¡€é…ç½®>åŸºç¡€é…ç½®
<a class=anchor href=#%e5%9f%ba%e7%a1%80%e9%85%8d%e7%bd%ae>#</a></h3><ul><li><code>name</code> æ˜¯ workflow çš„åç§°ã€‚å¦‚æœçœç•¥è¯¥å­—æ®µï¼Œé»˜è®¤ä¸ºå½“å‰ workflow çš„æ–‡ä»¶åã€‚</li><li><code>on</code> æŒ‡å®šè§¦å‘ workflow çš„æ¡ä»¶ã€‚<ul><li><code>on: push</code>ï¼Œæ„æ€æ˜¯ï¼Œ<code>push</code> äº‹ä»¶è§¦å‘ workflowã€‚ä¹Ÿå¯ä»¥æ˜¯äº‹ä»¶çš„æ•°ç»„ï¼Œä¾‹å¦‚: <code>on: [push, pull_request]</code>ã€‚<a href=https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows>æ›´å¤šè§¦å‘äº‹ä»¶</a>ã€‚</li><li><code>on.&lt;push|pull_request>.&lt;tags|branches></code>ï¼ŒæŒ‡å®šè§¦å‘äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é™å®šåˆ†æ”¯æˆ–æ ‡ç­¾ã€‚<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># åªæœ‰ master åˆ†æ”¯å‘ç”Ÿ push äº‹ä»¶æ—¶ï¼Œæ‰ä¼šè§¦å‘ workflowã€‚</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>master</span>
</span></span></code></pre></div></li></ul></li><li><code>jobs.&lt;job_id>.name</code> è¡¨ç¤ºè¦æ‰§è¡Œçš„ä¸€é¡¹æˆ–å¤šé¡¹ä»»åŠ¡ã€‚<code>jobs</code> å­—æ®µé‡Œé¢ï¼Œéœ€è¦å†™å‡ºæ¯ä¸€é¡¹ä»»åŠ¡çš„ <code>job_id</code>ï¼Œå…·ä½“åç§°è‡ªå®šä¹‰ã€‚<code>job_id</code> é‡Œé¢çš„ <code>name</code> å­—æ®µæ˜¯ä»»åŠ¡çš„è¯´æ˜ã€‚<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># jobs å­—æ®µåŒ…å«ä¸¤é¡¹ä»»åŠ¡ï¼Œjob_id åˆ†åˆ«æ˜¯ my_first_job å’Œ my_second_jobã€‚</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>my_first_job</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>My first job</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>my_second_job</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>My second job</span>
</span></span></code></pre></div></li><li><code>jobs.&lt;job_id>.runs-on</code> <code>runs-on</code> å­—æ®µæŒ‡å®šè¿è¡Œæ‰€éœ€è¦çš„è™šæ‹Ÿæœºç¯å¢ƒï¼Œå®ƒæ˜¯å¿…å¡«å­—æ®µã€‚å¯ç”¨çš„è™šæ‹Ÿï¼š<ul><li>ubuntu-latestã€ubuntu-18.04 æˆ– ubuntu-16.04ã€‚</li><li>windows-latestã€windows-2019 æˆ– windows-2016ã€‚</li><li>macOS-latest æˆ– macOS-10.14ã€‚</li></ul></li><li><code>jobs.&lt;job_id>.steps</code> æŒ‡å®šæ¯ä¸ª Job çš„è¿è¡Œæ­¥éª¤ï¼Œå¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤ã€‚æ¯ä¸ªæ­¥éª¤éƒ½å¯ä»¥æŒ‡å®šä¸‹é¢ä¸‰ä¸ªå­—æ®µã€‚<ul><li><code>jobs.&lt;job_id>.steps.name</code>ï¼šæ­¥éª¤åç§°ã€‚</li><li><code>jobs.&lt;job_id>.steps.run</code>ï¼šè¯¥æ­¥éª¤è¿è¡Œçš„å‘½ä»¤æˆ–è€… actionã€‚</li><li><code>jobs.&lt;job_id>.steps.env</code>ï¼šè¯¥æ­¥éª¤æ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Hello</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: <span style=color:#ae81ff>push</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>my-job</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>My Job</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print a greeting</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>GITHUB_TOKEN</span>: {{ <span style=color:#ae81ff>secrets.PAT }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      echo hello</span>      
</span></span></code></pre></div></li><li><code>jobs.&lt;job_id>.uses</code> å¯ä»¥å¼•ç”¨åˆ«äººå·²ç»åˆ›å»ºçš„ actionsã€‚å¼•ç”¨æ ¼å¼ä¸º <code>username/repo@verison</code>ï¼Œä¾‹å¦‚ <code>uses: actions/setup-go@v3</code>ã€‚</li><li><code>jobs.&lt;job_id>.with</code> è®¾ç½® action çš„å‚æ•°ã€‚æ¯ä¸ªå‚æ•°éƒ½æ˜¯ä¸€ä¸ª <code>key/value</code>ã€‚<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>my_first_job</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Node</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-node@v3</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>node-version</span>: <span style=color:#e6db74>&#39;14&#39;</span>
</span></span></code></pre></div></li><li><code>jobs.&lt;job_id>.run</code> æ‰§è¡Œçš„å‘½ä»¤ã€‚å¯ä»¥æœ‰å¤šä¸ªå‘½ä»¤ï¼Œä¾‹å¦‚ï¼š<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    go mod tidy
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    go build -v -o crtctl .</span>    
</span></span></code></pre></div></li></ul><h3 id=è®¾ç½®-job-çš„ä¾èµ–å…³ç³»>è®¾ç½® job çš„ä¾èµ–å…³ç³»
<a class=anchor href=#%e8%ae%be%e7%bd%ae-job-%e7%9a%84%e4%be%9d%e8%b5%96%e5%85%b3%e7%b3%bb>#</a></h3><p><code>needs</code> å­—æ®µå¯ä»¥æŒ‡å®šå½“å‰ä»»åŠ¡çš„ä¾èµ–å…³ç³»ï¼Œå³è¿è¡Œé¡ºåºã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>job1</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>job2</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>job1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>job3</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>needs</span>: [<span style=color:#ae81ff>job1, job2]</span>
</span></span></code></pre></div><p>ä¸Šé¢çš„ç¤ºä¾‹ï¼Œjob1 å¿…é¡»å…ˆäº job2 æˆåŠŸå®Œæˆï¼Œè€Œ job3 ç­‰å¾… job1 å’Œ job2 æˆåŠŸå®Œæˆåæ‰èƒ½è¿è¡Œã€‚</p><p>ä¸è¦æ±‚ä¾èµ–çš„ job æ˜¯å¦æˆåŠŸï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>job1</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>job2</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>needs</span>: <span style=color:#ae81ff>job1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>job3</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>${{ always() }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>needs</span>: [<span style=color:#ae81ff>job1, job2]</span>
</span></span></code></pre></div><p>ä¸Šé¢çš„ç¤ºä¾‹ï¼Œjob3 ä½¿ç”¨ <code>always()</code> æ¡ä»¶è¡¨è¾¾å¼ï¼Œç¡®ä¿å§‹ç»ˆåœ¨ job1 å’Œ job2 å®Œæˆï¼ˆæ— è®ºæ˜¯å¦æˆåŠŸï¼‰åè¿è¡Œã€‚</p><h3 id=ä½¿ç”¨æ„å»ºçŸ©é˜µ>ä½¿ç”¨æ„å»ºçŸ©é˜µ
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e6%9e%84%e5%bb%ba%e7%9f%a9%e9%98%b5>#</a></h3><p>å¦‚æœæƒ³åœ¨å¤šä¸ªç³»ç»Ÿæˆ–è€…å¤šä¸ªè¯­è¨€ç‰ˆæœ¬ä¸Šæµ‹è¯•æ„å»ºï¼Œå°±éœ€è¦è®¾ç½®æ„å»ºçŸ©é˜µã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿã€å¤šä¸ª Go ç‰ˆæœ¬ä¸‹è·‘æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ workflow é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Go Test</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: [<span style=color:#ae81ff>push, pull_request]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Test with go ${{ matrix.go_version }} on ${{ matrix.os }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>${{ matrix.os }}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>matrix</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>go_version</span>: [<span style=color:#ae81ff>1.15</span>, <span style=color:#ae81ff>1.16</span>]
</span></span><span style=display:flex><span>    <span style=color:#f92672>os</span>: [<span style=color:#ae81ff>ubuntu-latest, macOS-latest]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Go ${{ matrix.go_version }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-go@v2</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>go-version</span>: <span style=color:#ae81ff>${{ matrix.go_version }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>id</span>: <span style=color:#ae81ff>go</span>
</span></span></code></pre></div><p><code>strategy.matrix</code> é…ç½®äº†è¯¥å·¥ä½œæµç¨‹è¿è¡Œçš„ç¯å¢ƒçŸ©é˜µï¼Œä¼šåœ¨ 4 å°ä¸åŒé…ç½®çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œè¯¥ workflowï¼š<code>ubuntu-latest.1.15</code>ã€<code>ubuntu-latest.1.16</code>ã€
<code>macOS-latest.1.15</code>ã€<code>macOS-latest.1.16</code>ã€‚</p><h3 id=ä½¿ç”¨-secrets>ä½¿ç”¨ Secrets
<a class=anchor href=#%e4%bd%bf%e7%94%a8-secrets>#</a></h3><p>åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰ç”¨åˆ° token ç­‰æ•æ„Ÿæ•°æ®ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ secretsã€‚æˆ‘ä»¬åœ¨å¯¹åº”é¡¹ç›®ä¸­é€‰æ‹© <code>Settings-> Secrets</code>ï¼Œå°±å¯ä»¥åˆ›å»º secretã€‚</p><p>ä¾‹å¦‚åœ¨ Secrets ä¸­åˆ›å»ºä¸€ä¸ªåä¸º <code>MySecrets</code> çš„ secretï¼Œç„¶ååœ¨ workflow ä¸­å¼•ç”¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Go Test</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: [<span style=color:#ae81ff>push, pull_request]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>helloci-build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Test with go</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: [<span style=color:#ae81ff>ubuntu-latest]</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>helloci</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>use secrets</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>super_secret</span>: <span style=color:#ae81ff>${{ secrets.MySecrets }}</span>
</span></span></code></pre></div><p>secret name ä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å¦‚æœæ–°å»º secret çš„åå­—æ˜¯ <code>name</code>ï¼Œä½¿ç”¨æ—¶ç”¨ <code>secrets.name</code> æˆ–è€… <code>secrets.Name</code> éƒ½æ˜¯å¯ä»¥çš„ã€‚</p><p><a href=https://docs.github.com/cn/actions/using-workflows/workflow-syntax-for-github-actions>æ›´è¿‡ workflow é…ç½®</a>ã€‚</p><h2 id=å¸¸ç”¨-actions>å¸¸ç”¨ actions
<a class=anchor href=#%e5%b8%b8%e7%94%a8-actions>#</a></h2><h3 id=é™æ€ä»£ç æ£€æŸ¥>é™æ€ä»£ç æ£€æŸ¥
<a class=anchor href=#%e9%9d%99%e6%80%81%e4%bb%a3%e7%a0%81%e6%a3%80%e6%9f%a5>#</a></h3><p><a href=https://github.com/golangci/golangci-lint-action>golangci-lint-action</a> æ˜¯ golangci-lint å®˜æ–¹æä¾›çš„ actionã€‚</p><p>action é»˜è®¤ä¼šè¯»å–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>.golangci.yml</code> é…ç½®æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ <code>--config</code> æŒ‡å®šé…ç½®æ–‡ä»¶ï¼š <code>args: --config=/my/path/.golangci.yml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>golangci-lint</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>v*</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>paths-ignore</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;docs/**&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;README.md&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>paths-ignore</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;docs/**&#39;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#39;README.md&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>golangci</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>matrix</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>go</span>: [ <span style=color:#e6db74>&#39;1.20&#39;</span>, <span style=color:#e6db74>&#39;1.21&#39;</span> ]
</span></span><span style=display:flex><span>        <span style=color:#f92672>os</span>: [ <span style=color:#ae81ff>ubuntu-latest, windows-latest ]</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read </span> <span style=color:#75715e># for actions/checkout to fetch code</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>pull-requests</span>: <span style=color:#ae81ff>read </span> <span style=color:#75715e># for golangci/golangci-lint-action to fetch pull requests</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>lint</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-go@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>go-version</span>: <span style=color:#ae81ff>stable</span> <span style=color:#75715e># get the latest stable version from the go-versions repository manifest.</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>cache</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>golangci-lint</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>golangci/golangci-lint-action@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>args</span>: --<span style=color:#ae81ff>timeout=10m</span>
</span></span></code></pre></div><h3 id=è‡ªåŠ¨å‘å¸ƒ>è‡ªåŠ¨å‘å¸ƒ
<a class=anchor href=#%e8%87%aa%e5%8a%a8%e5%8f%91%e5%b8%83>#</a></h3><p><a href=https://github.com/goreleaser/goreleaser-action>goreleaser-action</a> GoReleaser å®˜æ–¹æä¾›å’Œçš„ actionã€‚</p><p>action é»˜è®¤è¯»å–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>.goreleaser.yaml</code> é…ç½®æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ <code>--config</code> æŒ‡å®šé…ç½®æ–‡ä»¶ï¼š <code>args: --config=/my/path/.goreleaser.yml</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>goreleaser</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>goreleaser</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set up Go</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-go@v4</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Run GoReleaser</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>goreleaser/goreleaser-action@v5</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#75715e># either &#39;goreleaser&#39; (default) or &#39;goreleaser-pro&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>distribution</span>: <span style=color:#ae81ff>goreleaser</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>version</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>args</span>: <span style=color:#ae81ff>release --clean --rm-dist --debug</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>GITHUB_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.PAT }}</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Your GoReleaser Pro key, if you are using the &#39;goreleaser-pro&#39; distribution</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># GORELEASER_KEY: ${{ secrets.GORELEASER_KEY }}</span>
</span></span></code></pre></div><h3 id=ä½¿ç”¨-artifact-å­˜å‚¨æ–‡ä»¶>ä½¿ç”¨ Artifact å­˜å‚¨æ–‡ä»¶
<a class=anchor href=#%e4%bd%bf%e7%94%a8-artifact-%e5%ad%98%e5%82%a8%e6%96%87%e4%bb%b6>#</a></h3><p>åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ„å»ºäº§ç‰©ï¼Œæ¯”å¦‚æ—¥å¿—æ–‡ä»¶ã€æµ‹è¯•ç»“æœç­‰ã€‚å¯ä»¥ä½¿ç”¨ GitHub Actions Artifact æ¥å­˜å‚¨ã€‚ä½¿ç”¨ <a href=https://github.com/actions/upload-artifact>action/upload-artifact</a>
å’Œ <a href=https://github.com/actions/download-artifact>download-artifact</a> è¿›è¡Œæ„å»ºå‚æ•°çš„ç›¸å…³æ“ä½œã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm ci</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm test</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Upload Test Coverage File</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/upload-artifact@v1.0.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>coverage-output</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>path</span>: <span style=color:#ae81ff>coverage</span>
</span></span></code></pre></div><p>æ‰§è¡ŒæˆåŠŸåï¼Œæˆ‘ä»¬å°±èƒ½åœ¨å¯¹åº” action é¢æ¿çœ‹åˆ°ç”Ÿæˆçš„ Artifactã€‚</p><h3 id=ä½¿ç”¨ç¼“å­˜åŠ å¿«-workflow>ä½¿ç”¨ç¼“å­˜åŠ å¿« workflow
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e7%bc%93%e5%ad%98%e5%8a%a0%e5%bf%ab-workflow>#</a></h3><p>ä¸ºäº†ä½¿ workflow æ›´å¿«ã€æ›´é«˜æ•ˆï¼Œå¯ä»¥ä¸ºä¾èµ–é¡¹åŠå…¶ä»–ç»å¸¸é‡å¤ä½¿ç”¨çš„æ–‡ä»¶åˆ›å»ºå’Œä½¿ç”¨ç¼“å­˜ã€‚ä¾‹å¦‚ï¼šnpmï¼Œgo modã€‚è¦ç¼“å­˜ job çš„ä¾èµ–é¡¹å¯ä»¥ä½¿ç”¨ <a href=https://github.com/actions/cache>cache</a> ã€‚</p><p>cache ä¼šæ ¹æ® <code>key</code> å°è¯•è¿˜åŸç¼“å­˜ã€‚å½“æ‰¾åˆ°ç¼“å­˜æ—¶ï¼Œä¼šå°†ç¼“å­˜çš„æ–‡ä»¶è¿˜åŸåˆ°ä½ é…ç½®çš„ <code>path</code>ã€‚</p><p>å¦‚æœæ‰¾åˆ°ç¼“å­˜ï¼Œcache ä¼šåœ¨ job æˆåŠŸå®Œæˆæ—¶ä¼šä½¿ç”¨ä½ æä¾›çš„ <code>key</code> è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°ç¼“å­˜ã€‚å¹¶åŒ…å« <code>path</code> æŒ‡å®šçš„æ–‡ä»¶ã€‚</p><p>å¯ä»¥é€‰æ‹©æä¾›åœ¨ <code>key</code> ä¸ç°æœ‰ç¼“å­˜ä¸åŒ¹é…æ—¶è¦ä½¿ç”¨çš„ <code>restore-keys</code> åˆ—è¡¨ã€‚ ä»å¦ä¸€ä¸ªåˆ†æ”¯è¿˜åŸç¼“å­˜æ—¶ï¼Œ<code>restore-keys</code> åˆ—è¡¨éå¸¸æœ‰ç”¨ï¼Œå› ä¸º <code>restore-keys</code>
å¯ä»¥éƒ¨åˆ†åŒ¹é…ç¼“å­˜ <code>key</code>ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Look for a CLI that&#39;s made for this PR</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Fetch built CLI</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>id</span>: <span style=color:#ae81ff>cli-cache</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/cache@v2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>./_output/linux/amd64/bin/crtctl</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># The cache key a combination of the current PR number and the commit SHA</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>key</span>: <span style=color:#ae81ff>crtctl-${{ github.event.pull_request.number }}-${{ github.sha }}</span>
</span></span></code></pre></div><h4 id=è¾“å…¥å‚æ•°>è¾“å…¥å‚æ•°
<a class=anchor href=#%e8%be%93%e5%85%a5%e5%8f%82%e6%95%b0>#</a></h4><ul><li><code>key</code>ï¼šå¿…é¡»ã€‚ç¼“å­˜çš„ keyã€‚ å®ƒå¯ä»¥æ˜¯å˜é‡ã€ä¸Šä¸‹æ–‡å€¼ã€é™æ€å­—ç¬¦ä¸²å’Œå‡½æ•°çš„ä»»ä½•ç»„åˆã€‚ å¯†é’¥æœ€å¤§é•¿åº¦ä¸º 512 ä¸ªå­—ç¬¦ï¼Œå¯†é’¥é•¿åº¦è¶…è¿‡æœ€å¤§é•¿åº¦å°†å¯¼è‡´æ“ä½œå¤±è´¥ã€‚</li><li><code>path</code>ï¼šå¿…é¡»ã€‚è¿è¡Œå™¨ä¸Šç”¨äºç¼“å­˜æˆ–è¿˜åŸçš„è·¯å¾„ã€‚å¯ä»¥æŒ‡å®šå•ä¸ªè·¯å¾„ï¼Œä¹Ÿå¯ä»¥åœ¨å•ç‹¬çš„è¡Œä¸Šæ·»åŠ å¤šä¸ªè·¯å¾„ã€‚ ä¾‹å¦‚ï¼š<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Cache Gradle packages</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/cache@v3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ~/.gradle/caches
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ~/.gradle/wrapper</span>      
</span></span></code></pre></div></li><li><code>restore-keys</code>ï¼šå¯é€‰çš„ã€‚å¤‡ç”¨çš„ç¼“å­˜ key å­—ç¬¦ä¸²ï¼Œæ¯ä¸ª key æ”¾ç½®åœ¨ä¸€ä¸ªæ–°è¡Œä¸Šã€‚å¦‚æœ key æ²¡æœ‰å‘½ä¸­ç¼“å­˜ï¼Œåˆ™æŒ‰ç…§æä¾›çš„é¡ºåºä¾æ¬¡ä½¿ç”¨è¿™äº›è¿˜åŸé”®æ¥æŸ¥æ‰¾å’Œè¿˜åŸç¼“å­˜ã€‚ä¾‹å¦‚ï¼š<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>restore-keys</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  npm-feature-${{ hashFiles(&#39;package-lock.json&#39;) }}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  npm-feature-
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  npm-</span>  
</span></span></code></pre></div></li></ul><h4 id=è¾“å‡ºå‚æ•°>è¾“å‡ºå‚æ•°
<a class=anchor href=#%e8%be%93%e5%87%ba%e5%8f%82%e6%95%b0>#</a></h4><ul><li><code>cache-hit</code>ï¼šå¸ƒå°”å€¼ï¼Œæ˜¯å¦å‘½ä¸­ç¼“å­˜ã€‚</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>if</span>: <span style=color:#ae81ff>${{ steps.cache-npm.outputs.cache-hit != &#39;true&#39; }}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>List the state of node modules</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>continue-on-error</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm list</span>
</span></span></code></pre></div><h4 id=ç¼“å­˜åŒ¹é…è¿‡ç¨‹>ç¼“å­˜åŒ¹é…è¿‡ç¨‹
<a class=anchor href=#%e7%bc%93%e5%ad%98%e5%8c%b9%e9%85%8d%e8%bf%87%e7%a8%8b>#</a></h4><ol><li>å½“ <code>key</code> åŒ¹é…ç°æœ‰ç¼“å­˜æ—¶ï¼Œè¢«ç§°ä¸ºç¼“å­˜å‘½ä¸­ï¼Œå¹¶ä¸”æ“ä½œä¼šå°†ç¼“å­˜çš„æ–‡ä»¶è¿˜åŸåˆ° <code>path</code> ç›®å½•ã€‚</li><li>å½“ <code>key</code> ä¸åŒ¹é…ç°æœ‰ç¼“å­˜æ—¶ï¼Œåˆ™è¢«ç§°ä¸ºç¼“å­˜å¤±è¯¯ï¼Œåœ¨ä½œä¸šæˆåŠŸå®Œæˆæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°ç¼“å­˜ã€‚å‘ç”Ÿç¼“å­˜å¤±è¯¯æ—¶ï¼Œè¯¥æ“ä½œè¿˜ä¼šæœç´¢æŒ‡å®šçš„ <code>restore-keys</code> ä»¥æŸ¥æ‰¾ä»»ä½•åŒ¹é…é¡¹ï¼š</li></ol><ul><li>å¦‚æœæä¾› <code>restore-keys</code>ï¼Œcache æ“ä½œå°†æŒ‰é¡ºåºæœç´¢ä¸ <code>restore-keys</code> åˆ—è¡¨åŒ¹é…çš„ä»»ä½•ç¼“å­˜ã€‚<ul><li>å½“å­˜åœ¨ç²¾ç¡®åŒ¹é…æ—¶ï¼Œè¯¥æ“ä½œä¼šå°†ç¼“å­˜ä¸­çš„æ–‡ä»¶è¿˜åŸåˆ° <code>path</code> ç›®å½•ã€‚</li><li>å¦‚æœæ²¡æœ‰ç²¾ç¡®åŒ¹é…ï¼Œæ“ä½œå°†ä¼šæœç´¢æ¢å¤é”®å€¼çš„éƒ¨åˆ†åŒ¹é…ã€‚ å½“æ“ä½œæ‰¾åˆ°éƒ¨åˆ†åŒ¹é…æ—¶ï¼Œæœ€è¿‘çš„ç¼“å­˜å°†è¿˜åŸåˆ° <code>path</code> ç›®å½•ã€‚</li></ul></li><li>cache æ“ä½œå®Œæˆï¼Œä½œä¸šä¸­çš„ä¸‹ä¸€ä¸ªæ­¥éª¤è¿è¡Œã€‚</li><li>å¦‚æœä½œä¸šæˆåŠŸå®Œæˆï¼Œåˆ™æ“ä½œå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåŒ…å« <code>path</code> ç›®å½•å†…å®¹çš„æ–°ç¼“å­˜ã€‚</li></ul><p><a href=https://docs.github.com/cn/actions/using-workflows/caching-dependencies-to-speed-up-workflows#matching-a-cache-key>åŒ¹é…ç¼“å­˜é”®çš„è¯¦ç»†è¿‡ç¨‹</a> ã€‚</p><h4 id=ä½¿ç”¨é™åˆ¶å’Œæ”¶å›æ”¿ç­–>ä½¿ç”¨é™åˆ¶å’Œæ”¶å›æ”¿ç­–
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e9%99%90%e5%88%b6%e5%92%8c%e6%94%b6%e5%9b%9e%e6%94%bf%e7%ad%96>#</a></h4><p>GitHub å°†åˆ é™¤ 7 å¤©å†…æœªè¢«è®¿é—®çš„ä»»ä½•ç¼“å­˜æ¡ç›®ã€‚ å¯ä»¥å­˜å‚¨çš„ç¼“å­˜æ•°æ²¡æœ‰é™åˆ¶ï¼Œä½†å­˜å‚¨åº“ä¸­æ‰€æœ‰ç¼“å­˜çš„æ€»å¤§å°é™åˆ¶ä¸º 10 GBã€‚</p><p>å¦‚æœè¶…è¿‡æ­¤é™åˆ¶ï¼ŒGitHub å°†ä¿å­˜æ–°ç¼“å­˜ï¼Œä½†ä¼šå¼€å§‹æ”¶å›ç¼“å­˜ï¼Œç›´åˆ°æ€»å¤§å°å°äºå­˜å‚¨åº“é™åˆ¶ã€‚</p><h3 id=è‡ªåŠ¨æ‰“-label>è‡ªåŠ¨æ‰“ Label
<a class=anchor href=#%e8%87%aa%e5%8a%a8%e6%89%93-label>#</a></h3><p>ä½¿ç”¨ <a href=https://github.com/marketplace/actions/labeler>actions/labeler</a> æ¥å®ç°è‡ªåŠ¨æ‰“ Labelã€‚</p><h4 id=ä½¿ç”¨>ä½¿ç”¨
<a class=anchor href=#%e4%bd%bf%e7%94%a8>#</a></h4><p>åˆ›å»º <code>.github/labeler.yml</code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æ ‡ç­¾åˆ—è¡¨å’Œéœ€è¦åŒ¹é…çš„ <a href=https://github.com/isaacs/minimatch>minimatch</a> globsï¼Œä»¥åº”ç”¨æ ‡ç­¾ã€‚</p><p><code>.github/labeler.yml</code> æ–‡ä»¶ä¸­ï¼Œkey å°±æ˜¯ label çš„åå­—ï¼Œå€¼æ˜¯æ–‡ä»¶è·¯å¾„ã€‚</p><p>Workflow ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request_target</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [<span style=color:#ae81ff>opened, reopened, synchronize, ready_for_review]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># Automatically labels PRs based on file globs in the change.</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>triage</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/labeler@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>repo-token</span>: <span style=color:#e6db74>&#34;${{ secrets.GITHUB_TOKEN }}&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>configuration-path</span>: <span style=color:#ae81ff>.github/labels.yml</span>
</span></span></code></pre></div><p>è¾“å…¥å‚æ•°ï¼š</p><ul><li><code>repo-token</code>ï¼šGITHUB_TOKENï¼Œéœ€è¦ <code>contents:read</code> å’Œ <code>pull-requests:write</code> æƒé™ã€‚</li><li><code>configuration-path</code>ï¼šLabel é…ç½®æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>sync-labels</code>ï¼šå½“åŒ¹é…çš„æ–‡ä»¶è¢«è¿˜åŸæˆ–ä¸å†è¢« PR æ”¹å˜æ—¶ï¼Œæ˜¯å¦è¦åˆ é™¤æ ‡ç­¾ã€‚</li></ul><h3 id=åœ¨ä¸€ä¸ª-pr-åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨-assign-reviewer>åœ¨ä¸€ä¸ª PR åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨ assign reviewer
<a class=anchor href=#%e5%9c%a8%e4%b8%80%e4%b8%aa-pr-%e5%88%9b%e5%bb%ba%e6%88%96%e6%89%93%e5%bc%80%e6%97%b6%e4%b8%ba%e8%87%aa%e5%8a%a8-assign-reviewer>#</a></h3><p>ä½¿ç”¨ <a href=https://github.com/marketplace/actions/auto-assign-action>auto-assign-action</a> æ¥å®ç°è‡ªåŠ¨ assignã€‚</p><p>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š<code>.github/auto_assign.yml</code>ã€‚åœ¨æ–‡ä»¶ä¸­æ·»åŠ  reviewers/assigneesã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Set to true to add reviewers to pull requests</span>
</span></span><span style=display:flex><span><span style=color:#f92672>addReviewers</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set to true to add assignees to pull requests</span>
</span></span><span style=display:flex><span><span style=color:#f92672>addAssignees</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set addAssignees to &#39;author&#39; to set the PR creator as the assignee.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># addAssignees: author</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A list of reviewers to be added to pull requests (GitHub user name)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>reviewers</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>reviewerA</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>reviewerB</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>reviewerC</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A number of reviewers added to the pull request</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set 0 to add all the reviewers (default: 0)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>numberOfReviewers</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># A list of assignees, overrides reviewers if set</span>
</span></span><span style=display:flex><span><span style=color:#75715e># assignees:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - assigneeA</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A number of assignees to add to the pull request</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set to 0 to add all of the assignees.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Uses numberOfReviewers if unset.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># numberOfAssignees: 2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set to true to add reviewers from different groups to pull requests</span>
</span></span><span style=display:flex><span><span style=color:#f92672>useReviewGroups</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A list of reviewers, split into different groups, to be added to pull requests (GitHub user name)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>reviewGroups</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>groupA</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerA</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerB</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerC</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>groupB</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerD</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerE</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>reviewerF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set to true to add assignees from different groups to pull requests</span>
</span></span><span style=display:flex><span><span style=color:#f92672>useAssigneeGroups</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># A list of assignees, split into different froups, to be added to pull requests (GitHub user name)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># assigneeGroups:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   groupA:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeA</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeB</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeC</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   groupB:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeD</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     - assigneeF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># A list of keywords to be skipped the process that add reviewers if pull requests include it</span>
</span></span><span style=display:flex><span><span style=color:#75715e># skipKeywords:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - wip</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># The action will only run for non-draft PRs. If you want to run for all PRs, you need to enable it to run on drafts.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># runOnDraft: true</span>
</span></span></code></pre></div><p>Workflow ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Auto Assign Author&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># pull_request_target means that this will run on pull requests, but in</span>
</span></span><span style=display:flex><span><span style=color:#75715e># the context of the base repo. This should mean PRs from forks are supported.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request_target</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [<span style=color:#ae81ff>opened, reopened, ready_for_review]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># Automatically assigns reviewers and owner</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>add-reviews</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Set the author of a PR as the assignee</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>kentaro-m/auto-assign-action@v1.2.4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>configuration-path</span>: <span style=color:#e6db74>&#34;.github/auto_assignees.yml&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>repo-token</span>: <span style=color:#e6db74>&#34;${{ secrets.GITHUB_TOKEN }}&#34;</span>
</span></span></code></pre></div><h3 id=å…³é—­ä¸æ´»è·ƒçš„-issue-å’Œ-pr>å…³é—­ä¸æ´»è·ƒçš„ Issue å’Œ PR
<a class=anchor href=#%e5%85%b3%e9%97%ad%e4%b8%8d%e6%b4%bb%e8%b7%83%e7%9a%84-issue-%e5%92%8c-pr>#</a></h3><p>ä½¿ç”¨ <a href=https://github.com/marketplace/actions/close-stale-issues>close-stale-issues</a> æ¥è‡ªåŠ¨å…³é—­é•¿æ—¶é—´ä¸æ´»è·ƒçš„ PR å’Œ issuesã€‚</p><p>é…ç½®å¿…é¡»åœ¨é»˜è®¤åˆ†æ”¯ä¸Šï¼Œé»˜è®¤å€¼å°†ä¼šï¼š</p><ul><li>åœ¨ 60 å¤©æ²¡æœ‰æ´»è·ƒçš„ issue å’Œ PR ä¸Šæ·»åŠ ä¸€ä¸ª &ldquo;Stale&rdquo; æ ‡ç­¾ï¼Œå¹¶æ·»åŠ  commentsã€‚</li><li>æ·»åŠ  &ldquo;Stale&rdquo; æ ‡ç­¾ 7 å¤©åå…³é—­ issue å’Œ PRã€‚</li><li>å¦‚æœ issue å’Œ PR å‘ç”Ÿæ›´æ–°/è¯„è®ºï¼Œ&ldquo;Stale&rdquo; æ ‡ç­¾å°†è¢«åˆ é™¤ï¼Œè®¡æ—¶å™¨ä¼šé‡å¯ã€‚</li></ul><p>éœ€è¦çš„æƒé™ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>write</span> <span style=color:#75715e># only for delete-branch option</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>issues</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull-requests</span>: <span style=color:#ae81ff>write</span>
</span></span></code></pre></div><h4 id=ç¤ºä¾‹>ç¤ºä¾‹
<a class=anchor href=#%e7%a4%ba%e4%be%8b>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;Close stale issues and PRs&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schedule</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># First of every month</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>cron</span>: <span style=color:#e6db74>&#34;30 1 * * *&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>stale</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/stale@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>repo-token</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>stale-issue-message</span>: <span style=color:#e6db74>&#34;This issue is stale because it has been open 30 days with no activity. Remove stale label or comment or this will be closed in 5 days. If a Velero team member has requested log or more information, please provide the output of the shared commands.&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>close-issue-message</span>: <span style=color:#e6db74>&#34;This issue was closed because it has been stalled for 5 days with no activity.&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>days-before-issue-stale</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>days-before-issue-close</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Disable stale PRs for now; they can remain open.</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>days-before-pr-stale</span>: -<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>days-before-pr-close</span>: -<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Only issues made after Oct 01 2022.</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>start-date</span>: <span style=color:#e6db74>&#34;2022-10-01T00:00:00&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#75715e># Only make issues stale if they have these labels. Comma separated.</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>only-labels</span>: <span style=color:#e6db74>&#34;Needs info,Duplicate&#34;</span>
</span></span></code></pre></div><h3 id=ä½¿ç”¨-gitleaks-è¿›è¡Œé™æ€ä»£ç åˆ†æ>ä½¿ç”¨ Gitleaks è¿›è¡Œé™æ€ä»£ç åˆ†æ
<a class=anchor href=#%e4%bd%bf%e7%94%a8-gitleaks-%e8%bf%9b%e8%a1%8c%e9%9d%99%e6%80%81%e4%bb%a3%e7%a0%81%e5%88%86%e6%9e%90>#</a></h3><p><a href=https://github.com/marketplace/actions/gitleaks>Gitleaks</a> æ˜¯ä¸€æ¬¾ SAST å·¥å…·ï¼Œç”¨äºæ£€æµ‹å’Œé˜²æ­¢ git ä»“åº“ä¸­çš„å¯†ç ã€API å¯†é’¥å’Œä»¤ç‰Œç­‰ç¡¬ç¼–ç ç§˜å¯†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>gitleaks</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>workflow_dispatch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>schedule</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>cron</span>: <span style=color:#e6db74>&#34;0 4 * * *&#34;</span> <span style=color:#75715e># run once a day at 4 AM</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>scan</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>gitleaks</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>gitleaks/gitleaks-action@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>GITHUB_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>GITLEAKS_LICENSE</span>: <span style=color:#ae81ff>${{ secrets.GITLEAKS_LICENSE}}</span> <span style=color:#75715e># Only required for Organizations, not personal accounts.</span>
</span></span></code></pre></div><p>å¸¸ç”¨é…ç½®ï¼š</p><pre tabindex=0><code># å®šä¹‰äº†å¦‚ä½•æ£€æµ‹ secrets
[[rules]]
# è§„åˆ™ id
id = &#34;ignore-testdata&#34;
# ä¸ºå•æ¡è§„åˆ™åŠ å…¥ä¸€ä¸ªå…è®¸åˆ—è¡¨ï¼Œä»¥å‡å°‘è¯¯æŠ¥ï¼Œæˆ–å¿½ç•¥å·²çŸ¥çš„ secret çš„æäº¤ã€‚
[rules.allowlist]
paths = [&#39;&#39;&#39;.*/testdata/*&#39;&#39;&#39;]
# å…¨å±€çš„å…è®¸åˆ—è¡¨
[allowlist]
</code></pre><p>æ›´å¤šé…ç½® <a href=https://github.com/gitleaks/gitleaks#configuration>Configuration</a>ã€‚</p><h3 id=ä½¿ç”¨-grype-æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´>ä½¿ç”¨ Grype æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´
<a class=anchor href=#%e4%bd%bf%e7%94%a8-grype-%e6%89%ab%e6%8f%8f%e5%ae%b9%e5%99%a8%e9%95%9c%e5%83%8f%e5%92%8c%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e6%bc%8f%e6%b4%9e>#</a></h3><p><a href=https://github.com/anchore/grype>Grype</a> æ˜¯ä¸€æ¬¾é’ˆå¯¹å®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿçš„æ¼æ´æ‰«æç¨‹åºã€‚å¦‚æœå‘ç°äº†æ¼æ´ï¼Œè¿˜å¯é€‰æ‹©ä»¥å¯é…ç½®çš„ä¸¥é‡ç¨‹åº¦å¤±è´¥ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;grype&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [<span style=color:#e6db74>&#39;main&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>: [<span style=color:#e6db74>&#39;v*&#39;</span>]
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>scan-source</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>scan-source</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>security-events</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>actions</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>anchore/scan-action@v3</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>path</span>: <span style=color:#e6db74>&#34;.&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>fail-build</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h4 id=grype-configuration><code>grype</code> Configuration
<a class=anchor href=#grype-configuration>#</a></h4><p>é»˜è®¤é…ç½®æ–‡ä»¶çš„æœç´¢è·¯å¾„:</p><ul><li><code>.grype.yaml</code></li><li><code>.grype/config.yaml</code></li><li><code>~/.grype.yaml</code></li><li><code>&lt;XDG_CONFIG_HOME>/grype/config.yaml</code></li></ul><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>--config</code>/<code>-c</code> æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ã€‚</p><p>å¸¸ç”¨é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># æ‰«ææ—¶ï¼Œå¦‚æœå‘ç°ä¸¥é‡æ€§è¾¾åˆ°æˆ–è¶…è¿‡è®¾ç½®çš„å€¼ï¼Œåˆ™è¿”å›ä»£ç ä¸º 1ã€‚é»˜è®¤ä¸ºæœªè®¾ç½®</span>
</span></span><span style=display:flex><span><span style=color:#f92672>fail-on-severity</span>: <span style=color:#ae81ff>high</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¦‚æœä½¿ç”¨ SBOM è¾“å…¥ï¼Œåˆ™åœ¨è½¯ä»¶åŒ…æ²¡æœ‰ CPE æ—¶è‡ªåŠ¨ç”Ÿæˆ CPE</span>
</span></span><span style=display:flex><span><span style=color:#f92672>add-cpes-if-none</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># è¾“å‡ºæ ¼å¼ (å…è®¸çš„å€¼: table, json, cyclonedx)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>output</span>: <span style=color:#ae81ff>table</span>
</span></span><span style=display:flex><span><span style=color:#75715e># è¦ä»æ‰«æä¸­æ’é™¤çš„æ–‡ä»¶</span>
</span></span><span style=display:flex><span><span style=color:#f92672>exclude</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;**/testdata/**&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å¦‚æœçœ‹åˆ° Grype æŠ¥å‘Šè¯¯æŠ¥æˆ–ä»»ä½•å…¶ä»–ä¸æƒ³çœ‹åˆ°çš„æ¼æ´åŒ¹é…ï¼Œå¯ä»¥é…ç½® &#34;å¿½ç•¥è§„åˆ™&#34;ï¼ŒGrype ä¼šå¿½ç•¥åŒ¹é…ç»“æœ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>ignore</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>fix-state: unknown # å…è®¸çš„å€¼</span>: <span style=color:#e6db74>&#34;fixed&#34;</span>, <span style=color:#e6db74>&#34;not-fixed&#34;</span>, <span style=color:#e6db74>&#34;wont-fix&#34;</span>, <span style=color:#ae81ff>or &#34;unknown&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>vulnerability</span>: <span style=color:#e6db74>&#34;CVE-2008-4318&#34;</span> <span style=color:#75715e># vulnerability ID</span>
</span></span></code></pre></div><p><a href=https://github.com/anchore/grype>æ›´å¤š Grype é…ç½®</a>ã€‚</p><h3 id=ä½¿ç”¨-codeql-è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ>ä½¿ç”¨ CodeQL è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ
<a class=anchor href=#%e4%bd%bf%e7%94%a8-codeql-%e8%bf%9b%e8%a1%8c%e5%ae%89%e5%85%a8%e6%80%a7%e4%bb%a3%e7%a0%81%e5%88%86%e6%9e%90>#</a></h3><p>GitHub CodeQL Action æ˜¯ä¸€ä¸ªç”¨äºå®‰å…¨æ€§ä»£ç åˆ†æçš„ GitHub Actionsï¼Œä½¿ç”¨ CodeQL æŸ¥è¯¢è¯­è¨€æ¥æœç´¢é¡¹ç›®ä¸­çš„ä»£ç æ¼æ´å’Œå®‰å…¨é—®é¢˜ã€‚æ‰«æå®Œæˆåï¼ŒCodeQL Action ä¼šç”ŸæˆæŠ¥å‘Šï¼Œæ‰«ææŸ¥è¯¢ç»“æœã€‚</p><p>CodeQL å¯ä»¥åœ¨ <code>Security -> Overview -> Code scanning alerts -> Set up code scanning</code> æ‰¾åˆ°å®˜æ–¹ç»™çš„ CodeQL Workflow Templateã€‚é€‰æ‹© <code>Set up this workflow</code> å°±å¯ä»¥ç”¨ template äº†ã€‚</p><p>ä¹Ÿå¯ä»¥è‡ªå·±åœ¨ workflow ä¸­åŠ ä¸Š CodeQL Actionï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;codeql&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [ <span style=color:#ae81ff>main ]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>analyze</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>analyze</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>actions</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>security-events</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-go@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>go-version</span>: <span style=color:#ae81ff>stable</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>initialize codeql</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>github/codeql-action/init@v2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>languages</span>: <span style=color:#ae81ff>go</span> <span style=color:#75715e># javascript, csharp, python, cpp, java</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>build package</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>go build ./cmd</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># build package C/C++, C#, Java, Go, Swift  å¯ä»¥ç›´æ¥ä½¿ç”¨ CodeQL çš„ autobuild ä½œæ›¿ä»£</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># - name: auto build package  </span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>#   uses: github/codeql-action/autobuild@v2</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>github/codeql-action/analyze@v2</span>
</span></span></code></pre></div><h3 id=è‡ªåŠ¨æäº¤-action-è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶>è‡ªåŠ¨æäº¤ action è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶
<a class=anchor href=#%e8%87%aa%e5%8a%a8%e6%8f%90%e4%ba%a4-action-%e8%bf%90%e8%a1%8c%e6%9c%9f%e9%97%b4%e4%ba%a7%e7%94%9f%e7%9a%84%e6%96%87%e4%bb%b6>#</a></h3><p><a href=https://github.com/stefanzweifel/git-auto-commit-action>git-auto-commit-action</a> ç”¨äºæ£€æµ‹å·¥ä½œæµè¿è¡ŒæœŸé—´æ›´æ”¹çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶æäº¤å’Œæ¨é€å› GitHub ä»“åº“ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæäº¤ä¼šä»¥ &ldquo;GitHub Action&rdquo; çš„åä¹‰è¿›è¡Œï¼Œå¹¶ç”±ä¸Šæ¬¡æäº¤çš„ç”¨æˆ·å…±åŒæ’°å†™ã€‚</p><p><code>CONTRIBUTING.md</code>ï¼ŒChangeLog ä¹‹ç±»çš„æ”¹åŠ¨å¯ä»¥ä½¿ç”¨è¯¥ action æ¥å®ç°è‡ªåŠ¨æäº¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Format</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: <span style=color:#ae81ff>push</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>format-code</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>      <span style=color:#75715e># Give the default GITHUB_TOKEN write permission to commit and push the</span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># added or changed files to the repository.</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>write</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># Other steps that change files in the repository</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e># Commit all changed files back to the repository</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>stefanzweifel/git-auto-commit-action@v4</span>
</span></span></code></pre></div><h3 id=æ‰«æ-pr-ä¸­çš„ä¾èµ–å…³ç³»>æ‰«æ PR ä¸­çš„ä¾èµ–å…³ç³»
<a class=anchor href=#%e6%89%ab%e6%8f%8f-pr-%e4%b8%ad%e7%9a%84%e4%be%9d%e8%b5%96%e5%85%b3%e7%b3%bb>#</a></h3><p><a href=https://github.com/actions/dependency-review-action>dependency-review-action</a> å¯ä»¥ç”¨æ¥æ‰«æ PR ä¸­çš„ä¾èµ–å…³ç³»æ›´æ”¹ï¼Œå¦‚æœå¼•å…¥äº†ä»»ä½•æ¼æ´æˆ–æ— æ•ˆè®¸å¯è¯ï¼Œåˆ™ä¼šå¼•å‘é”™è¯¯ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;Dependency Review&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>: [<span style=color:#ae81ff>pull_request]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>permissions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>contents</span>: <span style=color:#ae81ff>read</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>dependency-review</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;Checkout Repository&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v3</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;Dependency Review&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/dependency-review-action@v3</span>
</span></span></code></pre></div><h3 id=å¦‚ä½•åœ¨-action-ä¸­è®¿é—®-github>å¦‚ä½•åœ¨ Action ä¸­è®¿é—® GitHub
<a class=anchor href=#%e5%a6%82%e4%bd%95%e5%9c%a8-action-%e4%b8%ad%e8%ae%bf%e9%97%ae-github>#</a></h3><h4 id=ä½¿ç”¨-github-access-token>ä½¿ç”¨ GitHub Access token
<a class=anchor href=#%e4%bd%bf%e7%94%a8-github-access-token>#</a></h4><ol><li>é¦–å…ˆéœ€è¦ç”Ÿæˆä¸€ä¸ª Access Tokenï¼Œ<a href=https://github.com/settings/tokens/new>åˆ›å»º token</a>ã€‚</li><li>åœ¨ repo çš„ Settings é¡µé¢ä¸­æ·»åŠ  Secretï¼Œä¾‹å¦‚ï¼Œæˆ‘çš„ secret å‘½åä¸º PATã€‚</li></ol><p>åœ¨ Action ä¸­ä½¿ç”¨ï¼š</p><pre tabindex=0><code>    steps:
      - name: release
        run: |
          GITHUB_TOKEN=${{ secrets.PAT }} make release
</code></pre><p>é€šè¿‡ Access Token çš„æ–¹å¼ clone repoï¼š</p><pre tabindex=0><code>    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          repository: shipengqi/crtctl
          token: ${{ secrets.PAT }}
          path: crtctl
</code></pre><p>ä¸Šé¢çš„æ–¹å¼ç”¨çš„æ˜¯ HTTPS çš„æ–¹å¼ã€‚é€šè¿‡ <code>git remote -v</code> æŸ¥çœ‹å¯ä»¥çœ‹åˆ° remote çš„åœ°å€ã€‚</p><h4 id=ä½¿ç”¨-ssh>ä½¿ç”¨ SSH
<a class=anchor href=#%e4%bd%bf%e7%94%a8-ssh>#</a></h4><ol><li>é¦–å…ˆéœ€è¦ä¸€ä¸ª GitHub ä¸­å·²ç»é…ç½®å¥½çš„ ssh çš„ public keyã€‚</li><li>åœ¨ repo çš„ Settings é¡µé¢ä¸­æ·»åŠ  Secretï¼Œä¾‹å¦‚ï¼Œæˆ‘çš„ secret å‘½åä¸º SSH_KEYã€‚</li></ol><p>åœ¨ Action ä¸­é…ç½® sshï¼š</p><pre tabindex=0><code>- name: Install SSH Key
  uses: shimataro/ssh-key-action@v2
  with:
    key: ${{ secrets.SSH_KEY }} 
    known_hosts: &#39;just-a-placeholder-so-we-dont-get-errors&#39;
</code></pre><p>ä¹‹åå°±å¯ä»¥åœ¨ Action çš„åç»­æ­¥éª¤ä¸­åƒåœ¨æœ¬åœ°ä¸€æ ·ä½¿ç”¨ SSH çš„æ–¹å¼æ¥ clone repo å’Œæäº¤ä»£ç äº†ã€‚</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/golang-learn/commit/2693fbeb9296c498083681526ce91c2a5190c392 title='Last modified by PengQi Shi | December 3, 2023' target=_blank rel=noopener><img src=/golang-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>December 3, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/golang-learn/edit/master/content/docs/project/09_actions.md target=_blank rel=noopener><img src=/golang-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#åŸºäº-github-actions-çš„-cicd>åŸºäº GitHub Actions çš„ CI/CD</a><ul><li><a href=#github-actions-æœ¯è¯­>GitHub Actions æœ¯è¯­</a></li><li><a href=#workflow>workflow</a><ul><li><a href=#åŸºç¡€é…ç½®>åŸºç¡€é…ç½®</a></li><li><a href=#è®¾ç½®-job-çš„ä¾èµ–å…³ç³»>è®¾ç½® job çš„ä¾èµ–å…³ç³»</a></li><li><a href=#ä½¿ç”¨æ„å»ºçŸ©é˜µ>ä½¿ç”¨æ„å»ºçŸ©é˜µ</a></li><li><a href=#ä½¿ç”¨-secrets>ä½¿ç”¨ Secrets</a></li></ul></li><li><a href=#å¸¸ç”¨-actions>å¸¸ç”¨ actions</a><ul><li><a href=#é™æ€ä»£ç æ£€æŸ¥>é™æ€ä»£ç æ£€æŸ¥</a></li><li><a href=#è‡ªåŠ¨å‘å¸ƒ>è‡ªåŠ¨å‘å¸ƒ</a></li><li><a href=#ä½¿ç”¨-artifact-å­˜å‚¨æ–‡ä»¶>ä½¿ç”¨ Artifact å­˜å‚¨æ–‡ä»¶</a></li><li><a href=#ä½¿ç”¨ç¼“å­˜åŠ å¿«-workflow>ä½¿ç”¨ç¼“å­˜åŠ å¿« workflow</a></li><li><a href=#è‡ªåŠ¨æ‰“-label>è‡ªåŠ¨æ‰“ Label</a></li><li><a href=#åœ¨ä¸€ä¸ª-pr-åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨-assign-reviewer>åœ¨ä¸€ä¸ª PR åˆ›å»ºæˆ–æ‰“å¼€æ—¶ä¸ºè‡ªåŠ¨ assign reviewer</a></li><li><a href=#å…³é—­ä¸æ´»è·ƒçš„-issue-å’Œ-pr>å…³é—­ä¸æ´»è·ƒçš„ Issue å’Œ PR</a></li><li><a href=#ä½¿ç”¨-gitleaks-è¿›è¡Œé™æ€ä»£ç åˆ†æ>ä½¿ç”¨ Gitleaks è¿›è¡Œé™æ€ä»£ç åˆ†æ</a></li><li><a href=#ä½¿ç”¨-grype-æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´>ä½¿ç”¨ Grype æ‰«æå®¹å™¨é•œåƒå’Œæ–‡ä»¶ç³»ç»Ÿæ¼æ´</a></li><li><a href=#ä½¿ç”¨-codeql-è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ>ä½¿ç”¨ CodeQL è¿›è¡Œå®‰å…¨æ€§ä»£ç åˆ†æ</a></li><li><a href=#è‡ªåŠ¨æäº¤-action-è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶>è‡ªåŠ¨æäº¤ action è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ–‡ä»¶</a></li><li><a href=#æ‰«æ-pr-ä¸­çš„ä¾èµ–å…³ç³»>æ‰«æ PR ä¸­çš„ä¾èµ–å…³ç³»</a></li><li><a href=#å¦‚ä½•åœ¨-action-ä¸­è®¿é—®-github>å¦‚ä½•åœ¨ Action ä¸­è®¿é—® GitHub</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>