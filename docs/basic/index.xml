<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Go Learning â€“ ğŸš è¯­è¨€åŸºç¡€</title><link>https://shipengqi.github.io/golang-learn/docs/basic/</link><description>Recent content in ğŸš è¯­è¨€åŸºç¡€ on Go Learning</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><atom:link href="https://shipengqi.github.io/golang-learn/docs/basic/index.xml" rel="self" type="application/rss+xml"/><item><title>åŸºç¡€æ•°æ®ç±»å‹</title><link>https://shipengqi.github.io/golang-learn/docs/basic/01_basic_type/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/01_basic_type/</guid><description>
&lt;h2>æ•°å€¼ç±»å‹&lt;span class="hx-absolute -hx-mt-20" id="æ•°å€¼ç±»å‹">&lt;/span>
&lt;a href="#%e6%95%b0%e5%80%bc%e7%b1%bb%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>æ•´å‹&lt;span class="hx-absolute -hx-mt-20" id="æ•´å‹">&lt;/span>
&lt;a href="#%e6%95%b4%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>&lt;code>uint&lt;/code>ï¼Œæ— ç¬¦å· 32 æˆ– 64 ä½æ•´å‹&lt;/li>
&lt;li>&lt;code>uint8&lt;/code>ï¼Œæ— ç¬¦å· 8 ä½æ•´å‹ (0 åˆ° 255)&lt;/li>
&lt;li>&lt;code>uint16&lt;/code>ï¼Œæ— ç¬¦å· 16 ä½æ•´å‹ (0 åˆ° 65535)&lt;/li>
&lt;li>&lt;code>uint32&lt;/code>ï¼Œæ— ç¬¦å· 32 ä½æ•´å‹ (0 åˆ° 4294967295)&lt;/li>
&lt;li>&lt;code>uint64&lt;/code>ï¼Œæ— ç¬¦å· 64 ä½æ•´å‹ (0 åˆ° 18446744073709551615)&lt;/li>
&lt;li>&lt;code>int&lt;/code>ï¼Œæœ‰ç¬¦å· 32 æˆ– 64 ä½æ•´å‹&lt;/li>
&lt;li>&lt;code>int8&lt;/code>ï¼Œæœ‰ç¬¦å· 8 ä½æ•´å‹ (-128 åˆ° 127)&lt;/li>
&lt;li>&lt;code>int16&lt;/code>ï¼Œæœ‰ç¬¦å· 16 ä½æ•´å‹ (-32768 åˆ° 32767)&lt;/li>
&lt;li>&lt;code>int32&lt;/code>ï¼Œæœ‰ç¬¦å· 32 ä½æ•´å‹ (-2147483648 åˆ° 2147483647)&lt;/li>
&lt;li>&lt;code>int64&lt;/code>ï¼Œæœ‰ç¬¦å· 64 ä½æ•´å‹ (-9223372036854775808 åˆ° 9223372036854775807)&lt;/li>
&lt;/ul>
&lt;p>&lt;code>int&lt;/code> å’Œ &lt;code>uint&lt;/code> å¯¹åº”çš„æ˜¯ CPU å¹³å°æœºå™¨çš„å­—å¤§å°ã€‚&lt;/p>
&lt;h3>æµ®ç‚¹æ•°&lt;span class="hx-absolute -hx-mt-20" id="æµ®ç‚¹æ•°">&lt;/span>
&lt;a href="#%e6%b5%ae%e7%82%b9%e6%95%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>float32&lt;/code> å’Œ &lt;code>float64&lt;/code> çš„ç®—æœ¯è§„èŒƒç”± IEEE-754 æµ®ç‚¹æ•°å›½é™…æ ‡å‡†å®šä¹‰ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>float32&lt;/code>ï¼Œ32 ä½æµ®ç‚¹å‹æ•°ï¼Œ&lt;code>math.MaxFloat32&lt;/code> è¡¨ç¤º &lt;code>float32&lt;/code> èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼ï¼Œå¤§çº¦æ˜¯ &lt;code>3.4e38&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>float64&lt;/code>ï¼Œ64 ä½æµ®ç‚¹å‹æ•°ï¼Œ&lt;code>math.MaxFloat64&lt;/code> è¡¨ç¤º &lt;code>float64&lt;/code> èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å€¼ï¼Œå¤§çº¦æ˜¯ &lt;code>1.8e308&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;h3>å¤æ•°&lt;span class="hx-absolute -hx-mt-20" id="å¤æ•°">&lt;/span>
&lt;a href="#%e5%a4%8d%e6%95%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>&lt;code>complex64&lt;/code>ï¼Œå¯¹åº” &lt;code>float32&lt;/code> æµ®ç‚¹æ•°ç²¾åº¦ã€‚&lt;/li>
&lt;li>&lt;code>complex128&lt;/code>ï¼Œå¯¹åº” &lt;code>float64&lt;/code> æµ®ç‚¹æ•°ç²¾åº¦ã€‚&lt;/li>
&lt;/ul>
&lt;p>å†…ç½® &lt;code>complex&lt;/code> å‡½æ•°åˆ›å»ºå¤æ•°ã€‚æ ‡å‡†åº“ &lt;code>math/cmplx&lt;/code> æä¾›äº†å¤„ç†å¤æ•°çš„å‡½æ•°ã€‚&lt;/p>
&lt;h3>å…¶ä»–æ•°å€¼ç±»å‹&lt;span class="hx-absolute -hx-mt-20" id="å…¶ä»–æ•°å€¼ç±»å‹">&lt;/span>
&lt;a href="#%e5%85%b6%e4%bb%96%e6%95%b0%e5%80%bc%e7%b1%bb%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>&lt;strong>&lt;code>byte&lt;/code>ï¼Œ&lt;code>uint8&lt;/code>çš„åˆ«å&lt;/strong>ï¼Œä¸€èˆ¬ç”¨äºå¼ºè°ƒæ•°å€¼æ˜¯ä¸€ä¸ªåŸå§‹çš„æ•°æ®è€Œä¸æ˜¯ä¸€ä¸ªå°çš„æ•´æ•°ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>rune&lt;/code>ï¼Œ&lt;code>int32&lt;/code>çš„åˆ«å&lt;/strong>ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºä¸€ä¸ª &lt;code>Unicode&lt;/code> ç ç‚¹ã€‚&lt;/li>
&lt;li>&lt;code>uintptr&lt;/code>ï¼Œæ— ç¬¦å·æ•´å‹ï¼Œæ²¡æœ‰æŒ‡å®šå…·ä½“çš„ &lt;code>bit&lt;/code> å¤§å°ï¼Œç”¨äºå­˜æ”¾ä¸€ä¸ªæŒ‡é’ˆã€‚&lt;/li>
&lt;/ul>
&lt;h2>å¸ƒå°”ç±»å‹&lt;span class="hx-absolute -hx-mt-20" id="å¸ƒå°”ç±»å‹">&lt;/span>
&lt;a href="#%e5%b8%83%e5%b0%94%e7%b1%bb%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å¸ƒå°”ç±»å‹çš„å€¼åªæœ‰ä¸¤ç§ï¼š&lt;code>true&lt;/code> å’Œ &lt;code>false&lt;/code>ã€‚&lt;/p>
&lt;h2>å­—ç¬¦ä¸²&lt;span class="hx-absolute -hx-mt-20" id="å­—ç¬¦ä¸²">&lt;/span>
&lt;a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯ç”±&lt;strong>å­—ç¬¦ç»„æˆçš„æ•°ç»„&lt;/strong>ï¼ŒC è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²ä½¿ç”¨å­—ç¬¦æ•°ç»„ &lt;code>char[]&lt;/code> è¡¨ç¤ºã€‚æ•°ç»„ä¼šå ç”¨ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œè€Œå†…å­˜ç©ºé—´å­˜å‚¨çš„å­—èŠ‚å…±åŒç»„æˆäº†å­—ç¬¦ä¸²ï¼ŒGo ä¸­çš„å­—ç¬¦ä¸²åªæ˜¯ä¸€ä¸ª&lt;strong>åªè¯»çš„å­—èŠ‚æ•°ç»„&lt;/strong>ã€‚&lt;/p>
&lt;p>å­—ç¬¦ä¸²çš„ç»“æ„ä½“ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// src/reflect/value.go#L1983
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">StringHeader&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Data&lt;/span> &lt;span class="kt">uintptr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Len&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸åˆ‡ç‰‡çš„ç»“æ„ä½“å¾ˆåƒï¼Œåªä¸è¿‡å°‘äº†ä¸€ä¸ªå®¹é‡ &lt;code>Cap&lt;/code>ã€‚&lt;/p>
&lt;p>å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªåªè¯»çš„ç±»å‹ï¼Œä¸å¯ä»¥ç›´æ¥å‘å­—ç¬¦ä¸²ç›´æ¥è¿½åŠ å…ƒç´ æ”¹å˜å…¶æœ¬èº«çš„å†…å­˜ç©ºé—´ï¼Œæ‰€æœ‰åœ¨&lt;strong>å­—ç¬¦ä¸²ä¸Šçš„å†™å…¥æ“ä½œéƒ½æ˜¯é€šè¿‡æ‹·è´å®ç°çš„&lt;/strong>ã€‚&lt;/p>
&lt;h3>å­—ç¬¦ä¸²æ‹¼æ¥&lt;span class="hx-absolute -hx-mt-20" id="å­—ç¬¦ä¸²æ‹¼æ¥">&lt;/span>
&lt;a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%8b%bc%e6%8e%a5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æ‹¼æ¥å­—ç¬¦ä¸²çš„å‡ ç§æ–¹å¼ï¼š&lt;/p>
&lt;h4>&lt;code>+&lt;/code> æ‹¼æ¥å­—ç¬¦ä¸²&lt;span class="hx-absolute -hx-mt-20" id="-æ‹¼æ¥å­—ç¬¦ä¸²">&lt;/span>
&lt;a href="#-%e6%8b%bc%e6%8e%a5%e5%ad%97%e7%ac%a6%e4%b8%b2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä¾‹å¦‚ &lt;code>fmt.Println(&amp;quot;hello&amp;quot; + s[5:])&lt;/code> è¾“å‡º &lt;code>&amp;quot;hello, world&amp;quot;&lt;/code>ã€‚ä½¿ç”¨ &lt;code>+&lt;/code> æ¥æ‹¼æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šç”³è¯·ä¸€å—æ–°çš„å†…å­˜ç©ºé—´ï¼Œå¤§å°æ˜¯ä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ä¹‹å’Œã€‚æ‹¼æ¥ç¬¬ä¸‰ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œå†ç”³è¯·ä¸€å—æ–°çš„å†…å­˜ç©ºé—´ï¼Œå¤§å°æ˜¯ä¸‰ä¸ªå­—ç¬¦ä¸²å¤§å°ä¹‹å’Œã€‚è¿™ç§æ–¹å¼æ¯æ¬¡è¿ç®—éƒ½éœ€è¦é‡æ–°åˆ†é…å†…å­˜ï¼Œä¼šç»™å†…å­˜åˆ†é…å’Œ GC å¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ï¼Œæ‰€ä»¥æ€§èƒ½æ¯”è¾ƒå·®ã€‚&lt;/p>
&lt;h4>fmt.Sprintf&lt;span class="hx-absolute -hx-mt-20" id="fmtsprintf">&lt;/span>
&lt;a href="#fmtsprintf" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;code>fmt.Sprintf()&lt;/code> æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œå†…éƒ¨ä½¿ç”¨ &lt;code>[]byte&lt;/code> å®ç°ï¼Œä¸åƒç›´æ¥è¿ç®—ç¬¦è¿™ç§ä¼šäº§ç”Ÿå¾ˆå¤šä¸´æ—¶çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯å†…éƒ¨çš„é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæœ‰å¾ˆå¤šé¢å¤–çš„åˆ¤æ–­ï¼Œè¿˜ç”¨åˆ°äº† &lt;code>interface&lt;/code>ï¼Œæ‰€ä»¥æ€§èƒ½ä¸€èˆ¬ã€‚&lt;/p>
&lt;h4>bytes.Buffer&lt;span class="hx-absolute -hx-mt-20" id="bytesbuffer">&lt;/span>
&lt;a href="#bytesbuffer" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>åˆ©ç”¨ &lt;code>bytes.Buffer&lt;/code> æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ˜¯æ¯”è¾ƒç†æƒ³çš„ä¸€ç§æ–¹å¼ã€‚å¯¹å†…å­˜çš„å¢é•¿æœ‰ä¼˜åŒ–ï¼Œå¦‚æœèƒ½é¢„ä¼°å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿˜å¯ä»¥ç”¨ &lt;code>buffer.Grow&lt;/code> æ¥å£æ¥è®¾ç½® &lt;code>capacity&lt;/code>ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">buffer&lt;/span> &lt;span class="nx">bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Buffer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">buffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">buffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;, &amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">buffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;world&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">buffer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">())&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h4>strings.Builder&lt;span class="hx-absolute -hx-mt-20" id="stringsbuilder">&lt;/span>
&lt;a href="#stringsbuilder" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;code>strings.Builder&lt;/code> å†…éƒ¨é€šè¿‡ &lt;code>slice&lt;/code> æ¥ä¿å­˜å’Œç®¡ç†å†…å®¹ã€‚&lt;code>strings.Builder&lt;/code> æ˜¯éçº¿ç¨‹å®‰å…¨ï¼Œæ€§èƒ½ä¸Šå’Œ &lt;code>bytes.Buffer&lt;/code> ç›¸å·®æ— å‡ ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">b1&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Builder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">b1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ABC&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">b1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;DEF&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">())&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>Builder.Grow&lt;/code> æ–¹æ³•å¯ä»¥é¢„åˆ†é…å†…å­˜ã€‚&lt;/p>
&lt;p>æ¨èä½¿ç”¨ &lt;code>strings.Builder&lt;/code> æ¥æ‹¼æ¥å­—ç¬¦ä¸²ã€‚&lt;/p>
&lt;p>&lt;code>strings.Builder&lt;/code> æ€§èƒ½ä¸Šæ¯” &lt;code>bytes.Buffer&lt;/code> ç•¥å¿«ï¼Œä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„åŒºåˆ«åœ¨äºï¼Œ&lt;code>bytes.Buffer&lt;/code> è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é‡æ–°ç”³è¯·äº†ä¸€å—ç©ºé—´ï¼Œå­˜æ”¾ç”Ÿæˆçš„å­—ç¬¦ä¸²å˜é‡ï¼Œè€Œ &lt;code>strings.Builder&lt;/code> ç›´æ¥å°†åº•å±‚çš„ &lt;code>[]byte&lt;/code> è½¬æ¢æˆäº†å­—ç¬¦ä¸²ç±»å‹å¹¶è¿”å›ã€‚&lt;/p>
&lt;p>&lt;code>bytes.Buffer&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Buffer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">String&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Special case, useful in debugging.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;&amp;lt;nil&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">off&lt;/span>&lt;span class="p">:])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>strings.Builder&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Builder&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">String&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SliceData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buf&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ç±»å‹è½¬æ¢&lt;span class="hx-absolute -hx-mt-20" id="ç±»å‹è½¬æ¢">&lt;/span>
&lt;a href="#%e7%b1%bb%e5%9e%8b%e8%bd%ac%e6%8d%a2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œ&lt;code>string&lt;/code> å’Œ &lt;code>[]byte&lt;/code> ä¹‹é—´çš„è½¬æ¢æ˜¯å¾ˆå¸¸è§çš„ï¼Œä¸ç®¡æ˜¯ &lt;code>string&lt;/code> è½¬ &lt;code>[]byte&lt;/code> è¿˜æ˜¯ &lt;code>[]byte&lt;/code> è½¬ &lt;code>string&lt;/code> éƒ½éœ€è¦æ‹·è´æ•°æ®ï¼Œè€Œå†…å­˜æ‹·è´å¸¦æ¥çš„æ€§èƒ½æŸè€—ä¼šéšç€å­—ç¬¦ä¸²å’Œ &lt;code>[]byte&lt;/code> é•¿åº¦çš„å¢é•¿è€Œå¢é•¿ã€‚&lt;/p></description></item><item><title>æ•°ç»„</title><link>https://shipengqi.github.io/golang-learn/docs/basic/02_array/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/02_array/</guid><description>
&lt;p>æ•°ç»„æ˜¯ä¸€ä¸ªç”±&lt;strong>å›ºå®šé•¿åº¦&lt;/strong>ï¼Œ&lt;strong>ç›¸åŒç±»å‹çš„å…ƒç´ &lt;/strong>ç»„æˆçš„æ•°æ®ç»“æ„ã€‚è®¡ç®—æœºä¼šä¸ºæ•°ç»„åˆ†é…ä¸€å—&lt;strong>è¿ç»­çš„å†…å­˜&lt;/strong>æ¥ä¿å­˜å…¶ä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨&lt;strong>ç´¢å¼•&lt;/strong>å¿«é€Ÿè®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚&lt;/p>
&lt;h2>åˆå§‹åŒ–&lt;span class="hx-absolute -hx-mt-20" id="åˆå§‹åŒ–">&lt;/span>
&lt;a href="#%e5%88%9d%e5%a7%8b%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">arr1&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">arr2&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="c1">// `...` çœç•¥å·ï¼Œè¡¨ç¤ºæ•°ç»„çš„é•¿åº¦æ˜¯æ ¹æ®åˆå§‹åŒ–å€¼çš„ä¸ªæ•°æ¥è®¡ç®—
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ•°ç»„çš„é•¿åº¦åœ¨ç¼–è¯‘é˜¶æ®µç¡®å®šï¼Œåˆå§‹åŒ–ä¹‹åå¤§å°å°±æ— æ³•æ”¹å˜ã€‚&lt;/p>
&lt;p>&lt;strong>æ•°ç»„æ˜¯å¦åº”è¯¥åœ¨å †æ ˆä¸­åˆå§‹åŒ–åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†&lt;/strong>ã€‚&lt;/p>
&lt;p>æ ¹æ®æ•°ç»„å¤§å°ï¼š&lt;/p>
&lt;ul>
&lt;li>å½“å…ƒç´ æ•°é‡å°äºæˆ–è€…ç­‰äº 4 ä¸ªæ—¶ï¼Œä¼šç›´æ¥å°†æ•°ç»„ä¸­çš„å…ƒç´ æ”¾ç½®åœ¨æ ˆä¸Šã€‚&lt;/li>
&lt;li>å½“å…ƒç´ æ•°é‡å¤§äº 4 ä¸ªæ—¶ï¼Œä¼šå°†æ•°ç»„ä¸­çš„å…ƒç´ æ”¾ç½®åˆ°é™æ€åŒºï¼Œå¹¶åœ¨è¿è¡Œæ—¶å–å‡ºã€‚&lt;/li>
&lt;/ul></description></item><item><title>åˆ‡ç‰‡</title><link>https://shipengqi.github.io/golang-learn/docs/basic/03_slice/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/03_slice/</guid><description>
&lt;p>åˆ‡ç‰‡ (slice) åœ¨ä½¿ç”¨ä¸Šå’Œæ•°ç»„å·®ä¸å¤šï¼ŒåŒºåˆ«æ˜¯åˆ‡ç‰‡æ˜¯&lt;strong>å¯å˜é•¿&lt;/strong>çš„ï¼Œå®šä¹‰çš„æ—¶å€™ä¸éœ€è¦æŒ‡å®š sizeã€‚&lt;/p>
&lt;p>åˆ‡ç‰‡å¯ä»¥çœ‹åšæ˜¯å¯¹æ•°ç»„çš„ä¸€å±‚ç®€å•çš„å°è£…ï¼Œåˆ‡ç‰‡çš„åº•å±‚æ•°æ®ç»“æ„ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ªæ•°ç»„ã€‚&lt;/p>
&lt;p>åˆ‡ç‰‡çš„ç»“æ„ä½“ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// src/reflect/value.go
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">SliceHeader&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Data&lt;/span> &lt;span class="kt">uintptr&lt;/span> &lt;span class="c1">// æŒ‡å‘åº•å±‚æ•°ç»„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">Len&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// å½“å‰åˆ‡ç‰‡é•¿åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">Cap&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="c1">// å½“å‰åˆ‡ç‰‡å®¹é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ³¨æ„ &lt;code>Cap&lt;/code> ä¹Ÿæ˜¯åº•å±‚æ•°ç»„çš„é•¿åº¦ã€‚&lt;code>Data&lt;/code> æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œå¯ä»¥å­˜å‚¨åˆ‡ç‰‡ &lt;code>Cap&lt;/code> å¤§å°çš„æ‰€æœ‰å…ƒç´ ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/slice-struct.png" alt="slice-struct" loading="lazy" />&lt;/p>
&lt;p>å¦‚å›¾ï¼Œè™½ç„¶ slice çš„ &lt;code>Len&lt;/code> æ˜¯ 5ï¼Œä½†æ˜¯åº•å±‚æ•°ç»„çš„é•¿åº¦æ˜¯ 10ï¼Œä¹Ÿå°±æ˜¯ &lt;code>Cap&lt;/code>ã€‚&lt;/p>
&lt;h2>åˆå§‹åŒ–&lt;span class="hx-absolute -hx-mt-20" id="åˆå§‹åŒ–">&lt;/span>
&lt;a href="#%e5%88%9d%e5%a7%8b%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åˆå§‹åŒ–åˆ‡ç‰‡æœ‰ä¸‰ç§æ–¹å¼ï¼š&lt;/p>
&lt;ol>
&lt;li>ä½¿ç”¨ &lt;code>make&lt;/code>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// len æ˜¯åˆ‡ç‰‡çš„åˆå§‹é•¿åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// capacity ä¸ºå¯é€‰å‚æ•°, æŒ‡å®šå®¹é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">len&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">capacity&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>ä½¿ç”¨å­—é¢é‡
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">arr&lt;/span> &lt;span class="o">:=&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>ä½¿ç”¨ä¸‹æ ‡æˆªå–æ•°ç»„æˆ–è€…åˆ‡ç‰‡çš„ä¸€éƒ¨åˆ†ï¼Œè¿™é‡Œå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•° &lt;code>[low:high:max]&lt;/code>ï¼Œ&lt;code>max - low&lt;/code> æ˜¯æ–°çš„åˆ‡ç‰‡çš„å®¹é‡ capã€‚
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">numbers&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">numbers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">// [1 2 3]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">numbers&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">:]&lt;/span> &lt;span class="c1">// [4 5 6 7 8]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">numbers&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="c1">// [0 1 2]
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;/ol>
&lt;p>ã€ŠGo å­¦ä¹ ç¬”è®°ã€‹ ç¬¬å››ç‰ˆ ä¸­çš„ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">slice&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">9&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s1&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">slice&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s2&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">s1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s2&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">200&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s1&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">slice&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å‡ºï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>[2 3 20]
[4 5 6 7 100 200]
[0 1 2 3 20 5 6 7 100 9]&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç¤ºä¾‹ä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>s1 := slice[2:5]&lt;/code> å¾—åˆ°çš„ &lt;code>s1&lt;/code> çš„å®¹é‡ä¸º 8ï¼Œå› ä¸ºæ²¡æœ‰ä¼ å…¥ &lt;code>max&lt;/code>ï¼Œå®¹é‡é»˜è®¤æ˜¯åˆ°åº•å±‚æ•°ç»„çš„ç»“å°¾ã€‚&lt;/li>
&lt;li>&lt;code>s2 := s1[2:6:7]&lt;/code> å¾—åˆ°çš„ &lt;code>s2&lt;/code> çš„å®¹é‡ä¸º 5ï¼ˆ&lt;code>max - low&lt;/code>ï¼‰ã€‚&lt;code>s2&lt;/code>ï¼Œ&lt;code>s1&lt;/code> å’Œ &lt;code>slice&lt;/code> åº•å±‚æ•°ç»„æ˜¯åŒä¸€ä¸ªï¼Œæ‰€ä»¥ &lt;code>s2&lt;/code> ä¸­çš„å…ƒç´ æ˜¯ &lt;code>[4,5,6,7]&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/slice-cut.png" alt="slice-cut" loading="lazy" />&lt;/p>
&lt;p>ä¸‹é¢çš„ &lt;code>s2 = append(s2, 100)&lt;/code> è¿½åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå®¹é‡å¤Ÿç”¨ï¼Œä¸éœ€è¦æ‰©å®¹ï¼Œä½†æ˜¯è¿™ä¸ªä¿®æ”¹ä¼šå½±å“æ‰€æœ‰æŒ‡å‘è¿™ä¸ªåº•å±‚æ•°ç»„çš„åˆ‡ç‰‡ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/slice-cut-append.png" alt="slice-cut-append" loading="lazy" />&lt;/p>
&lt;p>å†æ¬¡è¿½åŠ ä¸€ä¸ªå…ƒç´  &lt;code>s2 = append(s2, 200)&lt;/code>ï¼Œ&lt;code>s2&lt;/code> çš„å®¹é‡ä¸å¤Ÿäº†ï¼Œéœ€è¦æ‰©å®¹ï¼Œäºæ˜¯ &lt;code>s2&lt;/code> ç”³è¯·ä¸€å—æ–°çš„è¿ç»­å†…å­˜ï¼Œå¹¶å°†æ•°æ®æ‹·è´è¿‡å»ï¼Œæ‰©å®¹åçš„å®¹é‡æ˜¯åŸæ¥çš„ 2 å€ã€‚
è¿™æ—¶å€™ &lt;code>s2&lt;/code> çš„ &lt;code>Data&lt;/code> æŒ‡å‘äº†æ–°çš„åº•å±‚æ•°ç»„ï¼Œå·²ç»å’Œ &lt;code>s1&lt;/code> &lt;code>slice&lt;/code> æ²¡æœ‰å…³ç³»äº†ï¼Œå¯¹ &lt;code>s2&lt;/code> çš„ä¿®æ”¹ä¸ä¼šå†å½±å“ &lt;code>s1&lt;/code> &lt;code>slice&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/slice-cut-append2.png" alt="slice-cut-append2" loading="lazy" />&lt;/p>
&lt;p>æœ€å &lt;code>s1[2] = 20&lt;/code> ä¹Ÿä¸ä¼šå†å½±å“ &lt;code>s2&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/slice-cut-append3.png" alt="slice-cut-append3" loading="lazy" />&lt;/p>
&lt;h2>åˆ‡ç‰‡æ˜¯å¦‚ä½•æ‰©å®¹çš„ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="åˆ‡ç‰‡æ˜¯å¦‚ä½•æ‰©å®¹çš„">&lt;/span>
&lt;a href="#%e5%88%87%e7%89%87%e6%98%af%e5%a6%82%e4%bd%95%e6%89%a9%e5%ae%b9%e7%9a%84" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>append&lt;/code> æ˜¯ç”¨æ¥å‘ slice è¿½åŠ å…ƒç´ çš„ï¼Œå¹¶&lt;strong>è¿”å›ä¸€ä¸ªæ–°çš„ slice&lt;/strong>ã€‚&lt;/p>
&lt;p>&lt;code>append&lt;/code> å®é™…ä¸Šå°±æ˜¯å‘åº•å±‚æ•°ç»„æ·»åŠ å…ƒç´ ï¼Œä½†æ˜¯æ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼š&lt;/p>
&lt;p>å½“è¿½åŠ å…ƒç´ ååˆ‡ç‰‡çš„å¤§å°å¤§äºå®¹é‡ï¼Œruntime ä¼šå¯¹åˆ‡ç‰‡è¿›è¡Œæ‰©å®¹ï¼Œè¿™æ—¶ä¼šç”³è¯·ä¸€å—æ–°çš„è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œç„¶åå°†åŸæ•°æ®æ‹·è´åˆ°æ–°çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”å°† &lt;code>append&lt;/code> çš„å…ƒç´ æ·»åŠ åˆ°æ–°çš„åº•å±‚æ•°ç»„ä¸­ï¼Œå¹¶è¿”å›è¿™ä¸ªæ–°çš„åˆ‡ç‰‡ã€‚&lt;/p>
&lt;p>Go 1.18 ååˆ‡ç‰‡çš„æ‰©å®¹ç­–ç•¥ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æœå½“å‰åˆ‡ç‰‡çš„å®¹é‡ï¼ˆ&lt;code>oldcap&lt;/code>ï¼‰å°äº 256ï¼Œæ–°åˆ‡ç‰‡çš„å®¹é‡ï¼ˆ&lt;code>newcap&lt;/code>ï¼‰ä¸ºåŸæ¥çš„ 2 å€.&lt;/li>
&lt;li>å¦‚æœå½“å‰åˆ‡ç‰‡çš„å®¹é‡å¤§äº 256ï¼Œè®¡ç®—æ–°åˆ‡ç‰‡çš„å®¹é‡çš„å…¬å¼ &lt;code>newcap = oldcap+(oldcap+3*256)/4&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2>åˆ‡ç‰‡ä¼ å…¥å‡½æ•°&lt;span class="hx-absolute -hx-mt-20" id="åˆ‡ç‰‡ä¼ å…¥å‡½æ•°">&lt;/span>
&lt;a href="#%e5%88%87%e7%89%87%e4%bc%a0%e5%85%a5%e5%87%bd%e6%95%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go æ˜¯å€¼ä¼ é€’ã€‚é‚£ä¹ˆä¼ å…¥ä¸€ä¸ªåˆ‡ç‰‡ï¼Œåˆ‡ç‰‡ä¼šä¸ä¼šè¢«å‡½æ•°ä¸­çš„æ“ä½œæ”¹å˜ï¼Ÿ&lt;/p>
&lt;p>&lt;strong>ä¸ç®¡ä¼ å…¥çš„æ˜¯åˆ‡ç‰‡è¿˜æ˜¯åˆ‡ç‰‡æŒ‡é’ˆï¼Œå¦‚æœæ”¹å˜äº†åº•å±‚æ•°ç»„ï¼ŒåŸåˆ‡ç‰‡çš„åº•å±‚æ•°ç»„ä¹Ÿä¼šè¢«æ”¹å˜&lt;/strong>ã€‚&lt;/p>
&lt;p>ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">appendFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">appendPtrFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sl&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">appendFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">sl&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// appendFunc ä¿®æ”¹çš„æ˜¯ sl çš„å‰¯æœ¬ï¼Œlen å’Œ cap å¹¶æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œä¸‹é¢çš„è¾“å‡ºæ˜¯ []
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">sl&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// []
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// appendFuncï¼Œè™½ç„¶æ²¡æœ‰ä¿®æ”¹ len å’Œ capï¼Œä½†æ˜¯åº•å±‚æ•°ç»„æ˜¯è¢«ä¿®æ”¹äº†çš„ï¼Œæ‰€ä»¥ä¸‹é¢çš„è¾“å‡ºä¼šåŒ…å« 10 20 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">sl&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="c1">// [10 20 30 0 0 0 0 0 0 0]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºä»€ä¹ˆ sl[:10] å’Œ sl[:] çš„è¾“å‡ºä¸åŒï¼Œæ˜¯å› ä¸º go çš„åˆ‡ç‰‡çš„ä¸€ä¸ªä¼˜åŒ–
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// slice[low:high] ä¸­çš„ highï¼Œæœ€å¤§çš„å–å€¼èŒƒå›´å¯¹åº”ç€åˆ‡ç‰‡çš„å®¹é‡ï¼ˆcapï¼‰ï¼Œä¸æ˜¯å•çº¯çš„é•¿åº¦ï¼ˆlenï¼‰ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// sl[:10] å¯ä»¥è¾“å‡ºå®¹é‡èŒƒå›´å†…çš„å€¼ï¼Œå¹¶ä¸”æ²¡æœ‰è¶Šç•Œã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// sl[:] ç”±äº len ä¸º 0ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®šæœ€å¤§ç´¢å¼•ã€‚high åˆ™ä¼šå– len çš„å€¼ï¼Œæ‰€ä»¥è¾“å‡ºä¸º []
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">sl&lt;/span>&lt;span class="p">[:])&lt;/span> &lt;span class="c1">// []
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">slptr&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">appendPtrFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">slptr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¿™é‡Œä¼ å…¥çš„æ˜¯åˆ‡ç‰‡çš„æŒ‡é’ˆï¼Œä¼šæ”¹å˜å¤–å±‚çš„ slptr
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">slptr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// [10 20 30]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div></description></item><item><title>å“ˆå¸Œè¡¨</title><link>https://shipengqi.github.io/golang-learn/docs/basic/04_map/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/04_map/</guid><description>
&lt;p>&lt;code>map&lt;/code> æ˜¯ä¸€ä¸ªæ— åºçš„ &lt;code>key/value&lt;/code> å¯¹çš„é›†åˆï¼ŒåŒä¸€ä¸ª key åªä¼šå‡ºç°ä¸€æ¬¡ã€‚&lt;/p>
&lt;h2>å“ˆå¸Œè¡¨çš„è®¾è®¡åŸç†&lt;span class="hx-absolute -hx-mt-20" id="å“ˆå¸Œè¡¨çš„è®¾è®¡åŸç†">&lt;/span>
&lt;a href="#%e5%93%88%e5%b8%8c%e8%a1%a8%e7%9a%84%e8%ae%be%e8%ae%a1%e5%8e%9f%e7%90%86" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å“ˆå¸Œè¡¨å…¶å®æ˜¯æ•°ç»„çš„æ‰©å±•ã€‚å“ˆå¸Œè¡¨æ˜¯åˆ©ç”¨æ•°ç»„å¯ä»¥æ ¹æ®ä¸‹æ ‡éšæœºè®¿é—®ï¼ˆæ—¶é—´å¤æ‚åº¦æ˜¯ &lt;code>O(1)&lt;/code>ï¼‰è¿™ä¸€ç‰¹æ€§æ¥å®ç°å¿«é€ŸæŸ¥æ‰¾çš„ã€‚&lt;/p>
&lt;h3>å“ˆå¸Œå‡½æ•°&lt;span class="hx-absolute -hx-mt-20" id="å“ˆå¸Œå‡½æ•°">&lt;/span>
&lt;a href="#%e5%93%88%e5%b8%8c%e5%87%bd%e6%95%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å“ˆå¸Œè¡¨æ˜¯é€šè¿‡&lt;strong>å“ˆå¸Œå‡½æ•°&lt;/strong>å°† key è½¬åŒ–ä¸ºæ•°ç»„çš„ä¸‹æ ‡ï¼Œç„¶åå°†æ•°æ®å­˜å‚¨åœ¨æ•°ç»„ä¸‹æ ‡å¯¹åº”çš„ä½ç½®ã€‚æŸ¥è¯¢æ—¶ï¼Œä¹Ÿæ˜¯åŒæ ·çš„ä½¿ç”¨å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºæ•°ç»„ä¸‹æ ‡ï¼Œä»ä¸‹æ ‡å¯¹åº”çš„ä½ç½®å–å‡ºæ•°æ®ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/hash-func.png" alt="map-seek-addr" loading="lazy" />&lt;/p>
&lt;p>å“ˆå¸Œå‡½æ•°çš„åŸºæœ¬è¦æ±‚ï¼š&lt;/p>
&lt;ol>
&lt;li>å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºæ¥çš„å€¼æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚&lt;/li>
&lt;li>å¦‚æœ &lt;code>key1 == key2&lt;/code> é‚£ä¹ˆ &lt;code>hash(key1) == hash(key2)&lt;/code>&lt;/li>
&lt;li>å¦‚æœ &lt;code>key1 != key2&lt;/code> é‚£ä¹ˆ &lt;code>hash(key1) != hash(key2)&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>ç¬¬ä¸‰ç‚¹ï¼Œæƒ³è¦å®ç°ä¸€ä¸ªä¸åŒçš„ key å¯¹åº”çš„å“ˆå¸Œå€¼ç»å¯¹ä¸ä¸€æ ·çš„å“ˆå¸Œå‡½æ•°ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä¹Ÿå°±è¯´æ— æ³•é¿å…&lt;strong>å“ˆå¸Œå†²çª&lt;/strong>ã€‚&lt;/p>
&lt;p>å¸¸ç”¨çš„å¤„ç†å“ˆå¸Œå†²çªçš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š&lt;strong>å¼€æ”¾å¯»å€æ³•&lt;/strong>å’Œ&lt;strong>é“¾è¡¨æ³•&lt;/strong>ã€‚&lt;/p>
&lt;h3>å¼€æ”¾å¯»å€æ³•&lt;span class="hx-absolute -hx-mt-20" id="å¼€æ”¾å¯»å€æ³•">&lt;/span>
&lt;a href="#%e5%bc%80%e6%94%be%e5%af%bb%e5%9d%80%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¼€æ”¾å¯»å€æ³•æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœå‡ºç°äº†å“ˆå¸Œå†²çªï¼Œå°±é‡æ–°æ¢æµ‹ä¸€ä¸ªç©ºé—²ä½ç½®ï¼Œå°†å…¶æ’å…¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/map-seek-addr.png" alt="map-seek-addr" loading="lazy" />&lt;/p>
&lt;p>ä¸Šå›¾è“è‰²è¡¨ç¤ºå·²ç»æ’å…¥çš„å…ƒç´ ï¼Œ&lt;code>key9&lt;/code> å“ˆå¸Œåå¾—åˆ°çš„æ•°ç»„ä¸‹æ ‡ä¸º 6ï¼Œä½†æ˜¯å·²ç»æœ‰æ•°æ®äº†ï¼Œäº§ç”Ÿäº†å†²çªã€‚é‚£ä¹ˆå°±æŒ‰é¡ºåºå‘åæŸ¥æ‰¾ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºé—²çš„ä½ç½®ï¼Œå¦‚æœåˆ°æ•°ç»„çš„å°¾éƒ¨éƒ½æ²¡æœ‰æ‰¾åˆ°ç©ºé—²çš„ä½ç½®ï¼Œå°±ä»å¤´å¼€å§‹ç»§ç»­æ‰¾ã€‚
ä¸Šå›¾æœ€ç»ˆæ‰¾åˆ°ä½ç½® 1 å¹¶æ’å…¥å…ƒç´ ã€‚&lt;/p>
&lt;p>æŸ¥æ‰¾çš„é€»è¾‘å’Œæ’å…¥ç±»ä¼¼ï¼Œä»å“ˆå¸Œå‡½æ•°è®¡ç®—å‡ºæ¥çš„ä¸‹æ ‡ä½ç½®å¼€å§‹æŸ¥æ‰¾ï¼Œæ¯”è¾ƒæ•°ç»„ä¸­ä¸‹æ ‡ä½ç½®çš„å…ƒç´ å’Œè¦æŸ¥æ‰¾çš„å…ƒç´ ã€‚å¦‚æœç›¸ç­‰ï¼Œåˆ™è¯´æ˜å°±æ˜¯è¦æ‰¾çš„å…ƒç´ ï¼›å¦åˆ™å°±é¡ºåºå¾€åä¾æ¬¡æŸ¥æ‰¾ã€‚ç›´åˆ°æ‰¾åˆ°æ•°ç»„ä¸­çš„ç©ºé—²ä½ç½®ï¼Œè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±è¯´æ˜è¦æŸ¥æ‰¾çš„å…ƒç´ å¹¶æ²¡æœ‰åœ¨å“ˆå¸Œè¡¨ä¸­ã€‚&lt;/p>
&lt;p>å¯ä»¥çœ‹å‡ºå½“æ•°ç»„ä¸­ç©ºé—²ä½ç½®ä¸å¤šçš„æ—¶å€™ï¼Œå“ˆå¸Œå†²çªçš„æ¦‚ç‡å°±ä¼šå¤§å¤§æé«˜ã€‚&lt;strong>è£…è½½å› å­&lt;/strong>ï¼ˆload factorï¼‰å°±æ˜¯ç”¨æ¥è¡¨ç¤ºç©ºä½çš„å¤šå°‘ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>è£…è½½å› å­=å·²æ’å…¥çš„å…ƒç´ ä¸ªæ•°/å“ˆå¸Œè¡¨çš„é•¿åº¦&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è£…è½½å› å­è¶Šå¤§ï¼Œè¯´æ˜ç©ºé—²ä½ç½®è¶Šå°‘ï¼Œå†²çªè¶Šå¤šï¼Œå“ˆå¸Œè¡¨çš„æ€§èƒ½ä¼šä¸‹é™ã€‚&lt;/p>
&lt;h3>é“¾è¡¨æ³•&lt;span class="hx-absolute -hx-mt-20" id="é“¾è¡¨æ³•">&lt;/span>
&lt;a href="#%e9%93%be%e8%a1%a8%e6%b3%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é“¾è¡¨æ³•æ˜¯æœ€å¸¸è§çš„å“ˆå¸Œå†²çªçš„è§£å†³åŠæ³•ã€‚åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ¯ä¸ªæ¡¶ï¼ˆbucketï¼‰ä¼šå¯¹åº”ä¸€æ¡é“¾è¡¨ï¼Œæ‰€æœ‰å“ˆå¸Œå€¼ç›¸åŒçš„å…ƒç´ éƒ½æ”¾åˆ°ç›¸åŒæ¡¶å¯¹åº”çš„é“¾è¡¨ä¸­ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/map-link.png" alt="map-link" loading="lazy" />&lt;/p>
&lt;p>æ’å…¥æ—¶ï¼Œå“ˆå¸Œå‡½æ•°è®¡ç®—åå¾—å‡ºå­˜æ”¾åœ¨å‡ å·æ¡¶ï¼Œç„¶åéå†æ¡¶ä¸­çš„é“¾è¡¨äº†ï¼š&lt;/p>
&lt;ul>
&lt;li>æ‰¾åˆ°é”®ç›¸åŒçš„é”®å€¼å¯¹ï¼Œåˆ™æ›´æ–°é”®å¯¹åº”çš„å€¼ï¼›&lt;/li>
&lt;li>æ²¡æœ‰æ‰¾åˆ°é”®ç›¸åŒçš„é”®å€¼å¯¹ï¼Œåˆ™åœ¨é“¾è¡¨çš„æœ«å°¾è¿½åŠ æ–°çš„é”®å€¼å¯¹&lt;/li>
&lt;/ul>
&lt;p>é“¾è¡¨æ³•å®ç°çš„å“ˆå¸Œè¡¨çš„è£…è½½å› å­ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>è£…è½½å› å­=å·²æ’å…¥çš„å…ƒç´ ä¸ªæ•°/æ¡¶æ•°é‡&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Go map åŸç†&lt;span class="hx-absolute -hx-mt-20" id="go-map-åŸç†">&lt;/span>
&lt;a href="#go-map-%e5%8e%9f%e7%90%86" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>è¡¨ç¤º map çš„ç»“æ„ä½“æ˜¯ &lt;code>hmap&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// src/runtime/map.go
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">hmap&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">count&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// çŠ¶æ€æ ‡è¯†ï¼Œä¸»è¦æ˜¯ goroutine å†™å…¥å’Œæ‰©å®¹æœºåˆ¶çš„ç›¸å…³çŠ¶æ€æ§åˆ¶ã€‚å¹¶å‘è¯»å†™çš„åˆ¤æ–­æ¡ä»¶ä¹‹ä¸€å°±æ˜¯è¯¥å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">flags&lt;/span> &lt;span class="kt">uint8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å“ˆå¸Œè¡¨æŒæœ‰çš„ buckets æ•°é‡ï¼Œä½†æ˜¯å› ä¸ºå“ˆå¸Œè¡¨ä¸­æ¡¶çš„æ•°é‡éƒ½ 2 çš„å€æ•°ï¼Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// æ‰€ä»¥è¯¥å­—æ®µä¼šå­˜å‚¨å¯¹æ•°ï¼Œä¹Ÿå°±æ˜¯ len(buckets) == 2^B
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">B&lt;/span> &lt;span class="kt">uint8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æº¢å‡ºæ¡¶çš„æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">noverflow&lt;/span> &lt;span class="kt">uint16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å“ˆå¸Œç§å­ï¼Œå®ƒèƒ½ä¸ºå“ˆå¸Œå‡½æ•°çš„ç»“æœå¼•å…¥éšæœºæ€§ï¼Œè¿™ä¸ªå€¼åœ¨åˆ›å»ºå“ˆå¸Œè¡¨æ—¶ç¡®å®šï¼Œå¹¶åœ¨è°ƒç”¨å“ˆå¸Œå‡½æ•°æ—¶ä½œä¸ºå‚æ•°ä¼ å…¥
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">hash0&lt;/span> &lt;span class="kt">uint32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŒ‡å‘ buckets æ•°ç»„ï¼Œé•¿åº¦ä¸º 2^B
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">buckets&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å“ˆå¸Œåœ¨æ‰©å®¹æ—¶ç”¨äºä¿å­˜ä¹‹å‰ buckets çš„å­—æ®µ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ç­‰é‡æ‰©å®¹çš„æ—¶å€™ï¼Œbuckets é•¿åº¦å’Œ oldbuckets ç›¸ç­‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// åŒå€æ‰©å®¹çš„æ—¶å€™ï¼Œbuckets é•¿åº¦æ˜¯ oldbuckets çš„ä¸¤å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">oldbuckets&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è¿ç§»è¿›åº¦ï¼Œå°äºæ­¤åœ°å€çš„ buckets æ˜¯å·²è¿ç§»å®Œæˆçš„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">nevacuate&lt;/span> &lt;span class="kt">uintptr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">extra&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">mapextra&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">mapextra&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// hmap.buckets ï¼ˆå½“å‰ï¼‰æº¢å‡ºæ¡¶çš„æŒ‡é’ˆåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">overflow&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">bmap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä¸º hmap.oldbuckets ï¼ˆæ—§ï¼‰æº¢å‡ºæ¡¶çš„æŒ‡é’ˆåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">oldoverflow&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">[]&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">bmap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä¸ºç©ºé—²æº¢å‡ºæ¡¶çš„æŒ‡é’ˆåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">nextOverflow&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">bmap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>hmap.buckets&lt;/code> å°±æ˜¯æŒ‡å‘ä¸€ä¸ª &lt;code>bmap&lt;/code> æ•°ç»„ã€‚&lt;code>bmap&lt;/code> çš„ç»“æ„ä½“ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">bmap&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">tophash&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">bucketCnt&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">uint8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ¨å¯¼é”®å€¼å¯¹å ç”¨å†…å­˜ç©ºé—´çš„å¤§å°ï¼Œç„¶åä¿®æ”¹ bmap çš„ç»“æ„
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">bmap&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">topbits&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">uint8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">keys&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="nx">keytype&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">values&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="nx">valuetype&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">pad&lt;/span> &lt;span class="kt">uintptr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">overflow&lt;/span> &lt;span class="kt">uintptr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>bmap&lt;/code> å°±æ˜¯æ¡¶ï¼Œä¸€ä¸ªæ¡¶é‡Œé¢ä¼šæœ€å¤šå­˜å‚¨ 8 ä¸ªé”®å€¼å¯¹ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/bmap-struct.png" alt="bmap-struct" loading="lazy" />&lt;/p>
&lt;ol>
&lt;li>åœ¨æ¡¶å†…ï¼Œä¼šæ ¹æ® key è®¡ç®—å‡ºæ¥çš„ hash å€¼çš„é«˜ 8 ä½æ¥å†³å®š key å­˜å‚¨åœ¨æ¡¶ä¸­çš„ä½ç½®ã€‚&lt;/li>
&lt;li>key å’Œ value æ˜¯åˆ†åˆ«æ”¾åœ¨ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†èŠ‚çœå†…å­˜ã€‚ä¾‹å¦‚ä¸€ä¸ª &lt;code>map[int64]int8&lt;/code> ç±»å‹çš„ mapï¼Œå¦‚æœæŒ‰ç…§ &lt;code>key1/value1/key2/value2 ...&lt;/code> è¿™æ ·çš„å½¢å¼æ¥å­˜å‚¨ï¼Œé‚£ä¹ˆå†…å­˜å¯¹é½æ¯ä¸ª &lt;code>key/value&lt;/code> éƒ½éœ€è¦ padding 7 ä¸ªå­—èŠ‚ã€‚
åˆ†å¼€è¿ç»­å­˜å‚¨çš„è¯ï¼Œå°±åªéœ€è¦åœ¨æœ€å padding ä¸€æ¬¡ã€‚&lt;/li>
&lt;li>æ¯ä¸ªæ¡¶åªèƒ½å­˜å‚¨ 8 ä¸ª &lt;code>key/value&lt;/code>ï¼Œå¦‚æœæœ‰æ›´å¤šçš„ key æ”¾å…¥å½“å‰æ¡¶ï¼Œå°±éœ€è¦ä¸€ä¸ªæº¢å‡ºæ¡¶ï¼Œé€šè¿‡ &lt;code>overflow&lt;/code> æŒ‡é’ˆè¿æ¥èµ·æ¥ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/hmap.png" alt="hmap" loading="lazy" />&lt;/p>
&lt;h3>åˆå§‹åŒ–&lt;span class="hx-absolute -hx-mt-20" id="åˆå§‹åŒ–">&lt;/span>
&lt;a href="#%e5%88%9d%e5%a7%8b%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åˆå§‹åŒ– &lt;code>map&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hash&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;5&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">hash2&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸ç®¡æ˜¯ä½¿ç”¨å­—é¢é‡è¿˜æ˜¯ &lt;code>make&lt;/code> åˆå§‹åŒ– mapï¼Œæœ€åéƒ½æ˜¯è°ƒç”¨ &lt;code>makemap&lt;/code> å‡½æ•°ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">makemap&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">hint&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// initialize Hmap
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è·å–ä¸€ä¸ªéšæœºçš„å“ˆå¸Œç§å­
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">hash0&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">fastrand&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ ¹æ®ä¼ å…¥çš„ hint è®¡ç®—å‡ºéœ€è¦çš„æœ€å°éœ€è¦çš„æ¡¶çš„æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">B&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">uint8&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nf">overLoadFactor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">hint&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">B&lt;/span>&lt;span class="o">++&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">B&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ– hash table
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¦‚æœ B ç­‰äº 0ï¼Œé‚£ä¹ˆ buckets å°±ä¼šåœ¨èµ‹å€¼çš„æ—¶å€™å†åˆ†é…
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¦‚æœ hint é•¿åº¦æ¯”è¾ƒå¤§ï¼Œåˆ†é…å†…å­˜ä¼šèŠ±è´¹é•¿ä¸€ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">nextOverflow&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">bmap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// makeBucketArray æ ¹æ®ä¼ å…¥çš„ B è®¡ç®—å‡ºçš„éœ€è¦åˆ›å»ºçš„æ¡¶æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¹¶åœ¨å†…å­˜ä¸­åˆ†é…ä¸€ç‰‡è¿ç»­çš„ç©ºé—´ç”¨äºå­˜å‚¨æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buckets&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">nextOverflow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">makeBucketArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">nextOverflow&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">extra&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">mapextra&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">extra&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nextOverflow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">nextOverflow&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é¢„åˆ†é…çš„æº¢å‡ºæ¡¶å’Œæ­£å¸¸æ¡¶æ˜¯åœ¨ä¸€å—è¿ç»­çš„å†…å­˜ä¸­ã€‚&lt;/p>
&lt;h3>æŸ¥è¯¢&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥è¯¢">&lt;/span>
&lt;a href="#%e6%9f%a5%e8%af%a2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æŸ¥è¯¢ map ä¸­çš„å€¼ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">hash&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">key&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">v&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ok&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">hash&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">key&lt;/span>&lt;span class="p">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿™ä¸¤ç§æŸ¥è¯¢æ–¹å¼ä¼šè¢«è½¬æ¢æˆ &lt;a href="https://github.com/golang/go/blob/8da6405e0db80fa0a4136fb816c7ca2db716c2b2/src/runtime/map.go#L396" target="_blank" rel="noopener">&lt;code>mapaccess1&lt;/code>&lt;/a> å’Œ &lt;code>mapaccess2&lt;/code> å‡½æ•°ï¼Œä¸¤ä¸ªå‡½æ•°åŸºæœ¬ä¸€æ ·ï¼Œä¸è¿‡ &lt;code>mapaccess2&lt;/code> å‡½æ•°çš„è¿”å›å€¼å¤šäº†ä¸€ä¸ª &lt;code>bool&lt;/code> ç±»å‹ã€‚&lt;/p>
&lt;p>æŸ¥è¯¢è¿‡ç¨‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/map-get.png" alt="map-get" loading="lazy" />&lt;/p>
&lt;h4>1. è®¡ç®—å“ˆå¸Œå€¼&lt;span class="hx-absolute -hx-mt-20" id="1-è®¡ç®—å“ˆå¸Œå€¼">&lt;/span>
&lt;a href="#1-%e8%ae%a1%e7%ae%97%e5%93%88%e5%b8%8c%e5%80%bc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>é€šè¿‡å“ˆå¸Œå‡½æ•°å’Œç§å­è·å–å½“å‰ key çš„ 64 ä½çš„å“ˆå¸Œå€¼ï¼ˆ64 ä½æœºï¼‰ã€‚ä»¥ä¸Šå›¾å“ˆå¸Œå€¼ï¼š&lt;code>11010111 | 110000110110110010001111001010100010010110010101001 â”‚ 00011&lt;/code> ä¸ºä¾‹ã€‚&lt;/p>
&lt;h4>2. è®¡ç®—è¿™ä¸ª key è¦æ”¾åœ¨å“ªä¸ªæ¡¶&lt;span class="hx-absolute -hx-mt-20" id="2-è®¡ç®—è¿™ä¸ª-key-è¦æ”¾åœ¨å“ªä¸ªæ¡¶">&lt;/span>
&lt;a href="#2-%e8%ae%a1%e7%ae%97%e8%bf%99%e4%b8%aa-key-%e8%a6%81%e6%94%be%e5%9c%a8%e5%93%aa%e4%b8%aa%e6%a1%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ ¹æ®å“ˆå¸Œå€¼çš„ &lt;code>B&lt;/code> ï¼ˆ&lt;code>hmap.B&lt;/code>ï¼‰ä¸ª bit ä½æ¥è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯ &lt;code>00011&lt;/code>ï¼Œåè¿›åˆ¶çš„å€¼æ˜¯ &lt;code>3&lt;/code>ï¼Œé‚£ä¹ˆå°±æ˜¯ &lt;code>3&lt;/code> å·æ¡¶ã€‚&lt;/p>
&lt;h4>3. è®¡ç®—è¿™ä¸ª key åœ¨æ¡¶å†…çš„ä½ç½®&lt;span class="hx-absolute -hx-mt-20" id="3-è®¡ç®—è¿™ä¸ª-key-åœ¨æ¡¶å†…çš„ä½ç½®">&lt;/span>
&lt;a href="#3-%e8%ae%a1%e7%ae%97%e8%bf%99%e4%b8%aa-key-%e5%9c%a8%e6%a1%b6%e5%86%85%e7%9a%84%e4%bd%8d%e7%bd%ae" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ ¹æ®å“ˆå¸Œå€¼çš„é«˜ 8 ä½ï¼Œä¹Ÿå°±æ˜¯ &lt;code>10010111&lt;/code>ï¼Œåè¿›åˆ¶çš„å€¼æ˜¯ &lt;code>151&lt;/code>ï¼Œå…ˆç”¨ &lt;code>151&lt;/code> å’Œæ¡¶å†…å­˜å‚¨çš„ &lt;code>tophash&lt;/code> æ¯”è¾ƒï¼Œå†æ¯”è¾ƒæ¡¶å†…çš„å­˜å‚¨çš„ key å’Œä¼ å…¥çš„ keyï¼Œè¿™ç§æ–¹å¼å¯ä»¥ä¼˜åŒ–æ¡¶å†…çš„è¯»å†™é€Ÿåº¦ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// src/runtime/map.go#L434 mapaccess1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">uintptr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">bucketCnt&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å…ˆæ¯”è¾ƒ tophashï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œå°±ç›´æ¥è¿›å…¥ä¸‹æ¬¡å¾ªç¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tophash&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nx">top&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">tophash&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">emptyRest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span> &lt;span class="nx">bucketloop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å†æ¯”è¾ƒæ¡¶å†…çš„ key å’Œä¼ å…¥çš„ keyï¼Œå¦‚æœç›¸ç­‰ï¼Œå†è·å–ç›®æ ‡å€¼çš„æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Key&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Equal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">k&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;blockquote>
&lt;p>è®¡ç®—åœ¨å‡ å·æ¡¶ç”¨çš„æ˜¯å &lt;code>B&lt;/code> ä½ï¼Œ&lt;code>tophash&lt;/code> ä½¿ç”¨çš„æ˜¯é«˜ 8 ä½ï¼Œè¿™ç§æ–¹å¼å¯ä»¥é¿å…ä¸€ä¸ªæ¡¶å†…å‡ºç°å¤§é‡ç›¸åŒçš„ &lt;code>tophash&lt;/code>ï¼Œå½±å“è¯»å†™çš„æ€§èƒ½ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>å¦‚æœå½“å‰æ¡¶ä¸­æ²¡æœ‰æ‰¾åˆ° keyï¼Œè€Œä¸”å­˜åœ¨æº¢å‡ºæ¡¶ï¼Œé‚£ä¹ˆä¼šæ¥ç€éå†æ‰€æœ‰çš„æº¢å‡ºæ¡¶ä¸­çš„æ•°æ®ã€‚&lt;/p>
&lt;h3>å†™å…¥&lt;span class="hx-absolute -hx-mt-20" id="å†™å…¥">&lt;/span>
&lt;a href="#%e5%86%99%e5%85%a5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å†™å…¥ map å’ŒæŸ¥è¯¢ map çš„å®ç°åŸç†ç±»ä¼¼ï¼Œè®¡ç®—å“ˆå¸Œå€¼å’Œå­˜æ”¾åœ¨å“ªä¸ªæ¡¶ï¼Œç„¶åéå†å½“å‰æ¡¶å’Œæº¢å‡ºæ¡¶çš„æ•°æ®ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æœå½“å‰ key ä¸å­˜åœ¨ï¼Œåˆ™é€šè¿‡åç§»é‡å­˜å‚¨åˆ°æ¡¶ä¸­&lt;/li>
&lt;li>å¦‚æœå·²ç»å­˜åœ¨ï¼Œåˆ™è¿”å› value çš„å†…å­˜åœ°å€ï¼Œèµ‹å€¼æ“ä½œæ˜¯åœ¨ç¼–è¯‘æœŸæ‰§è¡Œçš„ã€‚&lt;/li>
&lt;li>å¦‚æœæ¡¶å·²æ»¡ï¼Œåˆ™ä¼šåˆ›å»ºæ–°æ¡¶æˆ–è€…ä½¿ç”¨ç©ºé—²çš„æº¢å‡ºæ¡¶ï¼Œæ·»åŠ åˆ°å·²æœ‰æ¡¶çš„æœ«å°¾ï¼Œ&lt;code>noverflow&lt;/code> è®¡æ•°åŠ  1ã€‚&lt;/li>
&lt;/ul>
&lt;h3>æ‰©å®¹&lt;span class="hx-absolute -hx-mt-20" id="æ‰©å®¹">&lt;/span>
&lt;a href="#%e6%89%a9%e5%ae%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>éšç€ map ä¸­å†™å…¥çš„ &lt;code>key/value&lt;/code> å¢å¤šï¼Œè£…è½½å› å­ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå“ˆå¸Œå†²çªçš„æ¦‚ç‡è¶Šæ¥è¶Šå¤§ï¼Œæ€§èƒ½ä¼šè·Ÿç€ä¸‹é™ã€‚å¦‚æœå¤§é‡çš„ key éƒ½è½å…¥åˆ°åŒä¸€ä¸ªæ¡¶ä¸­ï¼Œå“ˆå¸Œè¡¨ä¼šé€€åŒ–æˆé“¾è¡¨ï¼ŒæŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦ä¼šä» &lt;code>O(1)&lt;/code> é€€åŒ–åˆ° &lt;code>O(n)&lt;/code>ã€‚&lt;/p>
&lt;p>æ‰€ä»¥å½“è£…è½½å› å­å¤§åˆ°ä¸€å®šç¨‹åº¦ä¹‹åï¼Œå“ˆå¸Œè¡¨å°±ä¸å¾—ä¸è¿›è¡Œæ‰©å®¹ã€‚&lt;/p>
&lt;h4>Go map åœ¨ä»€ä¹ˆæ—¶å€™ä¼šè§¦å‘æ‰©å®¹ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="go-map-åœ¨ä»€ä¹ˆæ—¶å€™ä¼šè§¦å‘æ‰©å®¹">&lt;/span>
&lt;a href="#go-map-%e5%9c%a8%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e4%bc%9a%e8%a7%a6%e5%8f%91%e6%89%a9%e5%ae%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">mapassign&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">key&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// src/runtime/map.go mapassign
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// If we hit the max load factor or we have too many overflow buckets,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// and we&amp;#39;re not already in the middle of growing, start growing.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">growing&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">overLoadFactor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">count&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nf">tooManyOverflowBuckets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noverflow&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">hashGrow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">goto&lt;/span> &lt;span class="nx">again&lt;/span> &lt;span class="c1">// Growing the table invalidates everything, so try again
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ol>
&lt;li>è£…è½½å› å­è¶…è¿‡é˜ˆå€¼ 6.5ã€‚&lt;/li>
&lt;li>æº¢å‡ºæ¡¶çš„æ•°é‡è¿‡å¤šï¼š
&lt;ul>
&lt;li>å½“ &lt;code>B &amp;lt; 15&lt;/code> æ—¶ï¼Œå¦‚æœæº¢å‡ºæ¡¶çš„æ•°é‡è¶…å¤š &lt;code>2^B&lt;/code> åˆ™è§¦å‘æ‰©å®¹ã€‚&lt;/li>
&lt;li>å½“ &lt;code>B &amp;gt;= 15&lt;/code> æ—¶ï¼Œå¦‚æœæº¢å‡ºæ¡¶çš„æ•°é‡è¶…è¿‡ &lt;code>2^15&lt;/code> åˆ™è§¦å‘æ‰©å®¹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h4>ä¸ºä»€ä¹ˆæº¢å‡ºæ¡¶è¿‡å¤šéœ€è¦è¿›è¡Œæ‰©å®¹ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="ä¸ºä»€ä¹ˆæº¢å‡ºæ¡¶è¿‡å¤šéœ€è¦è¿›è¡Œæ‰©å®¹">&lt;/span>
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e6%ba%a2%e5%87%ba%e6%a1%b6%e8%bf%87%e5%a4%9a%e9%9c%80%e8%a6%81%e8%bf%9b%e8%a1%8c%e6%89%a9%e5%ae%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‡ºç°è£…è½½å› å­å¾ˆå°ä¸è¶…è¿‡é˜ˆå€¼ï¼Œä½†æ˜¯æº¢å‡ºæ¡¶è¿‡å¤šçš„æƒ…å†µï¼Ÿ&lt;/p>
&lt;p>å…ˆæ’å…¥å¾ˆå¤šå…ƒç´ ï¼Œå¯¼è‡´åˆ›å»ºäº†å¾ˆå¤šæ¡¶ï¼Œä½†æ˜¯æœªè¾¾åˆ°é˜ˆå€¼ï¼Œå¹¶æ²¡æœ‰è§¦å‘æ‰©å®¹ã€‚ä¹‹åå†åˆ é™¤å…ƒç´ ï¼Œé™ä½å…ƒç´ çš„æ€»é‡ã€‚åå¤æ‰§è¡Œå‰é¢çš„æ­¥éª¤ï¼Œä½†æ˜¯åˆä¸ä¼šè§¦å‘æ‰©å®¹ï¼Œå°±ä¼šå¯¼è‡´åˆ›å»ºäº†å¾ˆå¤šæº¢å‡ºæ¡¶ï¼Œä½†æ˜¯ map ä¸­çš„ key åˆ†å¸ƒçš„å¾ˆåˆ†æ•£ã€‚å¯¼è‡´æŸ¥è¯¢å’Œæ’å…¥çš„æ•ˆç‡å¾ˆä½ã€‚&lt;/p>
&lt;h4>æ¸è¿›å¼æ‰©å®¹&lt;span class="hx-absolute -hx-mt-20" id="æ¸è¿›å¼æ‰©å®¹">&lt;/span>
&lt;a href="#%e6%b8%90%e8%bf%9b%e5%bc%8f%e6%89%a9%e5%ae%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ‰©å®¹éœ€è¦æŠŠåŸæœ‰çš„ buckets ä¸­çš„æ•°æ®è¿ç§»åˆ°æ–°çš„ buckets ä¸­ã€‚å¦‚æœä¸€ä¸ªå“ˆå¸Œè¡¨å½“å‰å¤§å°ä¸º 1GBï¼Œæ‰©å®¹ä¸ºåŸæ¥çš„ä¸¤å€å¤§å°ï¼Œé‚£å°±éœ€è¦å¯¹ 1GB çš„æ•°æ®é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¹¶ä¸”ä»åŸæ¥çš„å†…å­˜ç©ºé—´æ¬ç§»åˆ°æ–°çš„å†…å­˜ç©ºé—´ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„æ“ä½œã€‚&lt;/p>
&lt;p>æ‰€ä»¥ map çš„æ‰©å®¹é‡‡ç”¨çš„æ˜¯ä¸€ç§&lt;strong>æ¸è¿›å¼&lt;/strong>çš„æ–¹å¼ï¼Œå°†è¿ç§»çš„æ“ä½œç©¿æ’åœ¨æ’å…¥æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œåˆ†æ‰¹å®Œæˆã€‚&lt;/p>
&lt;p>å¤§æ¦‚æ€è·¯å°±æ˜¯ï¼š&lt;/p>
&lt;p>å½“æœ‰æ–°çš„ &lt;code>key/value&lt;/code> è¦æ’å…¥æ—¶ï¼Œå°†è¿™ä¸ª &lt;code>key/value&lt;/code> æ’å…¥åˆ°æ–° buckets ä¸­ï¼Œå¹¶ä¸”ä»è€çš„ buckets ä¸­æ‹¿å‡ºä¸€ä¸ª &lt;code>key/value&lt;/code> æ”¾å…¥åˆ°æ–° bucketsã€‚æ¯æ¬¡æ’å…¥ä¸€ä¸ª &lt;code>key/value&lt;/code>ï¼Œéƒ½é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ã€‚ç»è¿‡å¤šæ¬¡æ’å…¥æ“ä½œä¹‹åï¼Œè€çš„ buckets ä¸­çš„æ•°æ®å°±ä¸€ç‚¹ä¸€ç‚¹å…¨éƒ¨è¿ç§»åˆ°æ–°çš„ buckets ä¸­äº†ã€‚
è¿™æ ·ä¸ç”¨ä¸€æ¬¡æ€§å°†æ•°æ®è¿ç§»ï¼Œæ’å…¥æ“ä½œå°±éƒ½å˜å¾—å¾ˆå¿«äº†ã€‚&lt;/p>
&lt;p>å¯¹äºæŸ¥è¯¢æ“ä½œï¼Œä¸ºäº†å…¼å®¹äº†æ–°ã€è€ buckets ä¸­çš„æ•°æ®ï¼Œä¼šå…ˆä»æ–° buckets ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå†å»è€çš„ buckets ä¸­æŸ¥æ‰¾ã€‚&lt;/p>
&lt;h5>å¯¹äºæ¡ä»¶ 2 æº¢å‡ºæ¡¶çš„æ•°é‡è¿‡å¤š&lt;span class="hx-absolute -hx-mt-20" id="å¯¹äºæ¡ä»¶-2-æº¢å‡ºæ¡¶çš„æ•°é‡è¿‡å¤š">&lt;/span>
&lt;a href="#%e5%af%b9%e4%ba%8e%e6%9d%a1%e4%bb%b6-2-%e6%ba%a2%e5%87%ba%e6%a1%b6%e7%9a%84%e6%95%b0%e9%87%8f%e8%bf%87%e5%a4%9a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç”³è¯·çš„æ–°çš„ buckets æ•°é‡å’ŒåŸæœ‰çš„ buckets æ•°é‡æ˜¯&lt;strong>ç›¸ç­‰çš„&lt;/strong>ï¼Œè¿›è¡Œçš„æ˜¯&lt;strong>ç­‰é‡æ‰©å®¹&lt;/strong>ã€‚ç”±äº buckets æ•°é‡ä¸å˜ï¼Œæ‰€ä»¥åŸæœ‰çš„æ•°æ®åœ¨å‡ å·æ¡¶ï¼Œè¿ç§»ä¹‹åä»ç„¶åœ¨å‡ å·æ¡¶ã€‚æ¯”å¦‚åŸæ¥åœ¨ 0 å· bucketï¼Œåˆ°æ–°çš„åœ°æ–¹åï¼Œä»ç„¶æ”¾åœ¨ 0 å· bucketã€‚&lt;/p>
&lt;p>æ‰©å®¹å®Œæˆåï¼Œæº¢å‡ºæ¡¶æ²¡æœ‰äº†ï¼Œkey éƒ½é›†ä¸­åˆ°äº†ä¸€ä¸ª bucketï¼Œæ›´ä¸ºç´§å‡‘äº†ï¼Œæé«˜äº†æŸ¥æ‰¾çš„æ•ˆç‡ã€‚&lt;/p>
&lt;h5>å¯¹äºæ¡ä»¶ 1 å½“è£…è½½å› å­è¶…è¿‡é˜ˆå€¼å&lt;span class="hx-absolute -hx-mt-20" id="å¯¹äºæ¡ä»¶-1-å½“è£…è½½å› å­è¶…è¿‡é˜ˆå€¼å">&lt;/span>
&lt;a href="#%e5%af%b9%e4%ba%8e%e6%9d%a1%e4%bb%b6-1-%e5%bd%93%e8%a3%85%e8%bd%bd%e5%9b%a0%e5%ad%90%e8%b6%85%e8%bf%87%e9%98%88%e5%80%bc%e5%90%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>ç”³è¯·çš„æ–°çš„ buckets æ•°é‡å’ŒåŸæœ‰çš„ buckets æ•°é‡çš„ &lt;strong>2 å€&lt;/strong>ï¼Œä¹Ÿå°±æ˜¯ &lt;code>B+1&lt;/code>ã€‚æ¡¶çš„æ•°é‡æ”¹å˜äº†ï¼Œé‚£ä¹ˆ key çš„å“ˆå¸Œå€¼è¦é‡æ–°è®¡ç®—ï¼Œæ‰èƒ½å†³å®šå®ƒåˆ°åº•è½åœ¨å“ªä¸ª bucketã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼ŒåŸæ¥ &lt;code>B=5&lt;/code>ï¼Œæ ¹æ®å‡º key çš„å“ˆå¸Œå€¼çš„å 5 ä½ï¼Œå°±èƒ½å†³å®šå®ƒè½åœ¨å“ªä¸ª bucketã€‚æ‰©å®¹åçš„ buckets æ•°é‡ç¿»å€ï¼ŒB å˜æˆäº† 6ï¼Œå› æ­¤å˜æˆå“ˆå¸Œå€¼çš„å 6 ä½æ‰èƒ½å†³å®š key è½åœ¨å“ªä¸ª bucketã€‚è¿™å«åš &lt;code>rehash&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/map-evacuate-bucket-num.png" alt="map-evacuate-bucket-num" loading="lazy" />&lt;/p>
&lt;p>å› æ­¤ï¼ŒæŸä¸ª key åœ¨è¿ç§»å‰å bucket åºå·å¯èƒ½ä¼šæ”¹å˜ï¼Œå–å†³äº &lt;code>rehash&lt;/code> ä¹‹åçš„å“ˆå¸Œå€¼å€’æ•°ç¬¬ 6 ä½æ˜¯ 0 è¿˜æ˜¯ 1ã€‚&lt;/p>
&lt;p>æ‰©å®¹å®Œæˆåï¼Œè€ buckets ä¸­çš„ key åˆ†è£‚åˆ°äº† 2 ä¸ªæ–°çš„ bucketã€‚&lt;/p>
&lt;h5>è¿ç§»å®ç°&lt;span class="hx-absolute -hx-mt-20" id="è¿ç§»å®ç°">&lt;/span>
&lt;a href="#%e8%bf%81%e7%a7%bb%e5%ae%9e%e7%8e%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>Go map æ‰©å®¹çš„å®ç°åœ¨ &lt;code>hashGrow&lt;/code> å‡½æ•°ä¸­ï¼Œ&lt;code>hashGrow&lt;/code> åªç”³è¯·æ–°çš„ bucketsï¼Œä½†å¹¶æ²¡æœ‰é©¬ä¸Šå°†åŸæœ‰çš„ &lt;code>key/value&lt;/code> è¿ç§»æ–°çš„ buckets ä¸­ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">hashGrow&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bigger&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">uint8&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æº¢å‡ºæ¡¶è¿‡å¤šè§¦å‘çš„æ‰©å®¹æ˜¯ç­‰é‡æ‰©å®¹ï¼Œbigger è®¾ç½®ä¸º 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nf">overLoadFactor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">count&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bigger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">flags&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="nx">sameSizeGrow&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å°†åŸæœ‰çš„ buckets æŒ‚åˆ° oldbuckets ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">oldbuckets&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buckets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ç”³è¯·æ–°çš„ buckets
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">newbuckets&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">nextOverflow&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">makeBucketArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">bigger&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">flags&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">flags&lt;/span> &lt;span class="o">&amp;amp;^&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">iterator&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">oldIterator&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">flags&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">iterator&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">flags&lt;/span> &lt;span class="o">|=&lt;/span> &lt;span class="nx">oldIterator&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¦‚æœæ˜¯ç­‰é‡æ‰©å®¹ï¼Œbigger ä¸º 0ï¼ŒB ä¸å˜
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">bigger&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">flags&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">flags&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åŸæœ‰çš„ buckets æŒ‚åˆ° map çš„ oldbuckets ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">oldbuckets&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">oldbuckets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ–°ç”³è¯·çš„ buckets æŒ‚åˆ° buckets ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">buckets&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">newbuckets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è®¾ç½®è¿ç§»è¿›åº¦ä¸º 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nevacuate&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æº¢å‡ºæ¡¶æ•°é‡ä¸º 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noverflow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿ç§»æ˜¯åœ¨æ’å…¥æ•°æ®å’Œåˆ é™¤æ•°æ®æ—¶ï¼Œä¹Ÿå°±æ˜¯ &lt;code>mapassign&lt;/code> å’Œ &lt;code>mapdelete&lt;/code> ä¸­è¿›è¡Œçš„ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">mapassign&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">key&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">again&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bucket&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">hash&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="nf">bucketMask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">growing&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// çœŸæ­£çš„è¿ç§»åœ¨ growWork ä¸­
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">growWork&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bucket&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">mapdelete&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">key&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Pointer&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">bucket&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">hash&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="nf">bucketMask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">growing&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">growWork&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bucket&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">growing&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// oldbuckets ä¸ä¸ºç©ºï¼Œè¯´æ˜è¿˜æ²¡æœ‰è¿ç§»å®Œæˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">oldbuckets&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>growWork&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">growWork&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">maptype&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">hmap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bucket&lt;/span> &lt;span class="kt">uintptr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ç¡®è®¤è¿ç§»çš„è€çš„ bucket å¯¹åº”æ­£åœ¨ä½¿ç”¨çš„ bucket
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">evacuate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bucket&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">oldbucketmask&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// é¢å¤–å†è¿ç§»ä¸€ä¸ª bucketï¼ŒåŠ å¿«è¿ç§»è¿›åº¦
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">growing&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">evacuate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">nevacuate&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>çœŸæ­£çš„è¿ç§»åœ¨ &lt;code>evacuate&lt;/code> å‡½æ•°ä¸­ï¼Œå®ƒä¼šå¯¹ä¼ å…¥æ¡¶ä¸­çš„æ•°æ®è¿›è¡Œå†åˆ†é…ã€‚&lt;code>evacuate&lt;/code> å‡½æ•°æ¯æ¬¡åªå®Œæˆä¸€ä¸ª bucket çš„è¿ç§»å·¥ä½œï¼ˆåŒ…æ‹¬è¿™ä¸ª bucket é“¾æ¥çš„æº¢å‡ºæ¡¶ï¼‰ï¼Œå®ƒä¼šéå† bucket ï¼ˆåŒ…æ‹¬æº¢å‡ºæ¡¶ï¼‰ä¸­å¾—åˆ°æ‰€æœ‰ &lt;code>key/value&lt;/code> å¹¶è¿ç§»ã€‚
å·²è¿ç§»çš„ &lt;code>key/value&lt;/code> å¯¹åº”çš„ &lt;code>tophash&lt;/code> ä¼šè¢«è®¾ç½®ä¸º &lt;code>evacuatedEmpty&lt;/code>ï¼Œè¡¨ç¤ºå·²ç»è¿ç§»ã€‚&lt;/p>
&lt;h3>åˆ é™¤&lt;span class="hx-absolute -hx-mt-20" id="åˆ é™¤">&lt;/span>
&lt;a href="#%e5%88%a0%e9%99%a4" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åˆ é™¤ map ä¸­çš„ &lt;code>key/value&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">delete&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">hashmap&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">key&lt;/span>&lt;span class="p">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>delete&lt;/code> å…³é”®å­—çš„å”¯ä¸€ä½œç”¨å°±æ˜¯å°†æŸä¸€ä¸ª &lt;code>key/value&lt;/code> ä»å“ˆå¸Œè¡¨ä¸­åˆ é™¤ã€‚ä¼šè¢«ç¼–è¯‘å™¨è¢«è½¬æ¢æˆ &lt;code>mapdelete&lt;/code> æ–¹æ³•ã€‚åˆ é™¤æ“ä½œå…ˆæ˜¯æ‰¾åˆ° key çš„ä½ç½®ï¼Œæ¸…ç©º &lt;code>key/value&lt;/code>ï¼Œç„¶åå°† &lt;code>hmap.count - 1&lt;/code>ï¼Œå¹¶ä¸”å¯¹åº”çš„ &lt;code>tophash&lt;/code> è®¾ç½®ä¸º &lt;code>Empty&lt;/code>ã€‚&lt;/p>
&lt;h3>map ä¸ºä»€ä¹ˆæ˜¯æ— åºçš„&lt;span class="hx-absolute -hx-mt-20" id="map-ä¸ºä»€ä¹ˆæ˜¯æ— åºçš„">&lt;/span>
&lt;a href="#map-%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%e6%97%a0%e5%ba%8f%e7%9a%84" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>map åœ¨æ‰©å®¹åï¼Œ&lt;code>key/value&lt;/code> ä¼šè¿›è¡Œè¿ç§»ï¼Œåœ¨åŒä¸€ä¸ªæ¡¶ä¸­çš„ keyï¼Œæœ‰äº›ä¼šè¿ç§»åˆ°åˆ«çš„æ¡¶ä¸­ï¼Œæœ‰äº› key åŸåœ°ä¸åŠ¨ï¼Œå¯¼è‡´éå† map å°±æ— æ³•ä¿è¯é¡ºåºã€‚&lt;/p>
&lt;p>Go åº•å±‚çš„å®ç°ç®€å•ç²—æš´ï¼Œç›´æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°å†³å®šä»å“ªé‡Œå¼€å§‹éå†ï¼Œå› æ­¤&lt;strong>æ¯æ¬¡ &lt;code>for range map&lt;/code> çš„ç»“æœéƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚é‚£æ˜¯å› ä¸ºå®ƒçš„èµ·å§‹ä½ç½®æ ¹æœ¬å°±ä¸å›ºå®š&lt;/strong>ã€‚&lt;/p></description></item><item><title>å‡½æ•°</title><link>https://shipengqi.github.io/golang-learn/docs/basic/05_function/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/05_function/</guid><description>
&lt;h2>å‚æ•°ä¼ é€’&lt;span class="hx-absolute -hx-mt-20" id="å‚æ•°ä¼ é€’">&lt;/span>
&lt;a href="#%e5%8f%82%e6%95%b0%e4%bc%a0%e9%80%92" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å‡½æ•°çš„å‚æ•°ä¼ é€’æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>å€¼ä¼ é€’ï¼šå½“ä¼ ä¸€ä¸ªå‚æ•°å€¼åˆ°è¢«è°ƒç”¨çš„å‡½æ•°é‡Œé¢æ—¶ï¼Œå®é™…ä¸Šæ˜¯ä¼ äº†è¿™ä¸ªå€¼çš„å‰¯æœ¬ï¼Œè¢«è°ƒç”¨æ–¹å’Œè°ƒç”¨æ–¹ä¸¤è€…æŒæœ‰ä¸ç›¸å…³çš„ä¸¤ä»½æ•°æ®ã€‚&lt;/li>
&lt;li>å¼•ç”¨ä¼ é€’ï¼šå½“ä¼ ä¸€ä¸ªå‚æ•°å€¼åˆ°è¢«è°ƒç”¨çš„å‡½æ•°é‡Œé¢æ—¶ï¼Œå®é™…æ˜¯ä¼ äº†å‚æ•°çš„æŒ‡é’ˆï¼Œè¢«è°ƒç”¨æ–¹å’Œè°ƒç”¨æ–¹ä¸¤è€…æŒæœ‰ç›¸åŒçš„æ•°æ®ï¼Œä»»æ„ä¸€æ–¹åšå‡ºçš„ä¿®æ”¹éƒ½ä¼šå½±å“å¦ä¸€æ–¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>Go ä½¿ç”¨çš„æ˜¯&lt;strong>å€¼ä¼ é€’ï¼Œä¸ç®¡å‚æ•°æ˜¯åŸºæœ¬ç±»å‹ï¼Œç»“æ„ä½“è¿˜æ˜¯æŒ‡é’ˆï¼Œéƒ½ä¼šå¯¹ä¼ é€’çš„å‚æ•°è¿›è¡Œæ‹·è´ï¼ŒåŒºåˆ«æ— éæ˜¯æ‹·è´çš„ç›®æ ‡å¯¹è±¡è¿˜æ˜¯æ‹·è´æŒ‡é’ˆ&lt;/strong>ã€‚æ‹·è´æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯ä¼šåŒæ—¶å‡ºç°ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŸæœ‰çš„å†…å­˜ç©ºé—´ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">foo&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">i&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">printFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="nx">foo&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">foo&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">31&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">41&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">foo&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;print function - a=(%d, %p) b=(%v, %p) c=(%v, %p)\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">foo&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">30&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">foo&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">40&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">foo&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">50&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;before calling - a=(%d, %p) b=(%v, %p) c=(%v, %p)\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printFunc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;after calling - a=(%d, %p) b=(%v, %p) c=(%v, %p)\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿è¡Œåè¾“å‡ºï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>before calling - a=({30}, 0xc00000a0d8) b=(&amp;amp;{40}, 0xc00004c020) c=(&amp;amp;{50}, 0xc00004c028)
print function - a=({31}, 0xc00000a120) b=(&amp;amp;{41}, 0xc00004c038) c=(&amp;amp;{60}, 0xc00004c040)
after calling - a=({30}, 0xc00000a0d8) b=(&amp;amp;{41}, 0xc00004c020) c=(&amp;amp;{50}, 0xc00004c028)&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>&lt;code>a&lt;/code> ä¼ å…¥å‡½æ•°çš„åªæ˜¯å‰¯æœ¬ï¼Œå‡½æ•°å†…çš„ä¿®æ”¹ä¸ä¼šå½±å“åˆ°è°ƒç”¨æ–¹ã€‚&lt;/li>
&lt;li>&lt;code>b&lt;/code> ä¼ å…¥å‡½æ•°çš„æ˜¯æŒ‡é’ˆçš„å‰¯æœ¬ï¼Œä½†æ˜¯ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ç‰‡å†…å­˜ç©ºé—´ï¼Œä¿®æ”¹åä¼šå½±å“åˆ°è°ƒç”¨æ–¹ã€‚&lt;/li>
&lt;li>&lt;code>c&lt;/code> ä¼ å…¥å‡½æ•°çš„æ˜¯æŒ‡é’ˆçš„å‰¯æœ¬ï¼Œä½†æ˜¯å‡½æ•°å†…çš„ &lt;code>c = &amp;amp;foo{i: 60}&lt;/code> å°†è¿™ä¸ªæŒ‡é’ˆå‰¯æœ¬æŒ‡å‘äº†å¦ä¸€ç‰‡å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥ä¸ä¼šå†å½±å“è°ƒç”¨æ–¹ã€‚&lt;/li>
&lt;/ul>
&lt;h3>ä¼ å€¼è¿˜æ˜¯ä¼ æŒ‡é’ˆï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="ä¼ å€¼è¿˜æ˜¯ä¼ æŒ‡é’ˆ">&lt;/span>
&lt;a href="#%e4%bc%a0%e5%80%bc%e8%bf%98%e6%98%af%e4%bc%a0%e6%8c%87%e9%92%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¡¨é¢ä¸Šçœ‹ï¼ŒæŒ‡é’ˆå‚æ•°æ€§èƒ½ä¼šæ›´å¥½ï¼Œä½†æ˜¯è¦æ³¨æ„è¢«å¤åˆ¶çš„æŒ‡é’ˆä¼šå»¶é•¿ç›®æ ‡å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿˜å¯èƒ½å¯¼è‡´å®ƒè¢«åˆ†é…åˆ°å †ä¸Šï¼Œå…¶æ€§èƒ½æ¶ˆè€—è¦åŠ ä¸Šå †å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶çš„æˆæœ¬ã€‚&lt;/p>
&lt;p>&lt;strong>åœ¨æ ˆä¸Šå¤åˆ¶å°å¯¹è±¡ï¼Œè¦æ¯”å †ä¸Šåˆ†é…å†…å­˜è¦å¿«çš„å¤šã€‚å¦‚æœå¤åˆ¶æˆæœ¬é«˜ï¼Œæˆ–è€…éœ€è¦ä¿®æ”¹åŸå¯¹è±¡ï¼Œä½¿ç”¨æŒ‡é’ˆæ›´å¥½&lt;/strong>ã€‚&lt;/p></description></item><item><title>æŒ‡é’ˆ</title><link>https://shipengqi.github.io/golang-learn/docs/basic/09_pointer/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/basic/09_pointer/</guid><description>
&lt;p>&lt;strong>æŒ‡é’ˆå’Œå†…å­˜åœ°å€ä¸èƒ½æ··ä¸ºä¸€è°ˆ&lt;/strong>ã€‚å†…å­˜åœ°å€æ˜¯å†…å­˜ä¸­æ¯ä¸ªå­—èŠ‚å•å…ƒçš„å”¯ä¸€ç¼–å·ï¼Œè€ŒæŒ‡é’ˆæ˜¯ä¸€ä¸ªå®ä½“ã€‚æŒ‡é’ˆä¹Ÿä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼Œç›¸å½“äºä¸€ä¸ªä¿å­˜å†…å­˜åœ°å€çš„æ•´å½¢å˜é‡ã€‚&lt;/p>
&lt;h2>æŒ‡é’ˆçš„é™åˆ¶&lt;span class="hx-absolute -hx-mt-20" id="æŒ‡é’ˆçš„é™åˆ¶">&lt;/span>
&lt;a href="#%e6%8c%87%e9%92%88%e7%9a%84%e9%99%90%e5%88%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>æŒ‡é’ˆä¸èƒ½å‚ä¸è¿ç®—&lt;span class="hx-absolute -hx-mt-20" id="æŒ‡é’ˆä¸èƒ½å‚ä¸è¿ç®—">&lt;/span>
&lt;a href="#%e6%8c%87%e9%92%88%e4%b8%8d%e8%83%bd%e5%8f%82%e4%b8%8e%e8%bf%90%e7%ae%97" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„ä»£ç ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼š&lt;code>Invalid operation: &amp;amp;a + 1 (mismatched types *int and untyped int)&lt;/code>ã€‚&lt;/p>
&lt;p>è¯´æ˜ Go æ˜¯ä¸å…è®¸å¯¹æŒ‡é’ˆè¿›è¡Œè¿ç®—çš„ã€‚&lt;/p>
&lt;h3>ä¸åŒç±»å‹çš„æŒ‡é’ˆä¸å…è®¸ç›¸äº’è½¬æ¢&lt;span class="hx-absolute -hx-mt-20" id="ä¸åŒç±»å‹çš„æŒ‡é’ˆä¸å…è®¸ç›¸äº’è½¬æ¢">&lt;/span>
&lt;a href="#%e4%b8%8d%e5%90%8c%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%8c%87%e9%92%88%e4%b8%8d%e5%85%81%e8%ae%b8%e7%9b%b8%e4%ba%92%e8%bd%ac%e6%8d%a2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="kt">float64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">f&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„ä»£ç ç¼–è¯‘æ—¶ä¼šæŠ¥é”™ï¼š&lt;code>Cannot use '&amp;amp;a' (type *int) as the type *float64&lt;/code>ã€‚&lt;/p>
&lt;h3>ä¸åŒç±»å‹çš„æŒ‡é’ˆä¸èƒ½æ¯”è¾ƒ&lt;span class="hx-absolute -hx-mt-20" id="ä¸åŒç±»å‹çš„æŒ‡é’ˆä¸èƒ½æ¯”è¾ƒ">&lt;/span>
&lt;a href="#%e4%b8%8d%e5%90%8c%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%8c%87%e9%92%88%e4%b8%8d%e8%83%bd%e6%af%94%e8%be%83" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å› ä¸ºä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´ä¸èƒ½è½¬æ¢ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½èµ‹å€¼ã€‚&lt;/p>
&lt;h3>ä¸åŒç±»å‹çš„æŒ‡é’ˆå˜é‡ä¸èƒ½ç›¸äº’èµ‹å€¼&lt;span class="hx-absolute -hx-mt-20" id="ä¸åŒç±»å‹çš„æŒ‡é’ˆå˜é‡ä¸èƒ½ç›¸äº’èµ‹å€¼">&lt;/span>
&lt;a href="#%e4%b8%8d%e5%90%8c%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%8c%87%e9%92%88%e5%8f%98%e9%87%8f%e4%b8%8d%e8%83%bd%e7%9b%b8%e4%ba%92%e8%b5%8b%e5%80%bc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åŒæ ·çš„ç”±äºä¸åŒç±»å‹çš„æŒ‡é’ˆä¹‹é—´ä¸èƒ½è½¬æ¢ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æ³•ä½¿ç”¨ &lt;code>==&lt;/code> æˆ–è€… &lt;code>!=&lt;/code> è¿›è¡Œæ¯”è¾ƒã€‚&lt;/p>
&lt;h2>uintptr ç±»å‹&lt;span class="hx-absolute -hx-mt-20" id="uintptr-ç±»å‹">&lt;/span>
&lt;a href="#uintptr-%e7%b1%bb%e5%9e%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>uintptr&lt;/code> åªæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´å‹ï¼Œç”¨äºå­˜å‚¨å†…å­˜åœ°å€çš„æ•´å½¢å˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå’Œæ™®é€šçš„æ•´å‹ä¸€æ ·ï¼Œæ˜¯ä¼šè¢« GC å›æ”¶çš„ã€‚&lt;/p>
&lt;h2>unsafe.Pointer&lt;span class="hx-absolute -hx-mt-20" id="unsafepointer">&lt;/span>
&lt;a href="#unsafepointer" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”±äº Go æŒ‡é’ˆçš„é™åˆ¶ï¼Œæ‰€ä»¥ Go æä¾›äº†å¯ä»¥è¿›è¡Œç±»å‹è½¬æ¢çš„é€šç”¨æŒ‡é’ˆ &lt;code>unsafe.Pointer&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;code>unsafe.Pointer&lt;/code> æ˜¯ç‰¹åˆ«å®šä¹‰çš„ä¸€ç§æŒ‡é’ˆç±»å‹ï¼Œå®ƒæŒ‡å‘çš„å¯¹è±¡å¦‚æœè¿˜æœ‰ç”¨ï¼Œé‚£ä¹ˆæ˜¯ä¸ä¼šè¢« GC å›æ”¶çš„ã€‚&lt;/p>
&lt;p>&lt;code>unsafe.Pointer&lt;/code> æ˜¯å„ç§æŒ‡é’ˆç›¸äº’è½¬æ¢çš„æ¡¥æ¢ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»»ä½•ç±»å‹çš„æŒ‡é’ˆ &lt;code>*T&lt;/code> å¯ä»¥å’Œ &lt;code>unsafe.Pointer&lt;/code> ç›¸äº’è½¬æ¢ã€‚&lt;/li>
&lt;li>&lt;code>uintptr&lt;/code> å¯ä»¥å’Œ &lt;code>unsafe.Pointer&lt;/code> ç›¸äº’è½¬æ¢ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://gitee.com/shipengqi/illustrations/raw/main/go/pointer.png" alt="pointer" loading="lazy" />&lt;/p>
&lt;p>æŒ‡é’ˆç±»å‹è½¬æ¢ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;reflect&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;unsafe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">v1&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">uint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">v2&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TypeOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">v1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// uint
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TypeOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">v2&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// int
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TypeOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">v1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// *uint
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TypeOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">v2&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// *int
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">p&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">v1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä½¿ç”¨ unsafe.Pointer è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå°† *int è½¬ä¸º *uint
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">p&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="kt">uint&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pointer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">v2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">TypeOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// *unit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">p&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// 11
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div></description></item></channel></rss>