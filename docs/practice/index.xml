<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Go Learning â€“ ğŸ› ï¸ å®è·µ</title><link>https://shipengqi.github.io/golang-learn/docs/practice/</link><description>Recent content in ğŸ› ï¸ å®è·µ on Go Learning</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><atom:link href="https://shipengqi.github.io/golang-learn/docs/practice/index.xml" rel="self" type="application/rss+xml"/><item><title>Go ç¼–è¯‘</title><link>https://shipengqi.github.io/golang-learn/docs/practice/01_build/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/01_build/</guid><description>
&lt;h2>æ¡ä»¶ç¼–è¯‘&lt;span class="hx-absolute -hx-mt-20" id="æ¡ä»¶ç¼–è¯‘">&lt;/span>
&lt;a href="#%e6%9d%a1%e4%bb%b6%e7%bc%96%e8%af%91" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go æ”¯æŒä¸¤ç§æ¡ä»¶ç¼–è¯‘æ–¹å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¼–è¯‘æ ‡ç­¾ï¼ˆbuild tagï¼‰&lt;/li>
&lt;li>æ–‡ä»¶åç¼€&lt;/li>
&lt;/ul>
&lt;h3>ç¼–è¯‘æ ‡ç­¾&lt;span class="hx-absolute -hx-mt-20" id="ç¼–è¯‘æ ‡ç­¾">&lt;/span>
&lt;a href="#%e7%bc%96%e8%af%91%e6%a0%87%e7%ad%be" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç¼–è¯‘æ ‡ç­¾æ˜¯ä»¥ &lt;code>// +build&lt;/code> å¼€å¤´çš„æ³¨é‡Šï¼Œç¼–è¯‘æ ‡ç­¾çš„è§„åˆ™ï¼š&lt;/p>
&lt;ol>
&lt;li>ç©ºæ ¼è¡¨ç¤ºï¼šOR&lt;/li>
&lt;li>é€—å·è¡¨ç¤ºï¼šAND&lt;/li>
&lt;li>&lt;code>!&lt;/code> è¡¨ç¤ºï¼šNOT&lt;/li>
&lt;li>æ¢è¡Œè¡¨ç¤ºï¼šAND&lt;/li>
&lt;/ol>
&lt;p>æ¯ä¸ªæ¡ä»¶é¡¹çš„åå­—ç”¨ &amp;ldquo;å­—æ¯+æ•°å­—&amp;rdquo; è¡¨ç¤ºã€‚ä¸»è¦æ”¯æŒä»¥ä¸‹å‡ ç§æ¡ä»¶ï¼š&lt;/p>
&lt;ul>
&lt;li>æ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚ï¼š&lt;code>windows&lt;/code>ã€&lt;code>linux&lt;/code> ç­‰ï¼Œå¯¹åº” &lt;code>runtime.GOOS&lt;/code> çš„å€¼ã€‚&lt;/li>
&lt;li>è®¡ç®—æœºæ¶æ„ï¼Œä¾‹å¦‚ï¼š&lt;code>amd64&lt;/code>ã€&lt;code>386&lt;/code>ï¼Œå¯¹åº” &lt;code>runtime.GOARCH&lt;/code> çš„å€¼ã€‚&lt;/li>
&lt;li>ç¼–è¯‘å™¨ï¼Œä¾‹å¦‚ï¼š&lt;code>gccgo&lt;/code>ã€&lt;code>gc&lt;/code>ï¼Œæ˜¯å¦å¼€å¯ CGO,cgoã€‚&lt;/li>
&lt;li>Go ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š&lt;code>go1.19&lt;/code> è¡¨ç¤ºä» ä» Go ç‰ˆæœ¬ 1.19 èµ·ï¼Œ&lt;code>go1.20&lt;/code> è¡¨ç¤ºä» ä» Go ç‰ˆæœ¬ 1.20 èµ·ã€‚&lt;/li>
&lt;li>è‡ªå®šä¹‰çš„æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼šç¼–è¯‘æ—¶é€šè¿‡æŒ‡å®š &lt;code>-tags&lt;/code> ä¼ å…¥çš„å€¼ã€‚&lt;/li>
&lt;li>&lt;code>// +build ignore&lt;/code>ï¼Œè¡¨ç¤ºç¼–è¯‘æ—¶è‡ªåŠ¨å¿½ç•¥è¯¥æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>ç¼–è¯‘æ ‡ç­¾ä¹‹åå¿…é¡»æœ‰ç©ºè¡Œï¼Œå¦åˆ™ä¼šè¢«ç¼–è¯‘å™¨å½“åšæ™®é€šæ³¨é‡Šã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// +build linux,386 darwin,!cgo
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">testpkg&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿ç®—è¡¨è¾¾å¼ä¸ºï¼š&lt;code>(linux &amp;amp;&amp;amp; 386) || (darwin &amp;amp;&amp;amp; !cgo)&lt;/code>ã€‚&lt;/p>
&lt;p>è‡ªå®šä¹‰ tag åªéœ€è¦åœ¨ &lt;code>go build&lt;/code> æŒ‡ä»¤åç”¨ &lt;code>-tags&lt;/code> æŒ‡å®šç¼–è¯‘æ¡ä»¶å³å¯&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go build -tags mytag1 mytag2&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯¹äº &lt;code>-tags&lt;/code>ï¼Œå¤šä¸ªæ ‡ç­¾æ—¢å¯ä»¥ç”¨é€—å·åˆ†éš”ï¼Œä¹Ÿå¯ä»¥ç”¨ç©ºæ ¼åˆ†éš”ï¼Œä½†å®ƒä»¬éƒ½è¡¨ç¤º&amp;quot;ä¸&amp;quot;çš„å…³ç³»ã€‚æ—©æœŸ go ç‰ˆæœ¬ç”¨ç©ºæ ¼åˆ†éš”ï¼Œåæ¥æ”¹æˆäº†ç”¨é€—å·åˆ†éš”ï¼Œä½†ç©ºæ ¼ä¾ç„¶å¯ä»¥è¯†åˆ«ã€‚&lt;/p>
&lt;p>&lt;code>-tags&lt;/code> ä¹Ÿæœ‰ &lt;code>!&lt;/code> è§„åˆ™ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ²¡æœ‰è¿™ä¸ªæ ‡ç­¾ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// +build !hello
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go build -tags&lt;span class="o">=&lt;/span>!hello&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>æ–‡ä»¶åç¼€&lt;span class="hx-absolute -hx-mt-20" id="æ–‡ä»¶åç¼€">&lt;/span>
&lt;a href="#%e6%96%87%e4%bb%b6%e5%90%8e%e7%bc%80" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€šè¿‡æ”¹å˜æ–‡ä»¶åçš„åç¼€æ¥å®ç°æ¡ä»¶ç¼–è¯‘ï¼Œå¦‚æœæºæ–‡ä»¶ååŒ…å«åç¼€ï¼š&lt;code>_&amp;lt;GOOS&amp;gt;.go&lt;/code>ï¼Œé‚£ä¹ˆè¿™ä¸ªæºæ–‡ä»¶åªä¼šåœ¨è¿™ä¸ªå¹³å°ä¸‹ç¼–è¯‘ï¼Œ&lt;code>_&amp;lt;GOARCH&amp;gt;.go&lt;/code> ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™ä¸¤ä¸ªåç¼€å¯ä»¥ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯è¦æ³¨æ„é¡ºåºï¼š&lt;code>_&amp;lt;GOOS&amp;gt;_&amp;lt;GOARCH&amp;gt;.go&lt;/code>ï¼Œ ä¸èƒ½åè¿‡æ¥ç”¨ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mypkg_freebsd_arm.go // only builds on freebsd/arm systems
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mypkg_plan9.go // only builds on plan9&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¦‚æœä½¿ç”¨æ–‡ä»¶åç¼€ï¼Œé‚£ä¹ˆæ–‡ä»¶åå°±æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># è¿™ä¸ªæ–‡ä»¶ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥
_linux.go&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>é€‰æ‹©ç¼–è¯‘æ ‡ç­¾è¿˜æ˜¯æ–‡ä»¶åç¼€ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="é€‰æ‹©ç¼–è¯‘æ ‡ç­¾è¿˜æ˜¯æ–‡ä»¶åç¼€">&lt;/span>
&lt;a href="#%e9%80%89%e6%8b%a9%e7%bc%96%e8%af%91%e6%a0%87%e7%ad%be%e8%bf%98%e6%98%af%e6%96%87%e4%bb%b6%e5%90%8e%e7%bc%80" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç¼–è¯‘æ ‡ç­¾å’Œæ–‡ä»¶åç¼€çš„åŠŸèƒ½ä¸Šæœ‰é‡å ï¼Œä¾‹å¦‚ä¸€ä¸ªæ–‡ä»¶ &lt;code>mypkg_linux.go&lt;/code> ä»£ç ä¸­åˆåŒ…å«äº† &lt;code>//go:build linux&lt;/code>ï¼Œæ—¢æœ‰ç¼–è¯‘æ ‡ç­¾åˆæœ‰æ–‡ä»¶åç¼€ï¼Œé‚£å°±æœ‰äº›å¤šä½™äº†ã€‚&lt;/p>
&lt;p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæºæ–‡ä»¶ä»…é€‚é…ä¸€ä¸ªå¹³å°æˆ–è€… CPU æ¶æ„ï¼Œé‚£ä¹ˆåªä½¿ç”¨æ–‡ä»¶åç¼€å°±å¯ä»¥æ»¡è¶³ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mypkg_linux.go // only builds on linux systems
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mypkg_windows_amd64.go // only builds on windows 64bit platforms&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åƒä¸‹é¢ç¨å¾®å¤æ‚çš„åœºæ™¯ï¼Œå°±éœ€è¦ä½¿ç”¨ç¼–è¯‘æ ‡ç­¾ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿™ä¸ªæºæ–‡ä»¶å¯ä»¥åœ¨è¶…è¿‡ä¸€ä¸ªå¹³å°æˆ–è€…è¶…è¿‡ä¸€ä¸ª CPU æ¶æ„&lt;/li>
&lt;li>éœ€è¦æ’é™¤æŸä¸ªå¹³å°æˆ–æ¶æ„&lt;/li>
&lt;li>æœ‰ä¸€äº›è‡ªå®šä¹‰çš„ç¼–è¯‘æ¡ä»¶&lt;/li>
&lt;/ul>
&lt;h3>go:build&lt;span class="hx-absolute -hx-mt-20" id="gobuild">&lt;/span>
&lt;a href="#gobuild" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>//go:build&lt;/code> åŠŸèƒ½å’Œ &lt;code>// +build&lt;/code> ä¸€æ ·ã€‚åªä¸è¿‡ &lt;code>//go:build&lt;/code> æ˜¯åœ¨ go 1.17 æ‰å¼•å…¥çš„ã€‚ç›®çš„æ˜¯ä¸ºäº†ä¸å…¶ä»–ç°æœ‰çš„ Go æŒ‡ä»¤ä¿æŒä¸€è‡´ï¼Œä¾‹å¦‚ &lt;code>//go:generate&lt;/code>ã€‚&lt;/p>
&lt;p>è§„åˆ™ï¼š ç”± &lt;code>||&lt;/code>ã€&lt;code>&amp;amp;&amp;amp;&lt;/code>ã€&lt;code>!&lt;/code> è¿ç®—ç¬¦ï¼ˆæˆ–ã€ä¸ã€éï¼‰å’Œæ‹¬å·ç»„æˆçš„è¡¨è¾¾å¼ï¼Œ&lt;code>//go:build ignore&lt;/code>ï¼Œè¡¨ç¤ºç¼–è¯‘æ—¶è‡ªåŠ¨å¿½ç•¥è¯¥æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ &lt;code>//go:build (linux &amp;amp;&amp;amp; 386) || (darwin &amp;amp;&amp;amp; !cgo)&lt;/code>ï¼Œè¡¨ç¤ºç›®æ ‡ç³»ç»Ÿæ˜¯ 386 çš„ linux æˆ–è€…æ²¡æœ‰å¯ç”¨ cgo çš„ darwin æ—¶ï¼Œå½“å‰æ–‡ä»¶ä¼šè¢«ç¼–è¯‘è¿›æ¥ã€‚&lt;/p>
&lt;h2>äº¤å‰ç¼–è¯‘&lt;span class="hx-absolute -hx-mt-20" id="äº¤å‰ç¼–è¯‘">&lt;/span>
&lt;a href="#%e4%ba%a4%e5%8f%89%e7%bc%96%e8%af%91" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go å¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡æ¥å®ç°äº¤å‰ç¼–è¯‘ï¼Œç”¨æ¥åœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°çš„å¯æ‰§è¡Œç¨‹åºï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># linux amd64
GOOS=linux GOARCH=amd64 go build main.go
# windows amd64
GOOS=windows GOARCH=amd64 go build main.go&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç¯å¢ƒå˜é‡ &lt;code>GOOS&lt;/code> è®¾ç½®å¹³å°, &lt;code>GOARCH&lt;/code> è®¾ç½®æ¶æ„ã€‚&lt;/p>
&lt;h2>ç¼–è¯‘é€‰é¡¹&lt;span class="hx-absolute -hx-mt-20" id="ç¼–è¯‘é€‰é¡¹">&lt;/span>
&lt;a href="#%e7%bc%96%e8%af%91%e9%80%89%e9%a1%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">go build &lt;span class="o">[&lt;/span>-o output&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>-i&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>build flags&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>packages&lt;span class="o">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>&lt;code>-a&lt;/code> å¼ºåˆ¶é‡æ–°ç¼–è¯‘æ‰€æœ‰åŒ…&lt;/li>
&lt;li>&lt;code>-n&lt;/code> æŠŠéœ€è¦æ‰§è¡Œçš„ç¼–è¯‘å‘½ä»¤æ‰“å°å‡ºæ¥ï¼Œä½†æ˜¯ä¸æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå®¹æ˜“çš„çŸ¥é“åº•å±‚æ˜¯å¦‚ä½•è¿è¡Œçš„&lt;/li>
&lt;li>&lt;code>-p n&lt;/code> æŒ‡å®šå¯ä»¥å¹¶è¡Œå¯è¿è¡Œçš„ç¼–è¯‘æ•°ç›®ï¼Œé»˜è®¤æ˜¯ CPU çš„æ•°ç›®&lt;/li>
&lt;li>&lt;code>-o&lt;/code> æŒ‡å®šè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶åï¼Œå¯ä»¥å¸¦è·¯å¾„ï¼Œä¾‹å¦‚ &lt;code>go build -o a/b/c&lt;/code>&lt;/li>
&lt;li>&lt;code>-i&lt;/code> å®‰è£…ç›¸åº”çš„åŒ…ï¼Œç¼–è¯‘å¹¶ä¸” &lt;code>go install&lt;/code>&lt;/li>
&lt;li>&lt;code>-race&lt;/code> å¼€å¯ç¼–è¯‘çš„æ—¶å€™è‡ªåŠ¨æ£€æµ‹æ•°æ®ç«äº‰çš„æƒ…å†µï¼Œç›®å‰åªæ”¯æŒ 64 ä½çš„æœºå™¨&lt;/li>
&lt;li>&lt;code>-v&lt;/code> æ‰“å°å‡ºæ¥æˆ‘ä»¬æ­£åœ¨ç¼–è¯‘çš„åŒ…å&lt;/li>
&lt;li>&lt;code>-work&lt;/code> æ‰“å°å‡ºæ¥ç¼–è¯‘æ—¶å€™çš„ä¸´æ—¶æ–‡ä»¶å¤¹åç§°ï¼Œå¹¶ä¸”å¦‚æœå·²ç»å­˜åœ¨çš„è¯å°±ä¸è¦åˆ é™¤&lt;/li>
&lt;li>&lt;code>-x&lt;/code> æ‰“å°å‡ºæ¥æ‰§è¡Œçš„å‘½ä»¤ï¼Œå…¶å®å°±æ˜¯å’Œ-nçš„ç»“æœç±»ä¼¼ï¼Œåªæ˜¯è¿™ä¸ªä¼šæ‰§è¡Œ&lt;/li>
&lt;li>&lt;code>-ccflags 'arg list'&lt;/code> ä¼ é€’å‚æ•°ç»™ 5c, 6c, 8c è°ƒç”¨&lt;/li>
&lt;li>&lt;code>-compiler name&lt;/code> æŒ‡å®šç›¸åº”çš„ç¼–è¯‘å™¨ï¼Œgccgo è¿˜æ˜¯ gc&lt;/li>
&lt;li>&lt;code>-gccgoflags 'arg list'&lt;/code> ä¼ é€’å‚æ•°ç»™ gccgo ç¼–è¯‘è¿æ¥è°ƒç”¨&lt;/li>
&lt;li>&lt;code>-gcflags 'arg list'&lt;/code> ç¼–è¯‘å™¨å‚æ•°&lt;/li>
&lt;li>&lt;code>-installsuffix suffix&lt;/code> ä¸ºäº†å’Œé»˜è®¤çš„å®‰è£…åŒ…åŒºåˆ«å¼€æ¥ï¼Œé‡‡ç”¨è¿™ä¸ªå‰ç¼€æ¥é‡æ–°å®‰è£…é‚£äº›ä¾èµ–çš„åŒ…ï¼Œ&lt;code>-race&lt;/code>çš„æ—¶å€™é»˜è®¤å·²ç»æ˜¯ &lt;code>-installsuffix race&lt;/code>,å¤§å®¶å¯ä»¥é€šè¿‡ &lt;code>-n&lt;/code> å‘½ä»¤æ¥éªŒè¯&lt;/li>
&lt;li>&lt;code>-ldflags 'arg list'&lt;/code> é“¾æ¥å™¨å‚æ•°&lt;/li>
&lt;li>&lt;code>-tags 'tag list'&lt;/code> è®¾ç½®åœ¨ç¼–è¯‘çš„æ—¶å€™å¯ä»¥é€‚é…çš„é‚£äº›tagï¼Œè¯¦ç»†çš„tagé™åˆ¶å‚è€ƒé‡Œé¢çš„ Build Constraints&lt;/li>
&lt;/ul>
&lt;h3>gcflags&lt;span class="hx-absolute -hx-mt-20" id="gcflags">&lt;/span>
&lt;a href="#gcflags" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>-gcflags&lt;/code> å‚æ•°çš„æ ¼å¼æ˜¯&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">-gcflags&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;pattern=arg list&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h4>pattern&lt;span class="hx-absolute -hx-mt-20" id="pattern">&lt;/span>
&lt;a href="#pattern" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>pattern æ˜¯é€‰æ‹©åŒ…çš„æ¨¡å¼ï¼Œå®ƒå¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å®šä¹‰:&lt;/p>
&lt;ul>
&lt;li>&lt;code>main&lt;/code>: è¡¨ç¤º &lt;code>main&lt;/code> å‡½æ•°æ‰€åœ¨çš„é¡¶çº§åŒ…è·¯å¾„&lt;/li>
&lt;li>&lt;code>all&lt;/code>: è¡¨ç¤º &lt;code>GOPATH&lt;/code> ä¸­çš„æ‰€æœ‰åŒ…ã€‚å¦‚æœæ˜¯ &lt;code>go modules&lt;/code> æ¨¡å¼ï¼Œåˆ™è¡¨ç¤ºä¸»æ¨¡å—å’Œå®ƒæ‰€æœ‰çš„ä¾èµ–ï¼ŒåŒ…æ‹¬ &lt;code>test&lt;/code> æ–‡ä»¶çš„ä¾èµ–&lt;/li>
&lt;li>&lt;code>std&lt;/code>: è¡¨ç¤º Go æ ‡å‡†åº“ä¸­çš„æ‰€æœ‰åŒ…&lt;/li>
&lt;li>&lt;code>...&lt;/code>: &lt;code>...&lt;/code> æ˜¯ä¸€ä¸ªé€šé…ç¬¦ï¼Œå¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ä¸²(åŒ…æ‹¬ç©ºå­—ç¬¦ä¸²)ã€‚
&lt;ul>
&lt;li>&lt;code>net/...&lt;/code> è¡¨ç¤º net æ¨¡å—å’Œå®ƒçš„æ‰€æœ‰å­æ¨¡å—&lt;/li>
&lt;li>&lt;code>./...&lt;/code> è¡¨ç¤ºå½“å‰ä¸»æ¨¡å—å’Œæ‰€æœ‰å­æ¨¡å—&lt;/li>
&lt;li>å¦‚æœ pattern ä¸­åŒ…å«äº† &lt;code>/&lt;/code> å’Œ &lt;code>...&lt;/code>ï¼Œé‚£ä¹ˆå°±ä¸ä¼šåŒ¹é… &lt;code>vendor&lt;/code> ç›®å½•
ä¾‹å¦‚: &lt;code>./...&lt;/code> ä¸ä¼šåŒ¹é… &lt;code>./vendor&lt;/code> ç›®å½•ã€‚å¯ä»¥ä½¿ç”¨ &lt;code>./vendor/...&lt;/code> åŒ¹é… &lt;code>vendor&lt;/code> ç›®å½•å’Œå®ƒçš„å­æ¨¡å—&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;code>go help packages&lt;/code> æŸ¥çœ‹æ¨¡å¼è¯´æ˜ã€‚&lt;/p>
&lt;h4>arg list&lt;span class="hx-absolute -hx-mt-20" id="arg-list">&lt;/span>
&lt;a href="#arg-list" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ç©ºæ ¼åˆ†éš”ï¼Œå¦‚æœç¼–è¯‘é€‰é¡¹ä¸­å«æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨å¼•å·åŒ…èµ·æ¥ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>-N&lt;/code>: ç¦æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–&lt;/li>
&lt;li>&lt;code>-l&lt;/code>: å…³é—­å†…è” (&lt;code>inline&lt;/code>)&lt;/li>
&lt;li>&lt;code>-c&lt;/code>: &lt;code>int&lt;/code> ç¼–è¯‘è¿‡ç¨‹ä¸­çš„å¹¶å‘æ•°ï¼Œé»˜è®¤æ˜¯ &lt;code>1&lt;/code>&lt;/li>
&lt;li>&lt;code>-B&lt;/code> ç¦ç”¨è¶Šç•Œæ£€æŸ¥&lt;/li>
&lt;li>&lt;code>-u&lt;/code> ç¦ç”¨ unsafe&lt;/li>
&lt;li>&lt;code>-S&lt;/code> è¾“å‡ºæ±‡ç¼–ä»£ç &lt;/li>
&lt;li>&lt;code>-m&lt;/code> è¾“å‡ºä¼˜åŒ–ä¿¡æ¯&lt;/li>
&lt;/ul>
&lt;h3>ldflags&lt;span class="hx-absolute -hx-mt-20" id="ldflags">&lt;/span>
&lt;a href="#ldflags" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>&lt;code>-s&lt;/code> ç¦ç”¨ç¬¦å·è¡¨&lt;/li>
&lt;li>&lt;code>-w&lt;/code> ç¦ç”¨ DRAWF è°ƒè¯•ä¿¡æ¯&lt;/li>
&lt;li>&lt;code>-X&lt;/code> è®¾ç½®å­—ç¬¦ä¸²å…¨å±€å˜é‡å€¼ &lt;code>-X ver=&amp;quot;0.99&amp;quot;&lt;/code>&lt;/li>
&lt;li>&lt;code>-H&lt;/code> è®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ &lt;code>-H windowsgui&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2>å†…è”ä¼˜åŒ–ï¼ˆinlineï¼‰&lt;span class="hx-absolute -hx-mt-20" id="å†…è”ä¼˜åŒ–inline">&lt;/span>
&lt;a href="#%e5%86%85%e8%81%94%e4%bc%98%e5%8c%96inline" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>å†…è”ä¼˜åŒ–å°±æ˜¯åœ¨ç¼–è¯‘æœŸé—´ï¼Œç›´æ¥å°†è°ƒç”¨å‡½æ•°çš„åœ°æ–¹æ›¿æ¢ä¸ºå‡½æ•°çš„å®ç°ï¼Œå®ƒå¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼ˆåˆ›å»ºæ ˆå¸§ï¼Œè¯»å†™å¯„å­˜å™¨ï¼Œæ ˆæº¢å‡ºæ£€æµ‹ç­‰ï¼‰ä»¥æé«˜ç¨‹åºçš„æ€§èƒ½ã€‚å› ä¸ºä¼˜åŒ–çš„å¯¹è±¡ä¸ºå‡½æ•°ï¼Œæ‰€ä»¥ä¹Ÿå«&lt;strong>å‡½æ•°å†…è”&lt;/strong>ã€‚&lt;/p>
&lt;p>å†…è”æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œä¸€æ—¦ä¸€ä¸ªå‡½æ•°è¢«å†…è”åˆ°å®ƒçš„è°ƒç”¨è€…ä¸­ï¼Œç¼–è¯‘å™¨å°±å¯èƒ½å°†äº§ç”Ÿçš„ä»£ç å†…è”åˆ°å®ƒçš„è°ƒç”¨è€…ä¸­ï¼Œä¾æ­¤ç±»æ¨ã€‚&lt;/p>
&lt;p>å†…è”ä¼˜åŒ–ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">f&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;inline&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">a&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">f&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">b&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">f&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å†…è”ä¼˜åŒ–åï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">a&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;inline&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">b&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;inline&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>å†…è”ä¼˜åŒ–çš„æ•ˆæœ&lt;span class="hx-absolute -hx-mt-20" id="å†…è”ä¼˜åŒ–çš„æ•ˆæœ">&lt;/span>
&lt;a href="#%e5%86%85%e8%81%94%e4%bc%98%e5%8c%96%e7%9a%84%e6%95%88%e6%9e%9c" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">inlinetest&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//go:noinline
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>max_test.go&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">inlinetest&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;testing&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">Result&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">BenchmarkMax&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">r&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">r&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">r&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç°åœ¨æ˜¯åœ¨ç¦ç”¨å†…è”ä¼˜åŒ–çš„æƒ…å†µä¸‹è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go test -bench=.
cpu: Intel(R) Core(TM) i7-10850H CPU @ 2.70GHz
BenchmarkMax-12 871122506 1.353 ns/op&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å»æ‰ &lt;code>//go:noinline&lt;/code> åï¼ˆå¯ä»¥ä½¿ç”¨ &lt;code>go build -gcflags=&amp;quot;-m -m&amp;quot; main.go&lt;/code> æ¥æŸ¥çœ‹ç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼‰å†æ¬¡è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go test -bench=.
cpu: Intel(R) Core(TM) i7-10850H CPU @ 2.70GHz
BenchmarkMax-12 1000000000 0.3534 ns/op&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯¹æ¯”ä¸¤æ¬¡åŸºå‡†æµ‹è¯•çš„ç»“æœï¼Œ&lt;code>1.353ns&lt;/code> å’Œ &lt;code>0.3534ns&lt;/code>ã€‚æ‰“å¼€å†…è”ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½æé«˜äº† 75%ã€‚&lt;/p>
&lt;h3>ç¦ç”¨å†…è”&lt;span class="hx-absolute -hx-mt-20" id="ç¦ç”¨å†…è”">&lt;/span>
&lt;a href="#%e7%a6%81%e7%94%a8%e5%86%85%e8%81%94" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Go ç¼–è¯‘å™¨é»˜è®¤å¼€å¯å†…è”ä¼˜åŒ–ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>-gcflags=&amp;quot;-l&amp;quot;&lt;/code> æ¥å…³é—­ã€‚ä½†æ˜¯å¦‚æœä¼ é€’ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„ &lt;code>-l&lt;/code> åˆ™ä¼šæ‰“å¼€å†…è”ï¼Œå¹¶å¯ç”¨æ›´æ¿€è¿›çš„å†…è”ç­–ç•¥ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>-gcflags=&amp;quot;-l -l&amp;quot;&lt;/code> 2 çº§å†…è”&lt;/li>
&lt;li>&lt;code>-gcflags=&amp;quot;-l -l -l&amp;quot;&lt;/code> 3 çº§å†…è”&lt;/li>
&lt;li>&lt;code>gcflags=-l=4&lt;/code> 4 çº§åˆ«å†…è”&lt;/li>
&lt;/ul>
&lt;p>&lt;code>//go:noinline&lt;/code> ç¼–è¯‘æŒ‡ä»¤ï¼Œå¯ä»¥ç¦ç”¨å•ä¸ªå‡½æ•°çš„å†…è”ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//go:noinline
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">y&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">x&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">y&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">x&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>å‡å°ç¼–è¯‘ä½“ç§¯&lt;span class="hx-absolute -hx-mt-20" id="å‡å°ç¼–è¯‘ä½“ç§¯">&lt;/span>
&lt;a href="#%e5%87%8f%e5%b0%8f%e7%bc%96%e8%af%91%e4%bd%93%e7%a7%af" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go ç¼–è¯‘å™¨é»˜è®¤ç¼–è¯‘å‡ºæ¥çš„ç¨‹åºä¼šå¸¦æœ‰ç¬¦å·è¡¨å’Œè°ƒè¯•ä¿¡æ¯ï¼Œä¸€èˆ¬æ¥è¯´ release ç‰ˆæœ¬å¯ä»¥å»é™¤è°ƒè¯•ä¿¡æ¯ä»¥å‡å°äºŒè¿›åˆ¶ä½“ç§¯ã€‚&lt;/p>
&lt;p>ä½¿ç”¨ &lt;code>-w&lt;/code> å’Œ &lt;code>-s&lt;/code> æ¥å‡å°‘å¯æ‰§è¡Œæ–‡ä»¶çš„ä½“ç§¯ã€‚ä½†åˆ é™¤äº†è°ƒè¯•ä¿¡æ¯åï¼Œå¯æ‰§è¡Œæ–‡ä»¶å°†æ— æ³•ä½¿ç”¨ gdb/dlv è°ƒè¯•ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go build -ldflags&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-w -s&amp;#34;&lt;/span> ./abc.go&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ä½¿ç”¨ upx&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨-upx">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8-upx" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;a href="https://github.com/upx/upx" target="_blank" rel="noopener">upx&lt;/a> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„å‹ç¼©åŠ¨æ€åº“å’Œå¯æ‰§è¡Œæ–‡ä»¶çš„å·¥å…·ï¼Œé€šå¸¸å¯å‡å°‘ 50-70% çš„ä½“ç§¯ã€‚&lt;/p>
&lt;p>ä¸‹è½½ &lt;a href="https://github.com/upx/upx/releases" target="_blank" rel="noopener">upx&lt;/a> åè§£å‹å°±å¯ä»¥ä½¿ç”¨äº†ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># ä½¿ç”¨ upx
$ go build -o server main.go &amp;amp;&amp;amp; upx -9 server
# ç»“åˆç¼–è¯‘é€‰é¡¹
go build -ldflags=&amp;#34;-s -w&amp;#34; -o server main.go &amp;amp;&amp;amp; upx -9 server&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>upx çš„å‚æ•° &lt;code>-9&lt;/code> æŒ‡çš„æ˜¯å‹ç¼©ç‡ï¼Œ1 ä»£è¡¨æœ€ä½å‹ç¼©ç‡ï¼Œ9 ä»£è¡¨æœ€é«˜å‹ç¼©ç‡ã€‚&lt;/p>
&lt;p>upx å‹ç¼©åçš„ç¨‹åºå’Œå‹ç¼©å‰çš„ç¨‹åºä¸€æ ·ï¼Œæ— éœ€è§£å‹ä»ç„¶èƒ½å¤Ÿæ­£å¸¸åœ°è¿è¡Œï¼Œè¿™ç§å‹ç¼©æ–¹æ³•ç§°ä¹‹ä¸º&lt;strong>å¸¦å£³å‹ç¼©&lt;/strong>ã€‚&lt;/p>
&lt;p>å‹ç¼©åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ¨ç¨‹åºå¼€å¤´æˆ–å…¶ä»–åˆé€‚çš„åœ°æ–¹æ’å…¥è§£å‹ä»£ç &lt;/li>
&lt;li>å°†ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†å‹ç¼©&lt;/li>
&lt;/ul>
&lt;p>æ‰§è¡Œæ—¶ï¼Œä¹ŸåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆæ‰§è¡Œçš„æ˜¯ç¨‹åºå¼€å¤´çš„æ’å…¥çš„è§£å‹ä»£ç ï¼Œå°†åŸæ¥çš„ç¨‹åºåœ¨å†…å­˜ä¸­è§£å‹å‡ºæ¥&lt;/li>
&lt;li>å†æ‰§è¡Œè§£å‹åçš„ç¨‹åºã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¹Ÿå°±æ˜¯è¯´ï¼Œupx åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œä¼šæœ‰é¢å¤–çš„è§£å‹åŠ¨ä½œï¼Œä¸è¿‡è¿™ä¸ªè€—æ—¶å‡ ä¹å¯ä»¥å¿½ç•¥ã€‚&lt;/p></description></item><item><title>Go æ•°æ®ç«äº‰æ£€æµ‹å™¨</title><link>https://shipengqi.github.io/golang-learn/docs/practice/02_go_race/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/02_go_race/</guid><description>
&lt;p>æ•°æ®ç«äº‰æ˜¯å¹¶å‘ç³»ç»Ÿä¸­æœ€å¸¸è§ï¼ŒåŒæ—¶ä¹Ÿæœ€éš¾å¤„ç†çš„ Bug ç±»å‹ä¹‹ä¸€ã€‚æ•°æ®ç«äº‰ä¼šåœ¨ä¸¤ä¸ª goroutine å¹¶å‘è®¿é—®åŒä¸€ä¸ªå˜é‡ï¼Œä¸”è‡³å°‘æœ‰ä¸€ä¸ªè®¿é—®ä¸ºå†™å…¥æ—¶äº§ç”Ÿã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¼šå¯¼è‡´ç¨‹åºå´©æºƒçš„ä¾‹å­ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">bool&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;a&amp;#34;&lt;/span> &lt;span class="c1">// ç¬¬ä¸€ä¸ªå†²çªçš„è®¿é—®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s">&amp;#34;2&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;b&amp;#34;&lt;/span> &lt;span class="c1">// ç¬¬äºŒä¸ªå†²çªçš„è®¿é—®
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">k&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">k&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿è¡Œ &lt;code>go run -race ./main.go&lt;/code> ç¨‹åºä¼šé©¬ä¸Šå´©æºƒï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>==================
WARNING: DATA RACE
Write at 0x00c00010a090 by goroutine 7:
runtime.mapassign_faststr()
/usr/local/go/src/runtime/map_faststr.go:203 &amp;#43;0x0
main.main.func1()
/root/workspace/main.go:9 &amp;#43;0x4a
Previous write at 0x00c00010a090 by main goroutine:
runtime.mapassign_faststr()
/usr/local/go/src/runtime/map_faststr.go:203 &amp;#43;0x0
main.main()
/root/workspace/main.go:12 &amp;#43;0x108
Goroutine 7 (running) created at:
main.main()
/root/workspace/main.go:8 &amp;#43;0xeb
==================
2 b
1 a
Found 1 data race(s)&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>æ•°æ®ç«äº‰æ£€æµ‹å™¨&lt;span class="hx-absolute -hx-mt-20" id="æ•°æ®ç«äº‰æ£€æµ‹å™¨">&lt;/span>
&lt;a href="#%e6%95%b0%e6%8d%ae%e7%ab%9e%e4%ba%89%e6%a3%80%e6%b5%8b%e5%99%a8" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go å†…ç½®äº†æ•°æ®ç«äº‰æ£€æµ‹å™¨ã€‚ä½¿ç”¨æ—¶å°† &lt;code>-race&lt;/code> æ ‡è®°æ·»åŠ åˆ° go å‘½ä»¤ä¹‹åï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">go &lt;span class="nb">test&lt;/span> -race mypkg // æµ‹è¯•è¯¥åŒ…
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go run -race mysrc.go // è¿è¡Œå…¶æºæ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go build -race mycmd // æ„å»ºè¯¥å‘½ä»¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go install -race mypkg // å®‰è£…è¯¥åŒ…&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>é€‰é¡¹&lt;span class="hx-absolute -hx-mt-20" id="é€‰é¡¹">&lt;/span>
&lt;a href="#%e9%80%89%e9%a1%b9" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Go æä¾›çš„ &lt;code>GORACE&lt;/code> ç¯å¢ƒå˜é‡å¯ä»¥ç”¨æ¥è®¾ç½®ç«äº‰æ£€æµ‹å™¨çš„é€‰é¡¹ï¼Œæ ¼å¼ä¸º &lt;code>GORACE=&amp;quot;option1=val1 option2=val2&amp;quot;&lt;/code>&lt;/p>
&lt;p>æ”¯æŒçš„é€‰é¡¹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>log_path&lt;/code>ï¼ˆé»˜è®¤ä¸º &lt;code>stderr&lt;/code>ï¼‰ï¼šç«äº‰æ£€æµ‹å™¨ä¼šå°†æŠ¥å‘Šå†™å…¥åä¸º &lt;code>&amp;lt;log_path&amp;gt;.pid&lt;/code> çš„æ–‡ä»¶ä¸­ã€‚å¦‚æœå€¼ä¸º &lt;code>stdout&lt;/code> æˆ– &lt;code>stderr&lt;/code> æ—¶ä¼šå°†æŠ¥å‘Šåˆ†åˆ«å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ä¸­ã€‚&lt;/li>
&lt;li>&lt;code>exitcode&lt;/code>ï¼ˆé»˜è®¤ä¸º 66ï¼‰ï¼šæ£€æµ‹åˆ°ç«äº‰åä½¿ç”¨çš„é€€å‡ºçŠ¶æ€ç ã€‚&lt;/li>
&lt;li>&lt;code>strip_path_prefix&lt;/code>ï¼ˆé»˜è®¤ä¸º &amp;ldquo;&amp;quot;ï¼‰ï¼šä»æ‰€æœ‰æŠ¥å‘Šæ–‡ä»¶çš„è·¯å¾„ä¸­å»é™¤æ­¤å‰ç¼€ï¼Œä½¿æŠ¥å‘Šæ›´åŠ ç®€æ´ã€‚&lt;/li>
&lt;li>&lt;code>history_size&lt;/code>ï¼ˆé»˜è®¤ä¸º 1ï¼‰ï¼šæ¯ä¸ª Go ç¨‹åºçš„å†…å­˜è®¿é—®å†å²ä¸º &lt;code>32K * 2**history_size&lt;/code> ä¸ªå…ƒç´ ã€‚å¢åŠ è¯¥å€¼å¯ä»¥åœ¨æŠ¥å‘Šä¸­é¿å… &amp;ldquo;failed to restore the stack&amp;rdquo; çš„æç¤ºï¼Œä½†ä»£ä»·æ˜¯ä¼šå¢åŠ å†…å­˜çš„ä½¿ç”¨ã€‚&lt;/li>
&lt;li>&lt;code>halt_on_error&lt;/code>ï¼ˆé»˜è®¤ä¸º 0ï¼‰ï¼šæ§åˆ¶ç¨‹åºåœ¨æŠ¥å‘Šç¬¬ä¸€æ¬¡æ•°æ®ç«äº‰åæ˜¯å¦é€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">GORACE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;log_path=/tmp/race/report strip_path_prefix=/my/go/sources/&amp;#34;&lt;/span> go &lt;span class="nb">test&lt;/span> -race&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ç¼–è¯‘æ ‡ç­¾&lt;span class="hx-absolute -hx-mt-20" id="ç¼–è¯‘æ ‡ç­¾">&lt;/span>
&lt;a href="#%e7%bc%96%e8%af%91%e6%a0%87%e7%ad%be" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¦‚æœæŸäº›ä»£ç ä¸éœ€è¦è¢«ç«äº‰æ£€æµ‹å™¨æ£€æŸ¥ï¼Œå¯ä»¥é€šè¿‡ç¼–è¯‘æ ‡ç­¾æ¥æ’é™¤ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//go:build !race
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">foo&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>è¿è¡Œæ—¶å¼€é”€&lt;span class="hx-absolute -hx-mt-20" id="è¿è¡Œæ—¶å¼€é”€">&lt;/span>
&lt;a href="#%e8%bf%90%e8%a1%8c%e6%97%b6%e5%bc%80%e9%94%80" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç«äº‰æ£€æµ‹å™¨åªä¼šå¯»æ‰¾åœ¨è¿è¡Œæ—¶å‘ç”Ÿçš„ç«äº‰ï¼Œå› æ­¤å®ƒä¸èƒ½åœ¨æœªæ‰§è¡Œçš„ä»£ç è·¯å¾„ä¸­å¯»æ‰¾ç«äº‰ã€‚å¦‚æœä½ çš„æµ‹è¯•è¦†ç›–ç‡æ¯”è¾ƒä½ï¼Œå¯ä»¥é€šè¿‡ &lt;code>go build -race&lt;/code> æ¥ç¼–è¯‘ï¼Œæ¥å¯»æ‰¾æ›´å¤šçš„ç«äº‰ã€‚&lt;/p>
&lt;p>ç«äº‰æ£€æµ‹çš„ä»£ä»·å› ç¨‹åºè€Œå¼‚ï¼Œä½†å¯¹äºå…¸å‹çš„ç¨‹åºï¼Œå†…å­˜çš„ä½¿ç”¨ä¼šå¢åŠ  5 åˆ° 10 å€ï¼Œ è€Œæ‰§è¡Œæ—¶é—´ä¼šå¢åŠ  2 åˆ° 20 å€ã€‚&lt;/p></description></item><item><title>Go æ€§èƒ½åˆ†æï¼ˆä¸Šï¼‰</title><link>https://shipengqi.github.io/golang-learn/docs/practice/04_pprof/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/04_pprof/</guid><description>
&lt;p>Go æä¾›çš„ pprof å·¥å…·å¯ä»¥ç”¨æ¥åšæ€§èƒ½åˆ†æã€‚pprof å¯ä»¥è¯»å–åˆ†ææ ·æœ¬çš„é›†åˆï¼Œå¹¶ç”ŸæˆæŠ¥å‘Šä»¥å¯è§†åŒ–å¹¶å¸®åŠ©åˆ†ææ•°æ®ã€‚&lt;/p>
&lt;p>pprof å¯ä»¥ç”¨äºï¼š&lt;/p>
&lt;ul>
&lt;li>CPU åˆ†æï¼ˆCPU Profilingï¼‰ï¼šæŒ‰ç…§ä¸€å®šçš„é¢‘ç‡é‡‡é›†æ‰€ç›‘å¬çš„åº”ç”¨ç¨‹åº CPUï¼ˆå«å¯„å­˜å™¨ï¼‰çš„ä½¿ç”¨æƒ…å†µï¼Œå¯ç¡®å®šåº”ç”¨ç¨‹åºåœ¨ä¸»åŠ¨æ¶ˆè€— CPU å‘¨æœŸ
æ—¶èŠ±è´¹æ—¶é—´çš„ä½ç½®ã€‚&lt;/li>
&lt;li>å†…å­˜åˆ†æï¼ˆMemory Profilingï¼‰ï¼šåœ¨åº”ç”¨ç¨‹åºè¿›è¡Œå †åˆ†é…æ—¶è®°å½•å †æ ˆè·Ÿè¸ªï¼Œç”¨äºç›‘è§†å½“å‰å’Œå†å²å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä»¥åŠæ£€æŸ¥å†…å­˜æ³„æ¼ã€‚&lt;/li>
&lt;li>é˜»å¡åˆ†æï¼ˆBlock Profilingï¼‰ï¼šè®°å½• goroutine é˜»å¡ç­‰å¾…åŒæ­¥ï¼ˆåŒ…æ‹¬å®šæ—¶å™¨é€šé“ï¼‰çš„ä½ç½®ã€‚&lt;/li>
&lt;li>äº’æ–¥é”åˆ†æï¼ˆMutex Profilingï¼‰ï¼šæŠ¥å‘Šäº’æ–¥é”çš„ç«äº‰æƒ…å†µã€‚&lt;/li>
&lt;/ul>
&lt;h2>å¦‚ä½•ç”Ÿæˆåˆ†ææ ·æœ¬&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•ç”Ÿæˆåˆ†ææ ·æœ¬">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e7%94%9f%e6%88%90%e5%88%86%e6%9e%90%e6%a0%b7%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”Ÿæˆåˆ†ææ ·æœ¬çš„ä¸‰ç§æ–¹å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>runtime/pprof&lt;/code>ï¼šé‡‡é›†ç¨‹åºï¼ˆé Serverï¼‰çš„è¿è¡Œæ•°æ®ã€‚é€šè¿‡è°ƒç”¨å¦‚ &lt;code>runtime.StartCPUProfile&lt;/code>, &lt;code>runtime.StopCPUProfile&lt;/code> æ–¹æ³•ç”Ÿæˆåˆ†ææ ·æœ¬ã€‚ä¸»è¦ç”¨äº&lt;strong>æœ¬åœ°æµ‹è¯•&lt;/strong>ã€‚
&lt;ul>
&lt;li>&lt;a href="https://github.com/pkg/profile" target="_blank" rel="noopener">pkg/profile&lt;/a> å°è£…äº† &lt;code>runtime/pprof&lt;/code>ï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ ç®€ä¾¿ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>net/http/pprof&lt;/code>ï¼šé‡‡é›† HTTP Server çš„è¿è¡Œæ—¶æ•°æ®ï¼Œé€šè¿‡ HTTP æœåŠ¡è·å– Profile åˆ†ææ ·æœ¬ï¼Œåº•å±‚è¿˜æ˜¯è°ƒç”¨çš„ &lt;code>runtime/pprof&lt;/code>ã€‚ä¸»è¦ç”¨äº&lt;strong>æœåŠ¡å™¨ç«¯æµ‹è¯•&lt;/strong>ã€‚&lt;/li>
&lt;li>&lt;code>go test -bench&lt;/code>ï¼šä½¿ç”¨ &lt;code>go test -bench=. -cpuprofile cpuprofile.out ...&lt;/code> è¿è¡ŒåŸºå‡†æµ‹è¯•æ¥ç”Ÿæˆåˆ†ææ ·æœ¬ï¼Œå¯ä»¥æŒ‡å®šæ‰€éœ€æ ‡è¯†æ¥è¿›è¡Œæ•°æ®é‡‡é›†ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»¥ &lt;code>net/http/pprof&lt;/code> ä¸ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span> &lt;span class="s">&amp;#34;net/http/pprof&amp;#34;&lt;/span> &lt;span class="c1">// net/http/pprof æ³¨å†Œçš„æ˜¯é»˜è®¤çš„ mux
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">datas&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">str&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">data&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">str&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sData&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">datas&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">datas&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">sData&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">sData&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;https://github.com/shipengqi&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ListenAndServe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>_ &amp;quot;net/http/pprof&amp;quot;&lt;/code> è¿™è¡Œä»£ç ä¼šè‡ªåŠ¨æ·»åŠ  &lt;code>/debug/pprof&lt;/code> çš„è·¯ç”±ã€‚ç¨‹åºè¿è¡Œåï¼Œè®¿é—® http://localhost:8080/debug/pprof å°±å¯ä»¥æŸ¥çœ‹åˆ†ææ ·æœ¬ã€‚&lt;/p>
&lt;h2>å¦‚ä½•æŸ¥çœ‹åˆ†ææŠ¥å‘Š&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•æŸ¥çœ‹åˆ†ææŠ¥å‘Š">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e6%9f%a5%e7%9c%8b%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ‰“å¼€ http://localhost:8080/debug/pprof åä¼šçœ‹åˆ°ä¸‹é¢é¡µé¢ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/810cbdff82baab7279ec4504d20e5b7bd88b6b33/go/pprof-home.png" alt="pprof-home" loading="lazy" />&lt;/p>
&lt;p>pprof åŒ…æ‹¬äº†å‡ ä¸ªå­é¡µé¢ï¼š&lt;/p>
&lt;ul>
&lt;li>alloc: æŸ¥çœ‹æ‰€æœ‰å†…å­˜åˆ†é…çš„æƒ…å†µ&lt;/li>
&lt;li>blockï¼ˆBlock Profilingï¼‰ï¼š&lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/block&lt;/code>ï¼ŒæŸ¥çœ‹å¯¼è‡´é˜»å¡åŒæ­¥çš„å †æ ˆè·Ÿè¸ª&lt;/li>
&lt;li>cmdline : å½“å‰ç¨‹åºçš„å‘½ä»¤è¡Œè°ƒç”¨&lt;/li>
&lt;li>goroutineï¼š&lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/goroutine&lt;/code>ï¼ŒæŸ¥çœ‹å½“å‰æ‰€æœ‰è¿è¡Œçš„ goroutines å †æ ˆè·Ÿè¸ªã€‚&lt;/li>
&lt;li>heapï¼ˆMemory Profilingï¼‰: &lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/heap&lt;/code>ï¼ŒæŸ¥çœ‹æ´»åŠ¨å¯¹è±¡çš„å†…å­˜åˆ†é…æƒ…å†µï¼Œåœ¨è·å–å †æ ·æœ¬ä¹‹å‰ï¼Œå¯ä»¥æŒ‡å®š gc GET å‚æ•°æ¥è¿è¡Œ gcã€‚&lt;/li>
&lt;li>mutexï¼ˆMutex Profilingï¼‰: &lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/mutex&lt;/code>ï¼ŒæŸ¥çœ‹å¯¼è‡´äº’æ–¥é”ç«äº‰çš„æŒæœ‰è€…çš„å †æ ˆè·Ÿè¸ªã€‚&lt;/li>
&lt;li>profileï¼ˆCPU Profilingï¼‰: &lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/profile&lt;/code>ï¼Œ é»˜è®¤è¿›è¡Œ &lt;code>30s&lt;/code> çš„ CPU Profilingï¼Œå¯ä»¥è®¾ç½® GET å‚æ•° &lt;code>seconds&lt;/code> æ¥æŒ‡å®šæŒç»­æ—¶é—´ã€‚è·å–è·Ÿè¸ªæ–‡ä»¶ä¹‹åï¼Œä½¿ç”¨ &lt;code>go tool trace&lt;/code> å‘½ä»¤æ¥åˆ†æã€‚&lt;/li>
&lt;li>threadcreateï¼š&lt;code>&amp;lt;ip:port&amp;gt;/debug/pprof/threadcreate&lt;/code>ï¼ŒæŸ¥çœ‹åˆ›å»ºæ–° OS çº¿ç¨‹çš„å †æ ˆè·Ÿè¸ªã€‚&lt;/li>
&lt;li>trace: å½“å‰ç¨‹åºçš„æ‰§è¡Œè½¨è¿¹ã€‚å¯ä»¥è®¾ç½® GET å‚æ•° &lt;code>seconds&lt;/code> æ¥æŒ‡å®šæŒç»­æ—¶é—´ã€‚è·å–è·Ÿè¸ªæ–‡ä»¶ä¹‹åï¼Œä½¿ç”¨ &lt;code>go tool trace&lt;/code> å‘½ä»¤æ¥åˆ†æã€‚&lt;/li>
&lt;/ul>
&lt;h3>åœ¨ Web æŸ¥çœ‹åˆ†ææŠ¥å‘Š&lt;span class="hx-absolute -hx-mt-20" id="åœ¨-web-æŸ¥çœ‹åˆ†ææŠ¥å‘Š">&lt;/span>
&lt;a href="#%e5%9c%a8-web-%e6%9f%a5%e7%9c%8b%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç‚¹å‡» profileï¼Œç­‰å¾… 30s åä¼šä¸‹è½½ CPU profile æ–‡ä»¶ï¼Œæˆ–è€…æ‰§è¡Œå‘½ä»¤ &lt;code>go tool pprof http://localhost:8080/debug/pprof/profile&lt;/code> ï¼Œå¾—åˆ°çš„è¾“å‡ºä¸­æœ‰ä¸€è¡Œ&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Saved profile in C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>hipeng.CORPDOM&lt;span class="se">\p&lt;/span>prof&lt;span class="se">\p&lt;/span>prof.samples.cpu.002.pb.gz&lt;span class="sb">`&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¡¨ç¤ºç”Ÿæˆçš„ profile æ–‡ä»¶è·¯å¾„ã€‚&lt;/p>
&lt;p>æ‰§è¡Œ &lt;code>go tool pprof -http=&amp;lt;port&amp;gt; &amp;lt;profile æ–‡ä»¶&amp;gt;&lt;/code> å¯åŠ¨ web serverï¼Œç„¶åå°±å¯ä»¥è®¿é—® &lt;code>http://localhost:8081&lt;/code> æ¥æŸ¥çœ‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ go tool pprof -http&lt;span class="o">=&lt;/span>:8081 profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Serving web UI on http://localhost:8081&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æˆ–è€…è¾“å…¥ &lt;code>web&lt;/code>ï¼Œä¼šåœ¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ª svg å›¾ç‰‡ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ go tool pprof profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ &lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span> web&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;blockquote>
&lt;p>å¦‚æœå‡ºç° &lt;code>Could not execute dot; may need to install graphviz.&lt;/code>ï¼Œé‚£ä¹ˆéœ€è¦å®‰è£ Graphvizã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/810cbdff82baab7279ec4504d20e5b7bd88b6b33/go/profile-graph.png" alt="profile-graph" loading="lazy" />&lt;/p>
&lt;p>å›¾ä¸­æ¡†è¶Šå¤§ï¼Œçº¿è¶Šç²—ä»£è¡¨å®ƒå ç”¨ CPU çš„æ—¶é—´è¶Šé•¿ã€‚&lt;/p>
&lt;p>ç‚¹å‡» &lt;code>View -&amp;gt; Flame Graph&lt;/code> å¯ä»¥æŸ¥çœ‹ç«ç„°å›¾ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/810cbdff82baab7279ec4504d20e5b7bd88b6b33/go/profile-flame-graph.png" alt="profile-flame-graph" loading="lazy" />&lt;/p>
&lt;p>å›¾ä¸­è°ƒç”¨é¡ºåºç”±ä¸Šåˆ°ä¸‹ï¼Œæ¯ä¸€å—ä»£è¡¨ä¸€ä¸ªå‡½æ•°ï¼Œè¶Šå¤§ä»£è¡¨å ç”¨ CPU çš„æ—¶é—´è¶Šé•¿ã€‚&lt;/p>
&lt;p>è¿˜å¯ä»¥æŸ¥çœ‹ Topï¼ŒPeekï¼ŒSource ç­‰ã€‚èƒ½å¤Ÿæ›´æ–¹ä¾¿ã€æ›´ç›´è§‚çš„çœ‹åˆ° Go åº”ç”¨ç¨‹åºçš„è°ƒç”¨é“¾ã€ä½¿ç”¨æƒ…å†µç­‰ã€‚&lt;/p>
&lt;h3>åœ¨ç»ˆç«¯æŸ¥çœ‹åˆ†ææŠ¥å‘Š&lt;span class="hx-absolute -hx-mt-20" id="åœ¨ç»ˆç«¯æŸ¥çœ‹åˆ†ææŠ¥å‘Š">&lt;/span>
&lt;a href="#%e5%9c%a8%e7%bb%88%e7%ab%af%e6%9f%a5%e7%9c%8b%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä½¿ç”¨ &lt;code>go tool pprof&lt;/code> å‘½ä»¤å¯ä»¥åœ¨äº¤äº’å¼ç»ˆç«¯æŸ¥çœ‹åˆ†ææŠ¥å‘Šã€‚&lt;/p>
&lt;h4>CPU Profiling&lt;span class="hx-absolute -hx-mt-20" id="cpu-profiling">&lt;/span>
&lt;a href="#cpu-profiling" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>æ‰§è¡Œ 60s çš„ CPU Profilingï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ go tool pprof http://localhost:8080/debug/pprof/profile?seconds&lt;span class="o">=&lt;/span>&lt;span class="m">60&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fetching profile over HTTP from http://localhost:6060/debug/pprof/profile?seconds&lt;span class="o">=&lt;/span>&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saved profile in C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>hipeng.CORPDOM&lt;span class="se">\p&lt;/span>prof&lt;span class="se">\p&lt;/span>prof.samples.cpu.001.pb.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type: cpu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Time: Nov 18, &lt;span class="m">2019&lt;/span> at 11:08am &lt;span class="o">(&lt;/span>CST&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Duration: 10.20s, Total &lt;span class="nv">samples&lt;/span> &lt;span class="o">=&lt;/span> 10.03s &lt;span class="o">(&lt;/span>98.38%&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Entering interactive mode &lt;span class="o">(&lt;/span>&lt;span class="nb">type&lt;/span> &lt;span class="s2">&amp;#34;help&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> commands, &lt;span class="s2">&amp;#34;o&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> options&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å…¥ &lt;code>top 10&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span> top &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Showing nodes accounting &lt;span class="k">for&lt;/span> 9.54s, 95.11% of 10.03s total
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dropped &lt;span class="m">73&lt;/span> nodes &lt;span class="o">(&lt;/span>cum &amp;lt;&lt;span class="o">=&lt;/span> 0.05s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Showing top &lt;span class="m">10&lt;/span> nodes out of &lt;span class="m">14&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> flat flat% sum% cum cum%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 9.42s 93.92% 93.92% 9.46s 94.32% runtime.cgocall
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.02s 0.2% 94.12% 9.62s 95.91% internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.writeConsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.02s 0.2% 94.32% 9.81s 97.81% log.&lt;span class="o">(&lt;/span>*Logger&lt;span class="o">)&lt;/span>.Output
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.02s 0.2% 94.52% 0.10s 1% log.&lt;span class="o">(&lt;/span>*Logger&lt;span class="o">)&lt;/span>.formatHeader
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.02s 0.2% 94.72% 0.06s 0.6% main.Add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.02s 0.2% 94.92% 9.50s 94.72% syscall.Syscall6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.01s 0.1% 95.01% 0.07s 0.7% runtime.systemstack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0.01s 0.1% 95.11% 9.51s 94.82% syscall.WriteConsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 95.11% 0.07s 0.7% fmt.Sprintln
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 95.11% 9.69s 96.61% internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.Write&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>&lt;code>flat&lt;/code>ï¼šå½“å‰å‡½æ•°ä¸Šçš„è¿è¡Œè€—æ—¶&lt;/li>
&lt;li>&lt;code>flat%&lt;/code>ï¼šå½“å‰å‡½æ•°ä¸Šçš„ CPU è¿è¡Œè€—æ—¶æ€»æ¯”ä¾‹&lt;/li>
&lt;li>&lt;code>sum%&lt;/code>ï¼šå½“å‰å‡½æ•°ä¸Šç´¯ç§¯ä½¿ç”¨ CPU æ€»æ¯”ä¾‹&lt;/li>
&lt;li>&lt;code>cum&lt;/code>ï¼šå½“å‰å‡½æ•°åŠ ä¸Šå®ƒä¹‹ä¸Šçš„è°ƒç”¨è¿è¡Œæ€»è€—æ—¶&lt;/li>
&lt;li>&lt;code>cum%&lt;/code>ï¼šå½“å‰å‡½æ•°åŠ ä¸Šå®ƒä¹‹ä¸Šçš„è°ƒç”¨çš„ CPU è¿è¡Œè€—æ—¶æ€»æ¯”ä¾‹&lt;/li>
&lt;li>æœ€åä¸€åˆ—ä¸ºå‡½æ•°åç§°&lt;/li>
&lt;/ul>
&lt;h4>Heap Profiling&lt;span class="hx-absolute -hx-mt-20" id="heap-profiling">&lt;/span>
&lt;a href="#heap-profiling" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Heap Profiling æ”¯æŒå››ç§å†…å­˜æ¦‚å†µçš„åˆ†æï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>inuse_space&lt;/code>ï¼šåˆ†æç¨‹åºå¸¸é©»å†…å­˜çš„å ç”¨&lt;/li>
&lt;li>&lt;code>alloc_objects&lt;/code>ï¼šåˆ†æç¨‹åºä¸´æ—¶åˆ†é…çš„å†…å­˜&lt;/li>
&lt;li>&lt;code>inuse_objects&lt;/code>ï¼šæŸ¥çœ‹å‡½æ•°å¯¹åº”çš„å¯¹è±¡çš„æ•°é‡&lt;/li>
&lt;li>&lt;code>alloc_space&lt;/code>ï¼šæŸ¥çœ‹å‡½æ•°åˆ†é…çš„å†…å­˜ç©ºé—´å¤§å°&lt;/li>
&lt;/ul>
&lt;p>é»˜è®¤å°±æ˜¯ &lt;code>inuse_space&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># é»˜è®¤å°±æ˜¯ inuse_spaceï¼Œ-inuse_space å¯ä»¥å¿½ç•¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ go tool pprof -inuse_space http://localhost:8080/debug/pprof/heap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saved profile in C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>hipeng&lt;span class="se">\p&lt;/span>prof&lt;span class="se">\p&lt;/span>prof.___go_build_github_com_shipengqi_example_v1_advance_go_pprof.exe.alloc_objects.alloc_space.inuse_objects.inuse_space.002.pb.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type: inuse_space
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Time: Dec 6, &lt;span class="m">2023&lt;/span> at 2:05pm &lt;span class="o">(&lt;/span>CST&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Entering interactive mode &lt;span class="o">(&lt;/span>&lt;span class="nb">type&lt;/span> &lt;span class="s2">&amp;#34;help&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> commands, &lt;span class="s2">&amp;#34;o&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> options&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å…¥ &lt;code>top&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span> top
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Showing nodes accounting &lt;span class="k">for&lt;/span> 42464.20kB, 100% of 42464.20kB total
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> flat flat% sum% cum cum%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">41952.16kB 98.79% 98.79% 41952.16kB 98.79% main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 512.04kB 1.21% 100% 512.04kB 1.21% unicode/utf16.Encode
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.Write
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.writeConsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% log.&lt;span class="o">(&lt;/span>*Logger&lt;span class="o">)&lt;/span>.output
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% log.Println &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 42464.20kB 100% main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% os.&lt;span class="o">(&lt;/span>*File&lt;span class="o">)&lt;/span>.Write
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 0% 100% 512.04kB 1.21% os.&lt;span class="o">(&lt;/span>*File&lt;span class="o">)&lt;/span>.write &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å…¥ &lt;code>traces&lt;/code> æŸ¥çœ‹ goroutines å ç”¨å†…å­˜çš„å¤§å°ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span> traces
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type: inuse_space
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Time: Dec 6, &lt;span class="m">2023&lt;/span> at 2:45pm &lt;span class="o">(&lt;/span>CST&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bytes: 2.25MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 2.28MB main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bytes: 1.80MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1.85MB main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bytes: 1.43MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bytes: 1.14MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> main.Add &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h4>Goroutine Profiling&lt;span class="hx-absolute -hx-mt-20" id="goroutine-profiling">&lt;/span>
&lt;a href="#goroutine-profiling" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">$ go tool pprof http://localhost:8080/debug/pprof/goroutine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saved profile in C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>hipeng&lt;span class="se">\p&lt;/span>prof&lt;span class="se">\p&lt;/span>prof.___go_build_github_com_shipengqi_example_v1_advance_go_pprof.exe.goroutine.001.pb.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å…¥ &lt;code>traces&lt;/code> ä¼šè¾“å‡ºæ‰€æœ‰ goroutines çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹æ•´ä¸ªè°ƒç”¨é“¾ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>pprof&lt;span class="o">)&lt;/span> traces
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> runtime.cgocall
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> syscall.SyscallN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> syscall.Syscall6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> syscall.WriteConsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.writeConsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> internal/poll.&lt;span class="o">(&lt;/span>*FD&lt;span class="o">)&lt;/span>.Write
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> os.&lt;span class="o">(&lt;/span>*File&lt;span class="o">)&lt;/span>.write &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> os.&lt;span class="o">(&lt;/span>*File&lt;span class="o">)&lt;/span>.Write
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> log.&lt;span class="o">(&lt;/span>*Logger&lt;span class="o">)&lt;/span>.output
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> log.Println &lt;span class="o">(&lt;/span>inline&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.main.func1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----------+-------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> runtime.goroutineProfileWithLabels
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> runtime/pprof.runtime_goroutineProfileWithLabels
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> runtime/pprof.writeRuntimeProfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> runtime/pprof.writeGoroutine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> runtime/pprof.&lt;span class="o">(&lt;/span>*Profile&lt;span class="o">)&lt;/span>.WriteTo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http/pprof.handler.ServeHTTP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http/pprof.Index
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http.HandlerFunc.ServeHTTP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http.&lt;span class="o">(&lt;/span>*ServeMux&lt;span class="o">)&lt;/span>.ServeHTTP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http.serverHandler.ServeHTTP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> net/http.&lt;span class="o">(&lt;/span>*conn&lt;span class="o">)&lt;/span>.serve&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è°ƒç”¨æ ˆçš„é¡ºåºæ˜¯&lt;strong>è‡ªä¸‹è€Œä¸Š&lt;/strong>çš„ã€‚&lt;/p>
&lt;h4>Block å’Œ Mutex Profiling&lt;span class="hx-absolute -hx-mt-20" id="block-å’Œ-mutex-profiling">&lt;/span>
&lt;a href="#block-%e5%92%8c-mutex-profiling" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Block å’Œ Mutex Profiling éƒ½éœ€è¦åœ¨ä»£ç ä¸­è°ƒç”¨ &lt;code>runtime&lt;/code> åŒ…çš„æ–¹æ³•è¿›è¡Œè®¾ç½®ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;runtime&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Rate å°äº 0ï¼Œåˆ™ä¸é‡‡é›†
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">runtime&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SetBlockProfileRate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Fraction å°äº 0ï¼Œåˆ™ä¸é‡‡é›†
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">runtime&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SetMutexProfileFraction&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç„¶åä½¿ç”¨ &lt;code>go tool pprof&lt;/code> åˆ†æï¼Œè¾“å…¥ &lt;code>top&lt;/code> æŸ¥çœ‹æ’åï¼Œ&lt;code>list &amp;lt;func&amp;gt;&lt;/code> å¯ä»¥æŸ¥çœ‹å…·ä½“çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;h4>å¯¹æ¯”&lt;span class="hx-absolute -hx-mt-20" id="å¯¹æ¯”">&lt;/span>
&lt;a href="#%e5%af%b9%e6%af%94" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>å½“éœ€è¦æŸ¥çœ‹ä¸åŒæ—¶é—´æ®µçš„å·®å¼‚æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>-base&lt;/code> å‚æ•°æ¥å¯¹æ¯”ä¸¤ä¸ª profile æ–‡ä»¶ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ go tool pprof -base &amp;lt;profile1&amp;gt; &amp;lt;profile2&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div></description></item><item><title>Go æ€§èƒ½åˆ†æï¼ˆä¸‹ï¼‰</title><link>https://shipengqi.github.io/golang-learn/docs/practice/05_trace/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/05_trace/</guid><description>
&lt;p>Go æä¾›äº†å®Œå–„çš„æ€§èƒ½åˆ†æå·¥å…·ï¼š&lt;code>pprof&lt;/code> å’Œ &lt;code>trace&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>pprof&lt;/code> ä¸»è¦é€‚ç”¨äº CPU å ç”¨ã€å†…å­˜åˆ†é…ç­‰èµ„æºçš„åˆ†æã€‚&lt;/li>
&lt;li>&lt;code>trace&lt;/code> è®°å½•äº†ç¨‹åºè¿è¡Œä¸­çš„è¡Œä¸ºï¼Œæ›´é€‚åˆäºæ‰¾å‡ºç¨‹åºåœ¨ä¸€æ®µæ—¶é—´å†…æ­£åœ¨åšä»€ä¹ˆã€‚ä¾‹å¦‚æŒ‡å®šçš„ goroutine
åœ¨ä½•æ—¶æ‰§è¡Œã€æ‰§è¡Œäº†å¤šé•¿æ—¶é—´ã€ä»€ä¹ˆæ—¶å€™é™·å…¥äº†å µå¡ã€ä»€ä¹ˆæ—¶å€™è§£é™¤äº†å µå¡ã€GC å¦‚ä½•å½±å“äº† goroutine çš„æ‰§è¡Œã€‚&lt;/li>
&lt;/ul>
&lt;h2>å¦‚ä½•ç”Ÿæˆåˆ†ææ ·æœ¬&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•ç”Ÿæˆåˆ†ææ ·æœ¬">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e7%94%9f%e6%88%90%e5%88%86%e6%9e%90%e6%a0%b7%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç”Ÿæˆ Trace åˆ†ææ ·æœ¬çš„æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§ï¼š&lt;/p>
&lt;p>&lt;strong>1. ä½¿ç”¨ &lt;code>runtime/trace&lt;/code> æ ‡å‡†åº“æ¥ç”Ÿæˆ&lt;/strong>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;runtime/trace&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">f&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;trace.out&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">f&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">trace&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Start&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">trace&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Stop&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// read from channel
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">ch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ‰§è¡Œç¨‹åºå°±å¯ä»¥ç”Ÿæˆè·Ÿè¸ªæ–‡ä»¶ &lt;code>trace.out&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>go run main.go&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;strong>2. ä½¿ç”¨ &lt;code>net/http/pprof&lt;/code> æ¥ç”Ÿæˆ&lt;/strong>ï¼ŒæŸ¥çœ‹ &lt;a href="../04_pprof" >Go æ€§èƒ½åˆ†æ&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;strong>3. ä½¿ç”¨ &lt;code>go test -trace&lt;/code> æ¥ç”Ÿæˆ&lt;/strong>ï¼Œä¾‹å¦‚ &lt;code>go test -trace trace.out demo_test.go&lt;/code>ã€‚&lt;/p>
&lt;h2>å¦‚ä½•æŸ¥çœ‹åˆ†ææŠ¥å‘Š&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•æŸ¥çœ‹åˆ†ææŠ¥å‘Š">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e6%9f%a5%e7%9c%8b%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ä½¿ç”¨ä¸Šé¢ä¾‹å­ç”Ÿæˆçš„ &lt;code>trace.out&lt;/code> æ–‡ä»¶ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go tool trace trace.out
2019/11/18 15:17:28 Parsing trace...
2019/11/18 15:17:28 Splitting trace...
2019/11/18 15:17:28 Opening browser. Trace viewer is listening on http://127.0.0.1:59181&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è®¿é—® http://127.0.0.1:59181ï¼Œå¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„ç•Œé¢ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/f700fde7450ccdb21c410611ff949769e301c364/go/trace-home.png" alt="trace-home" loading="lazy" />&lt;/p>
&lt;ul>
&lt;li>&lt;code>View trace&lt;/code>ï¼šæŸ¥çœ‹æ‰€æœ‰ goroutines çš„æ‰§è¡Œè¿‡ç¨‹ã€‚&lt;/li>
&lt;li>&lt;code>Goroutine analysis&lt;/code>ï¼šgoroutines åˆ†æï¼ŒæŸ¥çœ‹å…·ä½“çš„ goroutine çš„ä¿¡æ¯ã€‚&lt;/li>
&lt;li>&lt;code>Network blocking profile&lt;/code>ï¼šç½‘ç»œé˜»å¡æ¦‚å†µã€‚&lt;/li>
&lt;li>&lt;code>Synchronization blocking profile&lt;/code>ï¼šåŒæ­¥é˜»å¡æ¦‚å†µã€‚&lt;/li>
&lt;li>&lt;code>Syscall blocking profile&lt;/code>ï¼šç³»ç»Ÿè°ƒç”¨é˜»å¡æ¦‚å†µã€‚&lt;/li>
&lt;li>&lt;code>Scheduler latency profile&lt;/code>ï¼šè°ƒåº¦å»¶è¿Ÿçš„æ¦‚å†µï¼Œå¯ä»¥è°ƒåº¦åœ¨å“ªé‡Œæœ€è€—è´¹æ—¶é—´ã€‚&lt;/li>
&lt;li>&lt;code>User defined tasks&lt;/code>ï¼šç”¨æˆ·è‡ªå®šä¹‰ä»»åŠ¡ã€‚&lt;/li>
&lt;li>&lt;code>User defined regions&lt;/code>ï¼šç”¨æˆ·è‡ªå®šä¹‰åŒºåŸŸã€‚&lt;/li>
&lt;li>&lt;code>Minimum mutator utilization&lt;/code>ï¼šæœ€ä½ Mutator åˆ©ç”¨ç‡ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>Network/Sync/Syscall blocking profile æ˜¯åˆ†æé”ç«äº‰çš„æœ€ä½³é€‰æ‹©ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3>View trace&lt;span class="hx-absolute -hx-mt-20" id="view-trace">&lt;/span>
&lt;a href="#view-trace" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¿›å…¥ &lt;code>View trace&lt;/code> é¡µé¢ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/f700fde7450ccdb21c410611ff949769e301c364/go/view-trace.png" alt="view-trace" loading="lazy" />&lt;/p>
&lt;ol>
&lt;li>æ—¶é—´çº¿ï¼šæ˜¾ç¤ºæ‰§è¡Œçš„æ—¶é—´ã€‚&lt;/li>
&lt;li>Goroutines/Heap/Threads çš„è¯¦ç»†ä¿¡æ¯ã€‚
&lt;ul>
&lt;li>Goroutinesï¼šæ˜¾ç¤ºåœ¨æ‰§è¡ŒæœŸé—´çš„æœ‰å¤šå°‘ä¸ª goroutine åœ¨è¿è¡Œï¼ŒåŒ…å« GC ç­‰å¾…ï¼ˆGCWaitingï¼‰ã€å¯è¿è¡Œï¼ˆRunnableï¼‰ã€ è¿è¡Œä¸­ï¼ˆRunningï¼‰è¿™ä¸‰ç§çŠ¶æ€ã€‚&lt;/li>
&lt;li>Heapï¼šæ˜¾ç¤ºæ‰§è¡ŒæœŸé—´çš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾æƒ…å†µï¼ŒåŒ…å«å½“å‰å †ä½¿ç”¨é‡ï¼ˆAllocatedï¼‰å’Œä¸‹ä¸€æ¬¡ GC çš„é˜ˆå€¼ï¼ˆNextGCï¼‰ç»Ÿè®¡ã€‚&lt;/li>
&lt;li>Threadsï¼šæ˜¾ç¤ºæ‰§è¡ŒæœŸé—´æœ‰å¤šå°‘ä¸ªç³»ç»Ÿçº¿ç¨‹åœ¨è¿è¡Œï¼ŒåŒ…å«æ­£åœ¨è°ƒç”¨ SysCall ï¼ˆInSysCallï¼‰å’Œè¿è¡Œä¸­ï¼ˆRunningï¼‰ä¸¤ç§çŠ¶æ€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>PROCS&lt;/code>ï¼šæ¯ä¸ª Processor æ˜¾ç¤ºä¸€è¡Œã€‚é»˜è®¤æ˜¾ç¤ºç³»ç»Ÿå†…æ ¸æ•°é‡ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>runtime.GOMAXPROCS(n)&lt;/code> æ¥æ§åˆ¶æ•°é‡ã€‚
&lt;ul>
&lt;li>&lt;code>GC&lt;/code>ï¼šæ˜¾ç¤ºæ‰§è¡ŒæœŸé—´åƒåœ¾å›æ”¶æ‰§è¡Œçš„æ¬¡æ•°å’Œæ—¶é—´ã€‚&lt;strong>æ¯æ¬¡æ‰§è¡Œ GCï¼Œå †å†…å­˜éƒ½ä¼šè¢«é‡Šæ”¾ä¸€éƒ¨åˆ†&lt;/strong>ã€‚&lt;/li>
&lt;li>åç¨‹å’Œäº‹ä»¶ï¼šæ˜¾ç¤ºåœ¨æ¯ä¸ªè™šæ‹Ÿå¤„ç†å™¨ä¸Šæœ‰ä»€ä¹ˆ Goroutine æ­£åœ¨è¿è¡Œï¼Œè€Œè¿çº¿è¡Œä¸ºä»£è¡¨äº‹ä»¶å…³è”ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>å¿«æ·é”®ï¼šwï¼ˆæ”¾å¤§ï¼‰ï¼Œsï¼ˆç¼©å°ï¼‰ï¼Œaï¼ˆå·¦ç§»ï¼‰ï¼Œdï¼ˆå³ç§»ï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;h4>æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹ goroutines æƒ…å†µ&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹-goroutines-æƒ…å†µ">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aa%e6%97%b6%e9%97%b4%e7%82%b9-goroutines-%e6%83%85%e5%86%b5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/f700fde7450ccdb21c410611ff949769e301c364/go/view-trace-g-counter.png" alt="view-trace-g-counter" loading="lazy" />&lt;/p>
&lt;p>å›¾ä¸­æ­£åœ¨è¿è¡Œçš„ goroutine æ•°é‡ä¸º 3ï¼Œå…¶ä»–çŠ¶æ€çš„ goroutine æ•°é‡éƒ½æ˜¯ 0ã€‚&lt;/p>
&lt;h4>æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹å †çš„ä½¿ç”¨æƒ…å†µ&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹å †çš„ä½¿ç”¨æƒ…å†µ">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aa%e6%97%b6%e9%97%b4%e7%82%b9%e5%a0%86%e7%9a%84%e4%bd%bf%e7%94%a8%e6%83%85%e5%86%b5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/view-trace-heap.png" alt="view-trace-heap" loading="lazy" />&lt;/p>
&lt;ol>
&lt;li>çº¢è‰²éƒ¨åˆ†è¡¨ç¤ºå·²ç»å ç”¨çš„å†…å­˜&lt;/li>
&lt;li>ç»¿è‰²éƒ¨åˆ†çš„ä¸Šè¾¹æ²¿è¡¨ç¤ºä¸‹æ¬¡ GC çš„ç›®æ ‡å†…å­˜ï¼Œä¹Ÿå°±æ˜¯ç»¿è‰²éƒ¨åˆ†ç”¨å®Œä¹‹åï¼Œå°±ä¼šè§¦å‘ GCã€‚&lt;/li>
&lt;/ol>
&lt;h4>æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„ç³»ç»Ÿçº¿ç¨‹&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„ç³»ç»Ÿçº¿ç¨‹">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aa%e6%97%b6%e9%97%b4%e7%82%b9%e7%9a%84%e7%b3%bb%e7%bb%9f%e7%ba%bf%e7%a8%8b" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/view-trace-threads.png" alt="view-trace-threads" loading="lazy" />&lt;/p>
&lt;p>å›¾ä¸­æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡ä¸º 3ï¼Œæ­£åœ¨è°ƒç”¨ SysCall çš„çº¿ç¨‹æ•°é‡ä¸º 0ã€‚&lt;/p>
&lt;h4>æŸ¥çœ‹ GC&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥çœ‹-gc">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b-gc" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/view-trace-gc.png" alt="view-trace-gc" loading="lazy" />&lt;/p>
&lt;p>å¯ä»¥é€‰æ‹©å¤šä¸ªæŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯ã€‚&lt;/p>
&lt;h4>æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„ goroutine è¿è¡Œæƒ…å†µ&lt;span class="hx-absolute -hx-mt-20" id="æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„-goroutine-è¿è¡Œæƒ…å†µ">&lt;/span>
&lt;a href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aa%e6%97%b6%e9%97%b4%e7%82%b9%e7%9a%84-goroutine-%e8%bf%90%e8%a1%8c%e6%83%85%e5%86%b5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/view-trace-folw-events.png" alt="view-trace-folw-events" loading="lazy" />&lt;/p>
&lt;p>ç‚¹å‡»å…·ä½“çš„ Goroutine å¯ä»¥æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>Start&lt;/code>ï¼šå¼€å§‹æ—¶é—´&lt;/li>
&lt;li>&lt;code>Wall Duration&lt;/code>ï¼šæŒç»­æ—¶é—´&lt;/li>
&lt;li>&lt;code>Self Time&lt;/code>ï¼šæ‰§è¡Œæ—¶é—´&lt;/li>
&lt;li>&lt;code>Start Stack Trace&lt;/code>ï¼šå¼€å§‹æ—¶çš„å †æ ˆä¿¡æ¯&lt;/li>
&lt;li>&lt;code>End Stack Trace&lt;/code>ï¼šç»“æŸæ—¶çš„å †æ ˆä¿¡æ¯&lt;/li>
&lt;li>&lt;code>Incoming flow&lt;/code>ï¼šè¾“å…¥æµ&lt;/li>
&lt;li>&lt;code>Outgoing flow&lt;/code>ï¼šè¾“å‡ºæµ&lt;/li>
&lt;li>&lt;code>Preceding events&lt;/code>ï¼šä¹‹å‰çš„äº‹ä»¶&lt;/li>
&lt;li>&lt;code>Following events&lt;/code>ï¼šä¹‹åçš„äº‹ä»¶&lt;/li>
&lt;li>&lt;code>All connected&lt;/code>ï¼šæ‰€æœ‰è¿æ¥çš„äº‹ä»¶&lt;/li>
&lt;/ul>
&lt;p>ç‚¹å‡» &lt;code>Flow events&lt;/code> é€‰æ‹© &lt;code>All&lt;/code>ï¼Œå¯ä»¥æŸ¥çœ‹ç¨‹åºè¿è¡Œä¸­çš„äº‹ä»¶æµæƒ…å†µã€‚&lt;/p>
&lt;h3>Goroutine analysis&lt;span class="hx-absolute -hx-mt-20" id="goroutine-analysis">&lt;/span>
&lt;a href="#goroutine-analysis" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¿›å…¥ &lt;code>Goroutine analysis&lt;/code> å¯æŸ¥çœ‹æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªå‡½æ•°å—æœ‰å¤šå°‘ä¸ª goroutine åœ¨è·‘ï¼Œå¹¶ä¸”è§‚å¯Ÿæ¯ä¸ªçš„ goroutine çš„è¿è¡Œå¼€é”€éƒ½èŠ±è´¹åœ¨å“ªä¸ªé˜¶æ®µã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/goroutines-analysis.png" alt="goroutines-analysis" loading="lazy" />&lt;/p>
&lt;p>ç‚¹å‡»ä¸€ä¸ª goroutine æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ &lt;code>main.main.func1&lt;/code>ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/aa2cb61b817e520379277b90937ac21909b4abd5/go/goroutines-analysis-n.png" alt="goroutines-analysis-n" loading="lazy" />&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>åç§°&lt;/th>
&lt;th>å«ä¹‰&lt;/th>
&lt;th>è€—æ—¶&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Execution Time&lt;/td>
&lt;td>æ‰§è¡Œæ—¶é—´&lt;/td>
&lt;td>983ms&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Network Wait Time&lt;/td>
&lt;td>ç½‘ç»œç­‰å¾…æ—¶é—´&lt;/td>
&lt;td>0ns&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Sync Block Time&lt;/td>
&lt;td>åŒæ­¥é˜»å¡æ—¶é—´&lt;/td>
&lt;td>0ns&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Blocking Syscall Time&lt;/td>
&lt;td>è°ƒç”¨é˜»å¡æ—¶é—´&lt;/td>
&lt;td>2ns&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Scheduler Wait Time&lt;/td>
&lt;td>è°ƒåº¦ç­‰å¾…æ—¶é—´&lt;/td>
&lt;td>194Âµs&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GC Sweeping&lt;/td>
&lt;td>GC æ¸…æ‰«&lt;/td>
&lt;td>0ns&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>GC Pause&lt;/td>
&lt;td>GC æš‚åœ&lt;/td>
&lt;td>14ms&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Go æ€§èƒ½ä¼˜åŒ–</title><link>https://shipengqi.github.io/golang-learn/docs/practice/06_performance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/06_performance/</guid><description>
&lt;h2>JSON ä¼˜åŒ–&lt;span class="hx-absolute -hx-mt-20" id="json-ä¼˜åŒ–">&lt;/span>
&lt;a href="#json-%e4%bc%98%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go çš„æ ‡å‡†åº“ &lt;code>encoding/json&lt;/code> æ˜¯é€šè¿‡åå°„æ¥å®ç°çš„ã€‚æ€§èƒ½ç›¸å¯¹æœ‰äº›æ…¢ã€‚ å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥æ›¿ä»£æ ‡å‡†åº“ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/json-iterator/go" target="_blank" rel="noopener">json-iterator/go&lt;/a>ï¼Œå®Œå…¨å…¼å®¹æ ‡å‡†åº“ï¼Œæ€§èƒ½æœ‰å¾ˆå¤§æå‡ã€‚&lt;/li>
&lt;li>&lt;a href="https://github.com/goccy/go-json" target="_blank" rel="noopener">go-json&lt;/a>ï¼Œå®Œå…¨å…¼å®¹æ ‡å‡†åº“ï¼Œæ€§èƒ½å¼ºäº &lt;code>json-iterator/go&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;a href="https://github.com/bytedance/sonic" target="_blank" rel="noopener">sonic&lt;/a>ï¼Œå­—èŠ‚å¼€å‘çš„çš„ JSON åºåˆ—åŒ–/ååºåˆ—åŒ–åº“ï¼Œé€Ÿåº¦å¿«ï¼Œä½†æ˜¯å¯¹ç¡¬ä»¶æœ‰ä¸€äº›è¦æ±‚ã€‚&lt;/li>
&lt;/ul>
&lt;p>å®é™…å¼€å‘ä¸­å¯ä»¥æ ¹æ®ç¼–è¯‘æ ‡ç­¾æ¥é€‰æ‹© &lt;code>JSON&lt;/code> åº“ï¼Œå‚è€ƒ &lt;a href="https://github.com/shipengqi/component-base/tree/main/json" target="_blank" rel="noopener">component-base/json&lt;/a>ã€‚&lt;/p>
&lt;h2>ä½¿ç”¨ç©ºç»“æ„ä½“&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨ç©ºç»“æ„ä½“">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8%e7%a9%ba%e7%bb%93%e6%9e%84%e4%bd%93" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨ Go ä¸­ç©ºç»“æ„ä½“ &lt;code>struct{}&lt;/code> ä¸å æ®å†…å­˜ç©ºé—´ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;unsafe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">struct&lt;/span>&lt;span class="p">{}{}))&lt;/span> &lt;span class="c1">// 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç©ºç»“æ„ä½“ä¸å æ®å†…å­˜ç©ºé—´ï¼Œå› æ­¤è¢«å¹¿æ³›ä½œä¸ºå„ç§åœºæ™¯ä¸‹çš„å ä½ç¬¦ä½¿ç”¨ï¼Œå¯ä»¥èŠ‚çœèµ„æºã€‚&lt;/p>
&lt;h3>é›†åˆ Set&lt;span class="hx-absolute -hx-mt-20" id="é›†åˆ-set">&lt;/span>
&lt;a href="#%e9%9b%86%e5%90%88-set" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è¦å®ç°ä¸€ä¸ª &lt;code>Set&lt;/code>ï¼Œé€šå¸¸ä¼šä½¿ç”¨ &lt;code>map&lt;/code> æ¥å®ç°ï¼Œæ¯”å¦‚ &lt;code>map[string]bool&lt;/code>ã€‚ ä½†æ˜¯å¯¹äºé›†åˆæ¥è¯´ï¼Œ åªéœ€è¦ &lt;code>map&lt;/code> çš„é”®ï¼Œè€Œä¸éœ€è¦å€¼ã€‚å°†å€¼è®¾ç½®ä¸º &lt;code>bool&lt;/code>
ç±»å‹ï¼Œå°±ä¼šå¤šå æ® 1 ä¸ªå­—èŠ‚ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ç©ºç»“æ„ä½“ &lt;code>map[string]struct{}&lt;/code>ã€‚&lt;/p>
&lt;h3>channel é€šçŸ¥&lt;span class="hx-absolute -hx-mt-20" id="channel-é€šçŸ¥">&lt;/span>
&lt;a href="#channel-%e9%80%9a%e7%9f%a5" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æœ‰æ—¶å€™ä½¿ç”¨ &lt;code>channel&lt;/code> ä¸éœ€è¦å‘é€ä»»ä½•çš„æ•°æ®ï¼Œåªç”¨æ¥é€šçŸ¥ goroutine æ‰§è¡Œä»»åŠ¡ï¼Œæˆ–ç»“æŸç­‰ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ç©ºç»“æ„ä½“ã€‚&lt;/p>
&lt;h2>å†…å­˜å¯¹é½&lt;span class="hx-absolute -hx-mt-20" id="å†…å­˜å¯¹é½">&lt;/span>
&lt;a href="#%e5%86%85%e5%ad%98%e5%af%b9%e9%bd%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½ï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½">&lt;/span>
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e5%86%85%e5%ad%98%e5%af%b9%e9%bd%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>CPU è®¿é—®å†…å­˜æ—¶ï¼Œå¹¶ä¸æ˜¯é€ä¸ªå­—èŠ‚è®¿é—®ï¼Œè€Œæ˜¯ä»¥&lt;strong>å­—é•¿&lt;/strong>ï¼ˆword sizeï¼‰ä¸ºå•ä½è®¿é—®ã€‚æ¯”å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>64 ä½ç³»ç»Ÿ 1 ä¸ªå­—é•¿ç­‰äº 8 ä¸ªå­—èŠ‚&lt;/li>
&lt;li>32 ä½ç³»ç»Ÿ 1 ä¸ªå­—é•¿ç­‰äº 4 ä¸ªå­—èŠ‚&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤ CPU åœ¨è¯»å–å†…å­˜æ—¶æ˜¯ä¸€å—ä¸€å—è¿›è¡Œè¯»å–çš„ã€‚è¿™ä¹ˆè®¾è®¡çš„ç›®çš„ï¼Œæ˜¯å‡å°‘ CPU è®¿é—®å†…å­˜çš„æ¬¡æ•°ï¼ŒåŠ å¤§ CPU è®¿é—®å†…å­˜çš„ååé‡ã€‚æ¯”å¦‚åŒæ ·è¯»å– 8 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œä¸€
æ¬¡è¯»å– 4 ä¸ªå­—èŠ‚é‚£ä¹ˆåªéœ€è¦è¯»å– 2 æ¬¡ã€‚&lt;/p>
&lt;p>è¿›è¡Œå†…å­˜å¯¹é½ï¼Œå°±æ˜¯ä¸ºäº†å‡å°‘ CPU è®¿é—®å†…å­˜çš„æ¬¡æ•°ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/0a6f953f0387c30638ae8b0e03dda230194d10ab/go/mem-align.png" alt="mem-align" loading="lazy" />&lt;/p>
&lt;p>ä¸Šå›¾ä¸­ï¼Œå‡å¦‚ CPU å­—é•¿ä¸º 4 ä¸ªå­—èŠ‚ã€‚å˜é‡ a å’Œ b çš„å¤§å°ä¸º 3 ä¸ªå­—èŠ‚ï¼Œæ²¡æœ‰å†…å­˜å¯¹é½ä¹‹å‰ï¼ŒCPU è¯»å– b æ—¶ï¼Œéœ€è¦è®¿é—®ä¸¤æ¬¡å†…å­˜ï¼š&lt;/p>
&lt;ol>
&lt;li>ç¬¬ä¸€æ¬¡è¯»å– 0-3 å­—èŠ‚ï¼Œç§»é™¤ä¸éœ€è¦çš„ 0-2 å­—èŠ‚ï¼Œæ‹¿åˆ° b çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œ&lt;/li>
&lt;li>ç¬¬äºŒæ¬¡è¯»å– 4-7 å­—èŠ‚ï¼Œè¯»å–åˆ° b çš„åé¢ä¸¤ä¸ªå­—èŠ‚ï¼Œå¹¶ç§»é™¤ä¸éœ€è¦çš„ 6ï¼Œ7 å­—èŠ‚ã€‚&lt;/li>
&lt;li>åˆå¹¶ 4 ä¸ªå­—èŠ‚çš„æ•°æ®&lt;/li>
&lt;li>æ”¾å…¥å¯„å­˜å™¨&lt;/li>
&lt;/ol>
&lt;p>å†…å­˜å¯¹é½åï¼Œa å’Œ b éƒ½å æ®äº† 4 ä¸ªå­—èŠ‚ç©ºé—´ï¼ŒCPU è¯»å– b å°±åªéœ€è¦è®¿é—®ä¸€æ¬¡å†…å­˜ï¼Œè¯»å–åˆ° 4-7 å­—èŠ‚ã€‚&lt;/p>
&lt;h3>å¯¹é½ç³»æ•°&lt;span class="hx-absolute -hx-mt-20" id="å¯¹é½ç³»æ•°">&lt;/span>
&lt;a href="#%e5%af%b9%e9%bd%90%e7%b3%bb%e6%95%b0" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä¸åŒå¹³å°ä¸Šçš„ç¼–è¯‘å™¨éƒ½æœ‰è‡ªå·±é»˜è®¤çš„ â€œå¯¹é½ç³»æ•°â€ï¼Œå¸¸ç”¨çš„å¹³å°çš„ç³»æ•°å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>64 ä½ç³»ç»Ÿï¼š8&lt;/li>
&lt;li>32 ä½ç³»ç»Ÿï¼š4&lt;/li>
&lt;/ul>
&lt;p>&lt;code>unsafe&lt;/code> æ ‡å‡†åº“æä¾›äº† &lt;code>Alignof&lt;/code> æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªç±»å‹çš„å¯¹é½ç³»æ•°ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;bool align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">bool&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// bool align: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;int8 align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int8&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// int8 align: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;int16 align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int16&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// int16 align: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;int32 align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int32&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// int32 align: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;int64 align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// int64 align: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;byte align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">byte&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="c1">// byte align: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;string align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;EDDYCJY&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1">// string align: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;map align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">{}))&lt;/span> &lt;span class="c1">// map align: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>å¯¹é½è§„åˆ™&lt;span class="hx-absolute -hx-mt-20" id="å¯¹é½è§„åˆ™">&lt;/span>
&lt;a href="#%e5%af%b9%e9%bd%90%e8%a7%84%e5%88%99" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>å¯¹äºä»»æ„ç±»å‹çš„å˜é‡ &lt;code>x&lt;/code>ï¼Œ&lt;code>unsafe.Alignof(x)&lt;/code> è‡³å°‘ä¸º 1ã€‚&lt;/li>
&lt;li>å¯¹äº &lt;code>struct&lt;/code> ç»“æ„ä½“ç±»å‹çš„å˜é‡ &lt;code>x&lt;/code>ï¼Œè®¡ç®— &lt;code>x&lt;/code> æ¯ä¸€ä¸ªå­—æ®µ &lt;code>f&lt;/code> çš„ &lt;code>unsafe.Alignof(x.f)&lt;/code>ï¼Œ&lt;code>unsafe.Alignof(x)&lt;/code> ç­‰äºå…¶ä¸­çš„æœ€å¤§å€¼ã€‚&lt;/li>
&lt;li>å¯¹äº &lt;code>array&lt;/code> æ•°ç»„ç±»å‹çš„å˜é‡ &lt;code>x&lt;/code>ï¼Œ&lt;code>unsafe.Alignof(x)&lt;/code> ç­‰äºæ„æˆæ•°ç»„çš„å…ƒç´ ç±»å‹çš„å¯¹é½å€æ•°ã€‚&lt;/li>
&lt;/ol>
&lt;h3>Go ç»“æ„ä½“å†…å­˜å¯¹é½&lt;span class="hx-absolute -hx-mt-20" id="go-ç»“æ„ä½“å†…å­˜å¯¹é½">&lt;/span>
&lt;a href="#go-%e7%bb%93%e6%9e%84%e4%bd%93%e5%86%85%e5%ad%98%e5%af%b9%e9%bd%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>struct&lt;/code> ä¸­çš„å­—æ®µçš„é¡ºåºä¼šå¯¹ &lt;code>struct&lt;/code> çš„å¤§å°äº§ç”Ÿå½±å“å—ï¼Ÿ&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Part1&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="kt">int8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="kt">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="kt">int16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Part2&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="kt">int8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="kt">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="kt">int16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">part1&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">Part1&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;part1 size: %d, align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">part1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">part1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">part2&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">Part2&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;part2 size: %d, align: %d\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">part2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Alignof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">part2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å‡ºï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>// Output:
// part1 size: 8, align: 4
// part2 size: 12, align: 4&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>Part1&lt;/code> åªæ˜¯å¯¹æˆå‘˜å˜é‡çš„å­—æ®µé¡ºåºè¿›è¡Œäº†è°ƒæ•´ï¼Œå°±å‡å°‘äº†ç»“æ„ä½“å ç”¨å¤§å°ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/ca9f00e7c3f54f02935d6615da69123d09ee8c7c/go/struct-mem-align.png" alt="mem-align" loading="lazy" />&lt;/p>
&lt;p>&lt;code>part1&lt;/code>ï¼š&lt;/p>
&lt;ul>
&lt;li>a ä»ç¬¬ 0 ä¸ªä½ç½®å¼€å§‹å æ® 1 å­—èŠ‚ã€‚&lt;/li>
&lt;li>b å¯¹é½ç³»æ•°ä¸º 2ï¼Œå› æ­¤ï¼Œå¿…é¡»ç©ºå‡º 1 ä¸ªå­—èŠ‚ï¼Œåç§»é‡æ‰æ˜¯ 2 çš„å€æ•°ï¼Œä»ç¬¬ 2 ä¸ªä½ç½®å¼€å§‹å æ® 2 å­—èŠ‚ã€‚&lt;/li>
&lt;li>c å¯¹é½ç³»æ•°ä¸º 4ï¼Œæ­¤æ—¶ï¼Œå†…å­˜å·²ç»æ˜¯å¯¹é½çš„ï¼Œä»ç¬¬ 4 ä¸ªä½ç½®å¼€å§‹å æ® 4 å­—èŠ‚å³å¯ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;code>part2&lt;/code>ï¼š&lt;/p>
&lt;ul>
&lt;li>a ä»ç¬¬ 0 ä¸ªä½ç½®å¼€å§‹å æ® 1 å­—èŠ‚ã€‚&lt;/li>
&lt;li>c å¯¹é½ç³»æ•°ä¸º 4ï¼Œå› æ­¤ï¼Œå¿…é¡»ç©ºå‡º 3 ä¸ªå­—èŠ‚ï¼Œåç§»é‡æ‰æ˜¯ 4 çš„å€æ•°ï¼Œä»ç¬¬ 4 ä¸ªä½ç½®å¼€å§‹å æ® 4 å­—èŠ‚ã€‚&lt;/li>
&lt;li>b å¯¹é½ç³»æ•°ä¸º 2ï¼Œä»ç¬¬ 8 ä¸ªä½ç½®å¼€å§‹å æ® 2 å­—èŠ‚ã€‚&lt;/li>
&lt;/ul>
&lt;h3>ç©º &lt;code>struct{}&lt;/code> çš„å¯¹é½&lt;span class="hx-absolute -hx-mt-20" id="ç©º-struct-çš„å¯¹é½">&lt;/span>
&lt;a href="#%e7%a9%ba-struct-%e7%9a%84%e5%af%b9%e9%bd%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ç©º &lt;code>struct{}&lt;/code> å¤§å°ä¸º 0ï¼Œä½œä¸ºå…¶ä»– struct çš„å­—æ®µæ—¶ï¼Œä¸€èˆ¬ä¸éœ€è¦å†…å­˜å¯¹é½ã€‚ä½†æ˜¯å½“ &lt;code>struct{}&lt;/code> ä½œä¸ºç»“æ„ä½“æœ€åä¸€ä¸ªå­—æ®µæ—¶ï¼Œéœ€è¦å†…å­˜å¯¹é½ã€‚
å› ä¸ºå¦‚æœæœ‰æŒ‡é’ˆæŒ‡å‘è¯¥å­—æ®µ, è¿”å›çš„åœ°å€å°†åœ¨ç»“æ„ä½“ä¹‹å¤–ï¼Œå¦‚æœæ­¤æŒ‡é’ˆä¸€ç›´å­˜æ´»ä¸é‡Šæ”¾å¯¹åº”çš„å†…å­˜ï¼Œå°±ä¼šæœ‰å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼ˆè¯¥å†…å­˜ä¸å› ç»“æ„ä½“é‡Šæ”¾è€Œé‡Šæ”¾ï¼‰ã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œå½“ &lt;code>struct{}&lt;/code> ä½œä¸ºå…¶ä»– &lt;code>struct&lt;/code> æœ€åä¸€ä¸ªå­—æ®µæ—¶ï¼Œéœ€è¦å¡«å……é¢å¤–çš„å†…å­˜ä¿è¯å®‰å…¨ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Part1&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="kt">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Part2&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="kt">int32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Part1&lt;/span>&lt;span class="p">{}))&lt;/span> &lt;span class="c1">// 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">Part2&lt;/span>&lt;span class="p">{}))&lt;/span> &lt;span class="c1">// 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥çœ‹åˆ° &lt;code>Part1{&lt;/code>} é¢å¤–å¡«å……äº† 4 å­—èŠ‚çš„ç©ºé—´ã€‚&lt;/p>
&lt;h2>é€ƒé€¸åˆ†æ&lt;span class="hx-absolute -hx-mt-20" id="é€ƒé€¸åˆ†æ">&lt;/span>
&lt;a href="#%e9%80%83%e9%80%b8%e5%88%86%e6%9e%90" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>ç¼–è¯‘å™¨å†³å®šå†…å­˜åˆ†é…ä½ç½®çš„æ–¹å¼ï¼Œå°±ç§°ä¹‹ä¸º&lt;strong>é€ƒé€¸åˆ†æ&lt;/strong>(escape analysis)ã€‚é€ƒé€¸åˆ†æç”±ç¼–è¯‘å™¨å®Œæˆï¼Œä½œç”¨äºç¼–è¯‘é˜¶æ®µã€‚&lt;/p>
&lt;p>å˜é‡é€ƒé€¸æ˜¯æŒ‡ç¼–è¯‘å™¨å°†ä¸€ä¸ªå˜é‡ä»æ ˆä¸Šåˆ†é…åˆ°å¯¹ä¸Šçš„æƒ…å†µã€‚&lt;/p>
&lt;p>åœ¨ Go ä¸­ï¼Œæ ˆæ˜¯è·Ÿå‡½æ•°ç»‘å®šçš„ï¼Œå‡½æ•°ç»“æŸæ—¶æ ˆè¢«å›æ”¶ã€‚å¦‚æœä¸€ä¸ªå˜é‡åˆ†é…åœ¨æ ˆä¸­ï¼Œåˆ™å‡½æ•°æ‰§è¡Œç»“æŸå¯è‡ªåŠ¨å°†å†…å­˜å›æ”¶ã€‚å¦‚æœåˆ†é…åœ¨å †ä¸­ï¼Œåˆ™å‡½æ•°æ‰§è¡Œç»“æŸå¯äº¤ç»™ GCï¼ˆåƒåœ¾å›æ”¶ï¼‰å¤„ç†ã€‚&lt;/p>
&lt;p>å˜é‡é€ƒé€¸å¸¸è§çš„æƒ…å†µï¼š&lt;/p>
&lt;ol>
&lt;li>æŒ‡é’ˆé€ƒé€¸ï¼šè¿”å›æŒ‡é’ˆï¼Œå½“ä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ—¶ï¼Œç¼–è¯‘å™¨å°±ä¸å¾—ä¸å§è¯¥å˜é‡åˆ†é…åˆ°å †ä¸Šï¼Œä»¥ä¾¿å‡½æ•°è¿”å›åè¿˜å¯ä»¥è®¿é—®å®ƒã€‚&lt;/li>
&lt;li>å‘é€æŒ‡é’ˆæˆ–å¸¦æœ‰æŒ‡é’ˆçš„å€¼åˆ° channel ä¸­ï¼Œç¼–è¯‘æ—¶ï¼Œæ˜¯æ²¡æœ‰åŠæ³•çŸ¥é“å“ªä¸ª goroutine ä¼šåœ¨ channel ä¸Šæ¥æ”¶æ•°æ®ã€‚æ‰€ä»¥ç¼–è¯‘å™¨æ²¡æ³•çŸ¥é“å˜é‡ä»€ä¹ˆæ—¶å€™æ‰ä¼šè¢«é‡Šæ”¾ã€‚è¯¥å€¼å°±ä¼šè¢«åˆ†é…åˆ°å †ä¸Šã€‚&lt;/li>
&lt;li>åœ¨ä¸€ä¸ªåˆ‡ç‰‡ä¸Šå­˜å‚¨æŒ‡é’ˆæˆ–å¸¦æŒ‡é’ˆçš„å€¼ã€‚ä¾‹å¦‚ &lt;code>[]*string&lt;/code> ã€‚è¿™ä¼šå¯¼è‡´åˆ‡ç‰‡çš„å†…å®¹é€ƒé€¸ã€‚å°½ç®¡å…¶åé¢çš„æ•°ç»„å¯èƒ½æ˜¯åœ¨æ ˆä¸Šåˆ†é…çš„ï¼Œä½†å…¶å¼•ç”¨çš„å€¼ä¸€å®šæ˜¯åœ¨å †ä¸Šã€‚&lt;/li>
&lt;li>åˆ‡ç‰‡çš„åº•å±‚æ•°ç»„è¢«é‡æ–°åˆ†é…äº†ï¼Œå› ä¸º append æ—¶å¯èƒ½ä¼šè¶…å‡ºå…¶å®¹é‡ã€‚åˆ‡ç‰‡åˆå§‹åŒ–çš„åœ°æ–¹åœ¨ç¼–è¯‘æ—¶æ˜¯å¯ä»¥çŸ¥é“çš„ï¼Œå®ƒæœ€å¼€å§‹ä¼šåœ¨æ ˆä¸Šåˆ†é…ã€‚å¦‚æœåˆ‡ç‰‡èƒŒåçš„å­˜å‚¨è¦åŸºäºè¿è¡Œæ—¶çš„æ•°æ®è¿›è¡Œæ‰©å……ï¼Œå°±ä¼šåœ¨å †ä¸Šåˆ†é…ã€‚&lt;/li>
&lt;li>åœ¨ &lt;code>interface&lt;/code> ç±»å‹ä¸Šè°ƒç”¨æ–¹æ³•éƒ½æ˜¯&lt;strong>åŠ¨æ€è°ƒåº¦&lt;/strong>çš„ï¼Œæ–¹æ³•çš„å®ç°åªèƒ½åœ¨è¿è¡Œæ—¶æ‰çŸ¥é“ã€‚æ¯”å¦‚ &lt;code>io.Reader&lt;/code> ç±»å‹çš„å˜é‡ &lt;code>r&lt;/code>ï¼Œè°ƒç”¨ &lt;code>r.Read(b)&lt;/code> ä¼šä½¿ &lt;code>r&lt;/code> çš„å€¼å’Œåˆ‡ç‰‡ &lt;code>b&lt;/code> çš„åº•å±‚æ•°ç»„éƒ½é€ƒé€¸æ‰ï¼Œåœ¨å †ä¸Šåˆ†é…ã€‚&lt;/li>
&lt;li>æ•°æ®ç±»å‹ä¸ç¡®å®šï¼Œå¦‚è°ƒç”¨ &lt;code>fmt.Sprintf&lt;/code>ï¼Œ&lt;code>json.Marshal&lt;/code> ç­‰æ¥å—å˜é‡ä¸º &lt;code>...interface{}&lt;/code> çš„å‡½æ•°ï¼Œä¼šå¯¼è‡´ä¼ å…¥çš„å˜é‡é€ƒé€¸åˆ°å †ä¸Šã€‚&lt;/li>
&lt;li>é—­åŒ…å¼•ç”¨ï¼šå¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡è¢«ä¸€ä¸ªé—­åŒ…å‡½æ•°å¼•ç”¨ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¹Ÿå¯èƒ½æŠŠå®ƒåˆ†é…åˆ°å †ä¸Šï¼Œç¡®ä¿é—­åŒ…å¯ä»¥ç»§ç»­è®¿é—®å®ƒã€‚
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">isaclosure&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>æ ˆç©ºé—´ä¸è¶³&lt;/li>
&lt;/ol>
&lt;p>å˜é‡é€ƒé€¸å°±æ„å‘³ç€å¢åŠ äº†å †ä¸­çš„å¯¹è±¡ä¸ªæ•°ï¼Œå½±å“ GC è€—æ—¶ï¼Œå½±å“æ€§èƒ½ã€‚æ‰€ä»¥ç¼–å†™ä»£ç æ—¶ï¼Œé¿å…è¿”å›æŒ‡é’ˆï¼Œé™åˆ¶é—­åŒ…çš„ä½œç”¨èŒƒå›´ç­‰æ¥è¦å°½é‡é¿å…é€ƒé€¸ã€‚&lt;/p>
&lt;p>å¯ä»¥ä½¿ç”¨ç¼–è¯‘å™¨çš„ &lt;code>gcflags=&amp;quot;-m&amp;quot;&lt;/code> æ¥æŸ¥çœ‹å˜é‡é€ƒé€¸çš„æƒ…å†µï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">A&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// åœ¨æ–¹æ³•å†…è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">foo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">A&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">A&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="c1">// a ä¼šé€ƒé€¸åˆ°å †ä¸Š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">a&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">foo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34; world&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// c æ•°æ®ç±»å‹ä¸ç¡®å®šï¼Œæ‰€ä»¥ escapes to heap
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¿è¡Œ &lt;code>go run -gcflags=-m ./main.go&lt;/code> ä¼šå¾—åˆ°ä¸‹é¢ç±»ä¼¼çš„è¾“å‡ºï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># command-line-arguments
./main.go:10:6: can inline foo
./main.go:17:10: inlining call to foo
./main.go:20:13: inlining call to fmt.Println
./main.go:10:10: leaking param: s
./main.go:11:10: new(A) escapes to heap
./main.go:17:10: new(A) does not escape
./main.go:18:11: a.s &amp;#43; &amp;#34; world&amp;#34; does not escape
./main.go:19:9: b &amp;#43; &amp;#34;!&amp;#34; escapes to heap
./main.go:20:13: c escapes to heap
./main.go:20:13: []interface {} literal does not escape
&amp;lt;autogenerated&amp;gt;:1: .this does not escape
&amp;lt;autogenerated&amp;gt;:1: .this does not escape
hello world!&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ä¼ å€¼è¿˜æ˜¯ä¼ æŒ‡é’ˆï¼Ÿ&lt;span class="hx-absolute -hx-mt-20" id="ä¼ å€¼è¿˜æ˜¯ä¼ æŒ‡é’ˆ">&lt;/span>
&lt;a href="#%e4%bc%a0%e5%80%bc%e8%bf%98%e6%98%af%e4%bc%a0%e6%8c%87%e9%92%88" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä¼ å€¼ä¼šæ‹·è´æ•´ä¸ªå¯¹è±¡ï¼Œè€Œä¼ æŒ‡é’ˆåªä¼šæ‹·è´æŒ‡é’ˆåœ°å€ï¼ŒæŒ‡å‘çš„å¯¹è±¡æ˜¯åŒä¸€ä¸ªã€‚ä¼ æŒ‡é’ˆå¯ä»¥å‡å°‘å€¼çš„æ‹·è´ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å†…å­˜åˆ†é…é€ƒé€¸åˆ°å †ä¸­ï¼Œå¢åŠ åƒåœ¾å›æ”¶(GC)çš„è´Ÿæ‹…ã€‚åœ¨å¯¹
è±¡é¢‘ç¹åˆ›å»ºå’Œåˆ é™¤çš„åœºæ™¯ä¸‹ï¼Œä¼ é€’æŒ‡é’ˆå¯¼è‡´çš„ GC å¼€é”€å¯èƒ½ä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚&lt;/p>
&lt;p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹äºéœ€è¦ä¿®æ”¹åŸå¯¹è±¡å€¼ï¼Œæˆ–å ç”¨å†…å­˜æ¯”è¾ƒå¤§çš„ç»“æ„ä½“ï¼Œé€‰æ‹©ä¼ æŒ‡é’ˆã€‚å¯¹äºåªè¯»çš„å ç”¨å†…å­˜è¾ƒå°çš„ç»“æ„ä½“ï¼Œç›´æ¥ä¼ å€¼èƒ½å¤Ÿè·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚&lt;/p>
&lt;h2>æ­»ç æ¶ˆé™¤&lt;span class="hx-absolute -hx-mt-20" id="æ­»ç æ¶ˆé™¤">&lt;/span>
&lt;a href="#%e6%ad%bb%e7%a0%81%e6%b6%88%e9%99%a4" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>æ­»ç æ¶ˆé™¤(dead code elimination, DCE)æ˜¯ä¸€ç§ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ï¼Œç”¨å¤„æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå»æ‰å¯¹ç¨‹åºè¿è¡Œç»“æœæ²¡æœ‰ä»»ä½•å½±å“çš„ä»£ç ã€‚&lt;/p>
&lt;p>æ­»ç æ¶ˆé™¤å¯ä»¥å‡å°ç¨‹åºä½“ç§¯ï¼Œç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­é¿å…æ‰§è¡Œæ— ç”¨çš„æŒ‡ä»¤ï¼Œç¼©çŸ­è¿è¡Œæ—¶é—´ã€‚&lt;/p>
&lt;h3>ä½¿ç”¨å¸¸é‡æå‡æ€§èƒ½&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨å¸¸é‡æå‡æ€§èƒ½">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8%e5%b8%b8%e9%87%8f%e6%8f%90%e5%8d%87%e6%80%a7%e8%83%bd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>æœ‰äº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨å¸¸é‡ä¸ä»…å¯ä»¥å‡å°‘ç¨‹åºçš„ä½“ç§¯ï¼Œæ€§èƒ½ä¹Ÿä¼šæœ‰å¾ˆå¤§çš„æå‡ã€‚&lt;/p>
&lt;p>&lt;code>usevar.go&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">num1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">num2&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">num1&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">num2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">num1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">num2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nf">Max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>useconst.go&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">num1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">num2&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">num1&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">num2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">num1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">num2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">const&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nf">Max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶ç¼–è¯‘åçš„æ–‡ä»¶å¤§å°ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ ls -lh
-rwxr-xr-x 1 pshi2 1049089 1.9M Oct 24 13:45 usevar.exe
-rwxr-xr-x 1 pshi2 1049089 1.5M Oct 24 13:44 useconst.exe&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åªæ˜¯ä½¿ç”¨äº†å¸¸é‡ä»£æ›¿å˜é‡ï¼Œä¸¤ä¸ªæ–‡ä»¶çš„å¤§å°å°±ç›¸å·® 0.3 Mï¼Œä¸ºä»€ä¹ˆï¼Ÿ&lt;/p>
&lt;p>ä½¿ç”¨ &lt;code>-gcflags=-m&lt;/code> å‚æ•°å¯ä»¥æŸ¥çœ‹ç¼–è¯‘å™¨åšäº†å“ªäº›ä¼˜åŒ–ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go build -gcflags=-m ./useconst.go
# command-line-arguments
./main.go:5:6: can inline Max
./main.go:15:8: inlining call to Max
./main.go:16:14: inlining call to fmt.Println
./main.go:16:14: ... argument does not escape
./main.go:16:15: a escapes to heap&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>Max&lt;/code> å‡½æ•°è¢«å†…è”äº†ï¼Œå†…è”åçš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç”±äº a å’Œ b å‡ä¸ºå¸¸é‡ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µä¼šç›´æ¥è®¡ç®—ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="mi">20&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">result&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>10 &amp;gt; 20&lt;/code> æ°¸è¿œä¸ºå‡ï¼Œé‚£ä¹ˆåˆ†æ”¯æ¶ˆé™¤ï¼Œ&lt;code>result&lt;/code> æ°¸è¿œç­‰äº 20ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="mi">20&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">10&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>20 == 10&lt;/code> ä¹Ÿæ°¸è¿œä¸ºå‡ï¼Œå†æ¬¡æ¶ˆé™¤åˆ†æ”¯ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä½†æ˜¯å¯¹äºå˜é‡ a å’Œ bï¼Œç¼–è¯‘å™¨å¹¶ä¸çŸ¥é“è¿è¡Œè¿‡ç¨‹ä¸­ aã€b ä¼šä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤ä¸èƒ½å¤Ÿè¿›è¡Œæ­»ç æ¶ˆé™¤ï¼Œè¿™éƒ¨åˆ†ä»£ç è¢«ç¼–è¯‘åˆ°æœ€ç»ˆçš„äºŒè¿›åˆ¶ç¨‹åºä¸­ã€‚å› æ­¤ç¼–è¯‘åçš„äºŒè¿›åˆ¶ç¨‹åºä½“ç§¯å¤§äº† 0.3 Mã€‚&lt;/p>
&lt;p>å› æ­¤ï¼Œ&lt;strong>åœ¨å£°æ˜å…¨å±€å˜é‡æ—¶ï¼Œå¦‚æœèƒ½å¤Ÿç¡®å®šä¸ºå¸¸é‡ï¼Œå°½é‡ä½¿ç”¨ &lt;code>const&lt;/code> è€Œé &lt;code>var&lt;/code>&lt;/strong>ã€‚è¿™æ ·å¾ˆå¤šè¿ç®—åœ¨ç¼–è¯‘å™¨å³å¯æ‰§è¡Œã€‚æ­»ç æ¶ˆé™¤åï¼Œæ—¢å‡å°äº†äºŒè¿›åˆ¶çš„ä½“ç§¯ï¼Œåˆå¯ä»¥æé«˜è¿è¡Œæ—¶çš„æ•ˆç‡ã€‚&lt;/p>
&lt;h3>å¯æ¨æ–­çš„å±€éƒ¨å˜é‡&lt;span class="hx-absolute -hx-mt-20" id="å¯æ¨æ–­çš„å±€éƒ¨å˜é‡">&lt;/span>
&lt;a href="#%e5%8f%af%e6%8e%a8%e6%96%ad%e7%9a%84%e5%b1%80%e9%83%a8%e5%8f%98%e9%87%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Go ç¼–è¯‘å™¨åªå¯¹å‡½æ•°çš„å±€éƒ¨å˜é‡åšäº†ä¼˜åŒ–ï¼Œå½“å¯ä»¥æ¨æ–­å‡ºå‡½æ•°çš„å±€éƒ¨å˜é‡çš„å€¼æ—¶ï¼Œæ­»ç æ¶ˆé™¤ä»ç„¶ä¼šç”Ÿæ•ˆï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„ä»£ç ä¸ &lt;code>useconst.go&lt;/code> çš„ç¼–è¯‘ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯ä»¥æ¨æ–­å‡º aã€b å˜é‡çš„å€¼ã€‚&lt;/p>
&lt;p>å¦‚æœå¢åŠ äº†å¹¶å‘æ“ä½œï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">b&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„ä»£ç ï¼Œaã€b çš„å€¼ä¸èƒ½æœ‰æ•ˆæ¨æ–­ï¼Œæ­»ç æ¶ˆé™¤å¤±æ•ˆã€‚&lt;/p>
&lt;p>åŒ…çº§åˆ«çš„å˜é‡æ¨æ–­éš¾åº¦æ˜¯éå¸¸å¤§çš„ã€‚å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡çš„ä¿®æ”¹åªä¼šå‘ç”Ÿåœ¨è¯¥å‡½æ•°ä¸­ã€‚ä½†æ˜¯å¦‚æœæ˜¯åŒ…çº§åˆ«çš„å˜é‡ï¼Œå¯¹è¯¥å˜é‡çš„ä¿®æ”¹å¯èƒ½å‡ºç°åœ¨ï¼š&lt;/p>
&lt;ul>
&lt;li>åŒ…åˆå§‹åŒ–å‡½æ•° &lt;code>init()&lt;/code> ä¸­ï¼Œ&lt;code>init()&lt;/code> å‡½æ•°å¯èƒ½æœ‰å¤šä¸ªï¼Œä¸”å¯èƒ½ä½äºä¸åŒçš„ &lt;code>.go&lt;/code> æºæ–‡ä»¶ã€‚&lt;/li>
&lt;li>åŒ…å†…çš„å…¶ä»–å‡½æ•°ã€‚&lt;/li>
&lt;li>å¦‚æœæ˜¯ public å˜é‡ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå…¶ä»–åŒ…å¼•ç”¨æ—¶å¯ä¿®æ”¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>å› æ­¤ï¼ŒGo ç¼–è¯‘å™¨åªå¯¹å±€éƒ¨å˜é‡ä½œäº†ä¼˜åŒ–ã€‚&lt;/p>
&lt;h2>åˆ©ç”¨ sync.Pool å‡å°‘å †åˆ†é…&lt;span class="hx-absolute -hx-mt-20" id="åˆ©ç”¨-syncpool-å‡å°‘å †åˆ†é…">&lt;/span>
&lt;a href="#%e5%88%a9%e7%94%a8-syncpool-%e5%87%8f%e5%b0%91%e5%a0%86%e5%88%86%e9%85%8d" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://shipengqi.github.io/golang-learn/golang-learn/docs/concurrency/06_pool/" >sync.Pool ä½¿ç”¨&lt;/a>ã€‚&lt;/p>
&lt;h2>æ§åˆ¶ goroutine çš„å¹¶å‘æ•°é‡&lt;span class="hx-absolute -hx-mt-20" id="æ§åˆ¶-goroutine-çš„å¹¶å‘æ•°é‡">&lt;/span>
&lt;a href="#%e6%8e%a7%e5%88%b6-goroutine-%e7%9a%84%e5%b9%b6%e5%8f%91%e6%95%b0%e9%87%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åŸºäº GPM çš„ Go è°ƒåº¦å™¨ï¼Œå¯ä»¥å¤§è§„æ¨¡çš„åˆ›å»º goroutine æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¯èƒ½ 1kï¼Œ1w ä¸ª goroutine æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“ goroutine éå¸¸å¤§æ—¶ï¼Œæ¯”å¦‚ 10wï¼Œ100w ç”šè‡³æ›´å¤š
å°±ä¼šå‡ºç°é—®é¢˜ã€‚&lt;/p>
&lt;ol>
&lt;li>å³ä½¿æ¯ä¸ª goroutine åªåˆ†é… 2KB çš„å†…å­˜ï¼Œä½†æ˜¯æ•°é‡å¤ªå¤šä¼šå¯¼è‡´å†…å­˜å ç”¨æš´æ¶¨ï¼Œå¯¹ GC é€ æˆæå¤§çš„å‹åŠ›ï¼ŒGC æ˜¯æœ‰ STW æœºåˆ¶çš„ï¼Œè¿è¡Œæ—¶ä¼šæŒ‚èµ·ç”¨æˆ·ç¨‹åºç›´åˆ°åƒåœ¾å›æ”¶å®Œã€‚è™½ç„¶ Go 1.8 å»æ‰äº† STW ä»¥åŠæ”¹æˆäº†å¹¶è¡Œ GCï¼Œæ€§èƒ½ä¸Šæœ‰äº†ä¸
å°çš„æå‡ä½†æ˜¯ï¼Œå¦‚æœå¤ªè¿‡äºé¢‘ç¹åœ°è¿›è¡Œ GCï¼Œä¾ç„¶ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆã€‚&lt;/li>
&lt;li>runtime å’Œ GC ä¹Ÿéƒ½æ˜¯ goroutineï¼Œå¦‚æœ goroutine è§„æ¨¡å¤ªå¤§ï¼Œå†…å­˜åƒç´§ï¼ŒGo è°ƒåº¦å™¨å°±ä¼šé˜»å¡ goroutineï¼Œè¿›è€Œå¯¼è‡´å†…å­˜æº¢å‡ºï¼Œç”šè‡³ crashã€‚&lt;/li>
&lt;/ol>
&lt;h3>åˆ©ç”¨ channel çš„ç¼“å­˜åŒºæ§åˆ¶å¹¶å‘æ•°é‡&lt;span class="hx-absolute -hx-mt-20" id="åˆ©ç”¨-channel-çš„ç¼“å­˜åŒºæ§åˆ¶å¹¶å‘æ•°é‡">&lt;/span>
&lt;a href="#%e5%88%a9%e7%94%a8-channel-%e7%9a%84%e7%bc%93%e5%ad%98%e5%8c%ba%e6%8e%a7%e5%88%b6%e5%b9%b6%e5%8f%91%e6%95%b0%e9%87%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">wg&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WaitGroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆ›å»ºç¼“å†²åŒºå¤§å°ä¸º 3 çš„ channel
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">ch&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{},&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¦‚æœç¼“å­˜åŒºæ»¡äº†ï¼Œåˆ™ä¼šé˜»å¡åœ¨è¿™é‡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">ch&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">go&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Done&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// é‡Šæ”¾ç¼“å†²åŒº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>&lt;span class="nx">ch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Wait&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ä½¿ç”¨ç¬¬ä¸‰æ–¹ goroutine pool&lt;span class="hx-absolute -hx-mt-20" id="ä½¿ç”¨ç¬¬ä¸‰æ–¹-goroutine-pool">&lt;/span>
&lt;a href="#%e4%bd%bf%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9-goroutine-pool" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ goroutine poolï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/panjf2000/ants" target="_blank" rel="noopener">ants&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/sourcegraph/conc" target="_blank" rel="noopener">conc&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2>é›¶æ‹·è´ä¼˜åŒ–&lt;span class="hx-absolute -hx-mt-20" id="é›¶æ‹·è´ä¼˜åŒ–">&lt;/span>
&lt;a href="#%e9%9b%b6%e6%8b%b7%e8%b4%9d%e4%bc%98%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>ä¼˜åŒ–å­—ç¬¦ä¸²ä¸ []byte è½¬æ¢ï¼Œå‡å°‘å†…å­˜åˆ†é…&lt;span class="hx-absolute -hx-mt-20" id="ä¼˜åŒ–å­—ç¬¦ä¸²ä¸-byte-è½¬æ¢å‡å°‘å†…å­˜åˆ†é…">&lt;/span>
&lt;a href="#%e4%bc%98%e5%8c%96%e5%ad%97%e7%ac%a6%e4%b8%b2%e4%b8%8e-byte-%e8%bd%ac%e6%8d%a2%e5%87%8f%e5%b0%91%e5%86%85%e5%ad%98%e5%88%86%e9%85%8d" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åœ¨å¼€å‘ä¸­ï¼Œå­—ç¬¦ä¸²ä¸ &lt;code>[]byte&lt;/code> ç›¸äº’è½¬æ¢æ˜¯ç»å¸¸ç”¨åˆ°çš„ã€‚ç›´æ¥é€šè¿‡ç±»å‹è½¬æ¢ &lt;code>string(bytes)&lt;/code> æˆ–è€… &lt;code>[]byte(str)&lt;/code> ä¼šå¸¦æ¥æ•°æ®çš„å¤åˆ¶ï¼Œæ€§èƒ½ä¸ä½³ã€‚&lt;/p>
&lt;p>åœ¨ Go 1.20 ä¹‹å‰çš„ç‰ˆæœ¬å¯ä»¥é‡‡ç”¨ä¸‹é¢çš„æ–¹å¼æ¥ä¼˜åŒ–ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// B2S convert []byte to string.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">B2S&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pointer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// S2B convert string to []byte.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">S2B&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bh&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">SliceHeader&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pointer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sh&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">reflect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StringHeader&lt;/span>&lt;span class="p">)(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Pointer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Data&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">sh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Cap&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">sh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Len&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">bh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Len&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">sh&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Len&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">b&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Go 1.20 æä¾›äº†æ–°çš„æ–¹å¼ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// B2S convert []byte to string.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">B2S&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">SliceData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// S2B convert string to []byte.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">S2B&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">unsafe&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>è®¾ç½® GOMAXPROCS&lt;span class="hx-absolute -hx-mt-20" id="è®¾ç½®-gomaxprocs">&lt;/span>
&lt;a href="#%e8%ae%be%e7%bd%ae-gomaxprocs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>GOMAXPROCS&lt;/code> æ˜¯ Go æä¾›çš„ä¸€ä¸ªéå¸¸é‡è¦çš„ç¯å¢ƒå˜é‡ã€‚è®¾ç½®å®ƒçš„å€¼å¯ä»¥è°ƒæ•´è°ƒåº¦å™¨ Processor çš„æ•°é‡ï¼Œæ¯ä¸ª Processor éƒ½ä¼šç»‘å®šä¸€ä¸ªç³»ç»Ÿçº¿ç¨‹ã€‚æ‰€ä»¥ Processor çš„æ•°é‡ï¼Œä¼šå½±å“ Go çš„å¹¶å‘æ€§èƒ½ã€‚&lt;/p>
&lt;p>Go 1.5 ç‰ˆæœ¬ä»¥åï¼Œ&lt;code>GOMAXPROCS&lt;/code> çš„é»˜è®¤å€¼æ˜¯æœºå™¨çš„ CPU æ ¸æ•°ï¼ˆ&lt;code>runtime.NumCPU()&lt;/code> çš„è¿”å›å€¼ï¼‰ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ &lt;code>runtime.NumCPU()&lt;/code> åœ¨å®¹å™¨ä¸­æ˜¯æ— æ³•è·å–æ­£ç¡®çš„ CPU æ ¸æ•°çš„ï¼Œå› ä¸ºå®¹å™¨æ˜¯ä½¿ç”¨ &lt;code>cgroup&lt;/code> æŠ€æœ¯å¯¹ CPU èµ„æºè¿›è¡Œéš”ç¦»é™åˆ¶çš„ï¼Œä½† &lt;code>runtime.NumCPU()&lt;/code> è·å–çš„å´æ˜¯&lt;strong>å®¿ä¸»æœºçš„ CPU æ ¸æ•°&lt;/strong>ã€‚
ä¾‹å¦‚ä¸€ä¸ª Kubernetes é›†ç¾¤ä¸­ Node æ ¸æ•°æ˜¯ 36ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª Podï¼Œå¹¶ä¸”é™åˆ¶ Pod çš„ CPU æ ¸æ•°æ˜¯ 1ã€‚Pod ä¸­çš„è¿›ç¨‹åœ¨è®¾ç½® &lt;code>GOMAXPROCS&lt;/code> åï¼Œçº¿ç¨‹æ•°é‡æ˜¯ 36ã€‚å¯¼è‡´çº¿ç¨‹è¿‡å¤šï¼Œçº¿ç¨‹é¢‘ç¹åˆ‡æ¢ï¼Œå¢åŠ ä¸Šçº¿æ–‡åˆ‡æ¢çš„è´Ÿæ‹…ã€‚&lt;/p>
&lt;p>Uber æä¾›äº†ä¸€ä¸ªåº“ &lt;code>go.uber.org/automaxprocs&lt;/code> å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span> &lt;span class="s">&amp;#34;go.uber.org/automaxprocs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div></description></item><item><title>Go Core Dump è°ƒè¯•</title><link>https://shipengqi.github.io/golang-learn/docs/practice/07_coredump/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/07_coredump/</guid><description>
&lt;p>Go ä¹Ÿå¯ä»¥å¼€å¯ç±»ä¼¼ C++ Core Dump åŠŸèƒ½ï¼ŒCore Dump æ˜¯ç¨‹åºå´©æºƒæ—¶çš„å†…å­˜å¿«ç…§ã€‚ç¨‹åºå´©æºƒæ—¶ï¼Œå¯ä»¥å¸®åŠ©å®šä½ crash å‘ç”Ÿçš„åŸå› ã€‚&lt;/p>
&lt;h2>å¼€å¯ Core Dump åŠŸèƒ½&lt;span class="hx-absolute -hx-mt-20" id="å¼€å¯-core-dump-åŠŸèƒ½">&lt;/span>
&lt;a href="#%e5%bc%80%e5%90%af-core-dump-%e5%8a%9f%e8%83%bd" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>åœ¨ Linux ä¸­ï¼Œå¯ä»¥é€šè¿‡ &lt;code>ulimit -c&lt;/code> æŸ¥çœ‹ Core Dump åŠŸèƒ½æ˜¯å¦å¼€å¯ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ ulimit -c
0&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å‡ºä¸º 0ï¼Œè¡¨ç¤ºæœªå¼€å¯ã€‚&lt;/p>
&lt;p>ä½¿ç”¨ &lt;code>ulimit -c [size]&lt;/code> æ¥æŒ‡å®š core dump æ–‡ä»¶çš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯å¼€å¯ Core Dumpã€‚&lt;code>ulimit -c unlimited&lt;/code> è¡¨ç¤ºä¸é™åˆ¶ core dump æ–‡ä»¶çš„å¤§å°ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤æ˜¯å°† core dump æ–‡ä»¶å¤§å°è®¾ç½®ä¸º &lt;code>1MB&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ ulimit -c 1048576&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>å¦‚ä½•ç”Ÿæˆ Core Dump æ–‡ä»¶&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•ç”Ÿæˆ-core-dump-æ–‡ä»¶">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e7%94%9f%e6%88%90-core-dump-%e6%96%87%e4%bb%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go æä¾›çš„ç¯å¢ƒå˜é‡ &lt;code>GOTRACEBACK&lt;/code> å¯ä»¥ç”¨æ¥æ§åˆ¶ç¨‹åºå´©æºƒæ—¶è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ã€‚å¯é€‰å€¼æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>none&lt;/code>ï¼šä¸æ˜¾ç¤ºä»»ä½• goroutine çš„å †æ ˆä¿¡æ¯ã€‚&lt;/li>
&lt;li>&lt;code>single&lt;/code>ï¼šé»˜è®¤é€‰é¡¹ï¼Œæ˜¾ç¤ºå½“å‰ goroutine çš„å †æ ˆä¿¡æ¯ã€‚&lt;/li>
&lt;li>&lt;code>all&lt;/code>ï¼šæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·åˆ›å»ºçš„ goroutine çš„å †æ ˆä¿¡æ¯ã€‚&lt;/li>
&lt;li>&lt;code>system&lt;/code>ï¼šæ˜¾ç¤ºæ‰€æœ‰ goroutine çš„å †æ ˆä¿¡æ¯ï¼ŒåŒ…æ‹¬ runtimeã€‚&lt;/li>
&lt;li>&lt;code>crash&lt;/code>ï¼šä½œç”¨å’Œ &lt;code>system&lt;/code> ä¸€æ ·, ä½†æ˜¯ä¼šç”Ÿæˆ core dump æ–‡ä»¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥è®¾ç½® &lt;code>export GOTRACEBACK=crash&lt;/code> æ¥ç”Ÿæˆ core dump æ–‡ä»¶ã€‚&lt;/p>
&lt;p>ç¼–è¯‘æ—¶è¦ç¡®ä¿ä½¿ç”¨ç¼–è¯‘å™¨æ ‡å¿— &lt;code>-N&lt;/code> å’Œ &lt;code>-l&lt;/code> æ¥æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ&lt;code>-N&lt;/code> å’Œ &lt;code>-l&lt;/code> å›ç¦ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼˜åŒ–ä¼šä½¿è°ƒè¯•å˜å¾—å›°éš¾ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go build -gcflags=all=&amp;#34;-N -l&amp;#34;&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>å¦‚ä½•è°ƒè¯• Core Dump æ–‡ä»¶&lt;span class="hx-absolute -hx-mt-20" id="å¦‚ä½•è°ƒè¯•-core-dump-æ–‡ä»¶">&lt;/span>
&lt;a href="#%e5%a6%82%e4%bd%95%e8%b0%83%e8%af%95-core-dump-%e6%96%87%e4%bb%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">sum&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Intn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mf">1e6&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">n&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">sum&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="mi">42&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;panic for GOTRACEBACK&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„ç¤ºä¾‹è¿è¡Œåä¼šç›´æ¥å´©æºƒï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>panic: panic for GOTRACEBACK
goroutine 1 [running]:
main.main()
C:/Code/example.v1/system/coredump/main.go:21 &amp;#43;0x78&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„å †æ ˆä¿¡æ¯æ²¡æœ‰å¤ªå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;p>è¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡ &lt;code>GOTRACEBACK=crash&lt;/code> æ˜¯ç¨‹åºç”Ÿæˆ core dump æ–‡ä»¶ã€‚ç„¶åé‡æ–°è¿è¡Œï¼Œç°åœ¨å°±ä¼šå·²æ‰“å°å‡ºæ‰€æœ‰ goroutineï¼ŒåŒ…æ‹¬ runtimeï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>GOROOT=C:\Program Files\Go #gosetup
GOPATH=C:\Code\gowork #gosetup
&amp;#34;C:\Program Files\Go\bin\go.exe&amp;#34; build -o C:\Users\shipeng\AppData\Local\Temp\GoLand\___1go_build_github_com_shipengqi_example_v1_system_coredump.exe github.com/shipengqi/example.v1/system/coredump #gosetup
C:\Users\shipeng\AppData\Local\Temp\GoLand\___1go_build_github_com_shipengqi_example_v1_system_coredump.exe #gosetup
panic: panic for GOTRACEBACK
goroutine 1 [running]:
panic({0x4408c0, 0x45e5f8})
C:/Program Files/Go/src/runtime/panic.go:1147 &amp;#43;0x3a8 fp=0xc000047f58 sp=0xc000047e98 pc=0x40ea08
main.main()
C:/Code/example.v1/system/coredump/main.go:21 &amp;#43;0x78 fp=0xc000047f80 sp=0xc000047f58 pc=0x43be58
runtime.main()
C:/Program Files/Go/src/runtime/proc.go:255 &amp;#43;0x217 fp=0xc000047fe0 sp=0xc000047f80 pc=0x411437
runtime.goexit()
C:/Program Files/Go/src/runtime/asm_amd64.s:1581 &amp;#43;0x1 fp=0xc000047fe8 sp=0xc000047fe0 pc=0x435921
goroutine 2 [force gc (idle)]:
runtime.gopark(0x0, 0x0, 0x0, 0x0, 0x0)
C:/Program Files/Go/src/runtime/proc.go:366 &amp;#43;0xd6 fp=0xc000043fb0 sp=0xc000043f90 pc=0x4117d6
runtime.goparkunlock(...)
C:/Program Files/Go/src/runtime/proc.go:372
runtime.forcegchelper()
C:/Program Files/Go/src/runtime/proc.go:306 &amp;#43;0xb1 fp=0xc000043fe0 sp=0xc000043fb0 pc=0x411671
runtime.goexit()
C:/Program Files/Go/src/runtime/asm_amd64.s:1581 &amp;#43;0x1 fp=0xc000043fe8 sp=0xc000043fe0 pc=0x435921
created by runtime.init.7
C:/Program Files/Go/src/runtime/proc.go:294 &amp;#43;0x25
goroutine 3 [GC sweep wait]:
runtime.gopark(0x0, 0x0, 0x0, 0x0, 0x0)
C:/Program Files/Go/src/runtime/proc.go:366 &amp;#43;0xd6 fp=0xc000045fb0 sp=0xc000045f90 pc=0x4117d6
runtime.goparkunlock(...)
C:/Program Files/Go/src/runtime/proc.go:372
runtime.bgsweep()
C:/Program Files/Go/src/runtime/mgcsweep.go:163 &amp;#43;0x88 fp=0xc000045fe0 sp=0xc000045fb0 pc=0x3fc7e8
runtime.goexit()
C:/Program Files/Go/src/runtime/asm_amd64.s:1581 &amp;#43;0x1 fp=0xc000045fe8 sp=0xc000045fe0 pc=0x435921
created by runtime.gcenable
C:/Program Files/Go/src/runtime/mgc.go:181 &amp;#43;0x55
goroutine 4 [GC scavenge wait]:
runtime.gopark(0x0, 0x0, 0x0, 0x0, 0x0)
C:/Program Files/Go/src/runtime/proc.go:366 &amp;#43;0xd6 fp=0xc000055f80 sp=0xc000055f60 pc=0x4117d6
runtime.goparkunlock(...)
C:/Program Files/Go/src/runtime/proc.go:372
runtime.bgscavenge()
C:/Program Files/Go/src/runtime/mgcscavenge.go:265 &amp;#43;0xcd fp=0xc000055fe0 sp=0xc000055f80 pc=0x3fa8ed
runtime.goexit()
C:/Program Files/Go/src/runtime/asm_amd64.s:1581 &amp;#43;0x1 fp=0xc000055fe8 sp=0xc000055fe0 pc=0x435921
created by runtime.gcenable
C:/Program Files/Go/src/runtime/mgc.go:182 &amp;#43;0x65&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>åŒçº§ç›®å½•ä¸‹ä¼šæˆä¸€ä¸ªæ–‡ä»¶åå‰ç¼€æ˜¯ &lt;code>core&lt;/code> çš„æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ delve è°ƒè¯•ã€‚&lt;/p>
&lt;h3>è°ƒè¯•&lt;span class="hx-absolute -hx-mt-20" id="è°ƒè¯•">&lt;/span>
&lt;a href="#%e8%b0%83%e8%af%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>è°ƒè¯•éœ€è¦å…ˆå®‰è£… delveï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go install github.com/go-delve/delve/cmd/dlv@latest&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ç„¶åæ‰§è¡Œå‘½ä»¤ &lt;code>dlv core &amp;lt;å¯æ‰§è¡Œæ–‡ä»¶&amp;gt; &amp;lt;core æ–‡ä»¶&amp;gt;&lt;/code> ä¼šè¿›å…¥äº¤äº’æ¨¡å¼ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ dlv core main core.27507
Type &amp;#39;help&amp;#39; for list of commands.
(dlv)&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>è¾“å…¥ &lt;code>goroutines&lt;/code> å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ goroutines ä¿¡æ¯ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>(dlv) goroutines
* Goroutine 1 - User: ./main.go:11 main.main (0x47023e) (thread 27507)
Goroutine 2 - User: /usr/local/go/src/runtime/proc.go:399 runtime.gopark (0x439ffc) [force gc (idle)]
Goroutine 3 - User: /usr/local/go/src/runtime/proc.go:399 runtime.gopark (0x439ffc) [GC sweep wait]
Goroutine 4 - User: /usr/local/go/src/runtime/proc.go:399 runtime.gopark (0x439ffc) [GC scavenge wait]
[4 goroutines]&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Goroutine 1 æ˜¯ main goroutineï¼Œä¹Ÿæ˜¯å¯¼è‡´å´©æºƒçš„ goroutineï¼Œè¾“å…¥ &lt;code>goroutine 1&lt;/code> åˆ‡æ¢åˆ° Goroutine 1 çš„æ ˆå¸§ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>(dlv) goroutine 1
Switched from 1 to 1 (thread 27507)
(dlv) &lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>æ‰§è¡Œ &lt;code>bt&lt;/code> æŸ¥çœ‹è¯¦ç»†çš„æ ˆå¸§ä¿¡æ¯ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>(dlv) bt
0 0x0000000000465021 in runtime.raise
at /usr/local/go/src/runtime/sys_linux_amd64.s:154
1 0x000000000044c525 in runtime.dieFromSignal
at /usr/local/go/src/runtime/signal_unix.go:903
2 0x000000000044cbb5 in runtime.sigfwdgo
at /usr/local/go/src/runtime/signal_unix.go:1108
3 0x000000000044b485 in runtime.sigtrampgo
at /usr/local/go/src/runtime/signal_unix.go:432
4 0x0000000000465306 in runtime.sigtramp
at /usr/local/go/src/runtime/sys_linux_amd64.s:352
5 0x0000000000465400 in runtime.sigreturn__sigaction
at /usr/local/go/src/runtime/sys_linux_amd64.s:471
6 0x0000000000000001 in ???
at ?:-1
7 0x000000000044c712 in runtime.crash
at /usr/local/go/src/runtime/signal_unix.go:985
8 0x000000000043785e in runtime.fatalpanic
at /usr/local/go/src/runtime/panic.go:1202
9 0x0000000000436fb9 in runtime.gopanic
at /usr/local/go/src/runtime/panic.go:1017
10 0x000000000047023e in main.main
at ./main.go:11
11 0x0000000000439b87 in runtime.main
at /usr/local/go/src/runtime/proc.go:267
12 0x0000000000463821 in runtime.goexit
at /usr/local/go/src/runtime/asm_amd64.s:1650
(dlv) &lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„è¾“å‡ºä¸­ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>10 0x000000000047023e in main.main
at ./main.go:11&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥å®šä½åˆ°å¯¼è‡´å´©æºƒçš„ä»£ç åœ¨ &lt;code>main.go&lt;/code>ï¼Œç„¶åè¾“å…¥ &lt;code>frame 10&lt;/code> è¿›å…¥å…·ä½“çš„ä»£ç ä¸­ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>(dlv) frame 10
&amp;gt; runtime.raise() /usr/local/go/src/runtime/sys_linux_amd64.s:154 (PC: 0x465021)
Warning: debugging optimized function
Frame 10: ./main.go:11 (PC: 47023e)
Warning: listing may not match stale executable
6: var sum int
7: for {
8: n := rand.Intn(1e6)
9: sum &amp;#43;= n
10: if sum % 42 == 0 {
=&amp;gt; 11: panic(&amp;#34;panic for GOTRACEBACK&amp;#34;)
12: }
13: }
14: }
(dlv) &lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¯ä»¥å®šä½åˆ°ç¬¬ 11 è¡Œä»£ç å¯¼è‡´çš„ panicã€‚&lt;/p></description></item><item><title>Go Modules</title><link>https://shipengqi.github.io/golang-learn/docs/practice/08_mod/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/08_mod/</guid><description>
&lt;p>Go åœ¨ 1.11 æ¨å‡ºäº† Go Modulesï¼Œè¿™æ˜¯ä¸€ä¸ªæ–°çš„åŒ…ç®¡ç†å™¨ï¼Œè§£å†³äº† &lt;code>GOPATH&lt;/code> å­˜åœ¨çš„é—®é¢˜ã€‚å¹¶ä¸” Go 1.13 èµ·ä¸å†æ¨èä½¿ç”¨ GOPATHã€‚&lt;/p>
&lt;h2>Go Modules æœºåˆ¶&lt;span class="hx-absolute -hx-mt-20" id="go-modules-æœºåˆ¶">&lt;/span>
&lt;a href="#go-modules-%e6%9c%ba%e5%88%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go Modules å°†ä¾èµ–ç¼“å­˜æ”¾åœ¨ &lt;code>$GOPATH/pkg/mod&lt;/code> ç›®å½•ï¼Œå¹¶ä¸”&lt;strong>åŒä¸€ä¸ªä¾èµ–çš„ç‰ˆæœ¬ï¼Œåªä¼šç¼“å­˜ä¸€ä»½ï¼Œä¾›æ‰€æœ‰é¡¹ç›®ä½¿ç”¨&lt;/strong>ã€‚&lt;/p>
&lt;h3>å¯ç”¨ Go Modules&lt;span class="hx-absolute -hx-mt-20" id="å¯ç”¨-go-modules">&lt;/span>
&lt;a href="#%e5%90%af%e7%94%a8-go-modules" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Go 1.11 å¼•å…¥äº†ç¯å¢ƒå˜é‡ &lt;code>GO111MODULE&lt;/code> æ¥æ§åˆ¶æ˜¯å¦å¯ç”¨ Go Modulesï¼Œ&lt;code>GO111MODULE&lt;/code> æœ‰ä¸‰ä¸ªå€¼å¯é€‰ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>on&lt;/code> å¯ç”¨ Go Modules&lt;/li>
&lt;li>&lt;code>off&lt;/code> ç¦ç”¨ Go Modules&lt;/li>
&lt;li>&lt;code>auto&lt;/code>ï¼Œåœ¨ &lt;code>GOPATH&lt;/code> ä¸‹çš„é¡¹ç›®ï¼Œä½¿ç”¨ &lt;code>GOPATH&lt;/code>ï¼Œå¦åˆ™å¯ç”¨ Go Modulesã€‚&lt;/li>
&lt;/ul>
&lt;p>Go 1.16 ä¹‹å‰ &lt;code>GO111MODULE&lt;/code> çš„é»˜è®¤å€¼æ˜¯ &lt;code>auto&lt;/code>ï¼ŒGo 1.16 èµ· &lt;code>GO111MODULE&lt;/code> çš„é»˜è®¤å€¼ä¸º &lt;code>on&lt;/code>ã€‚&lt;/p>
&lt;h3>åˆå§‹åŒ–&lt;span class="hx-absolute -hx-mt-20" id="åˆå§‹åŒ–">&lt;/span>
&lt;a href="#%e5%88%9d%e5%a7%8b%e5%8c%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>åˆå§‹åŒ– Go Modules é¡¹ç›®ï¼Œé¦–å…ˆè¦å¼€å¯ Go Modulesï¼Œç„¶ååœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go mod init &amp;lt;project-path&amp;gt;&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>ä¸‹è½½ä¾èµ–&lt;span class="hx-absolute -hx-mt-20" id="ä¸‹è½½ä¾èµ–">&lt;/span>
&lt;a href="#%e4%b8%8b%e8%bd%bd%e4%be%9d%e8%b5%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä¸‹è½½ä¾èµ–ä½¿ç”¨ &lt;code>go get&lt;/code> å‘½ä»¤ï¼Œå‘½ä»¤æ ¼å¼ä¸º &lt;code>go get &amp;lt;package[@version]&amp;gt;&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>go get golang.org/x/test@latest&lt;/code>ï¼Œ&lt;code>@latest&lt;/code> è¡¨ç¤ºé€‰æ‹©æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚ &lt;code>v1.2.3&lt;/code>ã€‚å¦‚æœæ²¡æœ‰ç¨³å®šç‰ˆæœ¬ï¼Œé€‰æ‹©æœ€æ–°çš„é¢„å‘å¸ƒç‰ˆæœ¬ï¼Œä¾‹å¦‚ &lt;code>v1.2.3-alpha.1&lt;/code>ã€‚
å¦‚æœä¾èµ–æ²¡æœ‰ tagï¼Œé‚£ä¹ˆé€‰æ‹©æœ€æ–°çš„ commitã€‚&lt;/li>
&lt;li>&lt;code>go get golang.org/x/test&lt;/code> åŒä¸Šã€‚&lt;/li>
&lt;li>&lt;code>go get golang.org/x/test@v1.2.3&lt;/code> ä¸‹è½½ tag ä¸º &lt;code>v1.2.3&lt;/code> çš„ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>go get golang.org/x/test@v0&lt;/code> ä¸‹è½½ tag å‰ç¼€ä¸º &lt;code>v0&lt;/code> çš„ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>go get golang.org/x/test@master&lt;/code> ä¸‹è½½ master åˆ†æ”¯ä¸Šæœ€æ–°çš„ commitã€‚&lt;/li>
&lt;li>&lt;code>go get golang.org/x/test@37s237s&lt;/code> ä¸‹è½½å“ˆå¸Œå€¼ä¸º &lt;code>37s237s&lt;/code> çš„ commitï¼Œå¦‚æœè¯¥ commit å­˜åœ¨å¯¹åº”çš„ tagï¼Œè½¬æ¢ä¸º tag å¹¶ä¸‹è½½ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;code>go get -u&lt;/code> æ›´æ–°ç°æœ‰çš„ä¾èµ–ã€‚&lt;/p>
&lt;h3>Go Modules ä»£ç†&lt;span class="hx-absolute -hx-mt-20" id="go-modules-ä»£ç†">&lt;/span>
&lt;a href="#go-modules-%e4%bb%a3%e7%90%86" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å›½å†…æ˜¯æ— æ³•è®¿é—® &lt;code>golang.org&lt;/code> çš„ï¼ŒGo 1.13 å¼•å…¥äº†ç¯å¢ƒå˜é‡ &lt;code>GOPROXY&lt;/code>ï¼Œå¯ä»¥ç”¨æ¥è®¾ç½® Go Modules çš„ä»£ç†ã€‚&lt;/p>
&lt;p>&lt;code>GOPROXY&lt;/code> çš„é»˜è®¤å€¼ä¸º &lt;code>https://proxy.golang.org,direct&lt;/code>ï¼Œ&lt;code>GOPROXY&lt;/code> å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œç”¨ &lt;code>,&lt;/code> åˆ†éš”ã€‚&lt;/p>
&lt;p>æ‰§è¡Œ &lt;code>go get/install&lt;/code> æ—¶ä¼šä¼˜å…ˆä»ä»£ç†æœåŠ¡å™¨ä¸‹è½½ä¾èµ–ã€‚å¦‚æœä»ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ä¸‹è½½å¤±è´¥ï¼Œå½“é‡è§ &lt;code>direct&lt;/code> æ—¶ï¼Œè¡¨ç¤ºå›æºåˆ°ä¾èµ–çš„æºåœ°å€å»ä¸‹è½½ã€‚&lt;/p>
&lt;h4>è®¾ç½® GOPROXY&lt;span class="hx-absolute -hx-mt-20" id="è®¾ç½®-goproxy">&lt;/span>
&lt;a href="#%e8%ae%be%e7%bd%ae-goproxy" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä½¿ç”¨ &lt;code>go env -w GOPROXY=https://goproxy.cn,direct&lt;/code> å‘½ä»¤æ¥è®¾ç½® &lt;code>GOPROXY&lt;/code> çš„å€¼ã€‚&lt;/p>
&lt;h3>GOPRIVATE&lt;span class="hx-absolute -hx-mt-20" id="goprivate">&lt;/span>
&lt;a href="#goprivate" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å¦‚æœé¡¹ç›®æœ‰ä¸€ä¸ªç§æœ‰ä¾èµ–ï¼Œè®¾ç½® &lt;code>GOPROXY&lt;/code> ä¹Ÿæ— æ³•è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>GOPRIVATE&lt;/code>ã€‚&lt;/p>
&lt;p>æ¯”å¦‚ &lt;code>GOPRIVATE=corp.example.com,github.com/pookt/demo&lt;/code> è¡¨ç¤ºå‰ç¼€å¯ä»¥åŒ¹é… &lt;code>corp.example.com&lt;/code> æˆ–è€… &lt;code>github.com/pookt/demo&lt;/code> çš„ä¾èµ–éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯ç§æœ‰ä¾èµ–ã€‚&lt;/p>
&lt;p>&lt;code>GOPRIVATE&lt;/code> æ”¯æŒé€šé…ç¬¦ï¼Œä¾‹å¦‚ &lt;code>*.example.com&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;code>GOPRIVATE&lt;/code> è¾ƒä¸ºç‰¹æ®Šï¼Œå®ƒçš„å€¼å°†ä½œä¸º &lt;code>GONOPROXY&lt;/code> å’Œ &lt;code>GONOSUMDB&lt;/code> çš„é»˜è®¤å€¼ã€‚æ‰€ä»¥åªä½¿ç”¨ &lt;code>GOPRIVATE&lt;/code> å°±è¶³å¤Ÿã€‚&lt;/p>
&lt;h3>go.mod æ–‡ä»¶&lt;span class="hx-absolute -hx-mt-20" id="gomod-æ–‡ä»¶">&lt;/span>
&lt;a href="#gomod-%e6%96%87%e4%bb%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>go.mod&lt;/code> æ˜¯ Go Modules é¡¹ç›®æ‰€å¿…é¡»çš„æœ€é‡è¦çš„æ–‡ä»¶ï¼Œæè¿°äº†å½“å‰é¡¹ç›®çš„å…ƒä¿¡æ¯ï¼Œç›®å‰æœ‰ 5 ä¸ªå…³é”®å­—ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>module&lt;/code>ï¼šå®šä¹‰å½“å‰é¡¹ç›®çš„æ¨¡å—è·¯å¾„ã€‚&lt;/li>
&lt;li>&lt;code>go&lt;/code>ï¼šé¢„æœŸçš„ Go ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>require&lt;/code>ï¼šæŒ‡å®šé¡¹ç›®çš„ä¾èµ–ç‰ˆæœ¬ï¼Œæ ¼å¼ä¸º&lt;code>&amp;lt;ä¾èµ–çš„è·¯å¾„&amp;gt; &amp;lt;ç‰ˆæœ¬&amp;gt; [// indirect]&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>exclude&lt;/code>ï¼šæ’é™¤ä¸€ä¸ªç‰¹å®šçš„ä¾èµ–ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>replace&lt;/code>ï¼šå°†ä¸€ä¸ªä¾èµ–ç‰ˆæœ¬æ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªä¾èµ–ç‰ˆæœ¬ï¼Œæ ¼å¼ä¸º &lt;code>module =&amp;gt; newmodule&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>module example.com/foobar
go 1.13
require (
example.com/apple v0.1.2
example.com/pear v1.2.3
example.com/watermelon v3.3.10&amp;#43;incompatible
example.com/banana/v2 v2.3.4 // indirect
example.com/pineapple v0.0.0-20190924185754-1b0db40df49a
)
exclude example.com/banana v1.2.4
replace example.com/apple v0.1.2 =&amp;gt; example.com/rda v0.1.0
replace example.com/banana =&amp;gt; example.com/hugebanana&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h4>replace&lt;span class="hx-absolute -hx-mt-20" id="replace">&lt;/span>
&lt;a href="#replace" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>&lt;code>replace&lt;/code> æ˜¯ç”¨æ¥å°†ä¸€ä¸ªä¾èµ–ç‰ˆæœ¬æ›¿æ¢ä¸ºå¦å¤–ä¸€ä¸ªä¾èµ–ç‰ˆæœ¬ï¼Œæ ¼å¼ä¸º &lt;code>module =&amp;gt; newmodule&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>newmodule&lt;/code> å¯ä»¥æ˜¯æœ¬åœ°ç›¸å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ &lt;code>github.com/gin-gonic/gin =&amp;gt; ./gin&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>newmodule&lt;/code> ä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°ç»å¯¹è·¯å¾„ï¼Œä¾‹å¦‚ &lt;code>github.com/gin-gonic/gin =&amp;gt; /home/root/gin&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>newmodule&lt;/code> å¯ä»¥æ˜¯ç½‘ç»œè·¯å¾„ï¼Œä¾‹å¦‚ &lt;code>golang.org/x/text v0.3.2 =&amp;gt; github.com/golang/text v0.3.2&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;h4>ä¾èµ–çš„å¯¼å…¥è·¯å¾„è¯´æ˜&lt;span class="hx-absolute -hx-mt-20" id="ä¾èµ–çš„å¯¼å…¥è·¯å¾„è¯´æ˜">&lt;/span>
&lt;a href="#%e4%be%9d%e8%b5%96%e7%9a%84%e5%af%bc%e5%85%a5%e8%b7%af%e5%be%84%e8%af%b4%e6%98%8e" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä¸Šé¢ç¤ºä¾‹ä¸­ &lt;code>example.com/banana/v2 v2.3.4&lt;/code>ï¼Œ&lt;code>example.com/banana/v2&lt;/code> çš„å¯¼å…¥è·¯å¾„æœ‰ &lt;code>/v2&lt;/code> ä¸ºä»€ä¹ˆå…¶ä»–ä¾èµ–çš„å¯¼å…¥è·¯å¾„æ²¡æœ‰ &lt;code>/v0&lt;/code> æˆ–è€… &lt;code>/v1&lt;/code>ã€‚&lt;/p>
&lt;p>å› ä¸º Go modules åœ¨ä¸»ç‰ˆæœ¬å·ä¸º &lt;code>v0&lt;/code> å’Œ &lt;code>v1&lt;/code> çš„æƒ…å†µä¸‹çœç•¥äº†ç‰ˆæœ¬å·ï¼Œä¸éœ€è¦åœ¨æ¨¡å—å¯¼å…¥è·¯å¾„åŒ…å«ä¸»ç‰ˆæœ¬çš„ä¿¡æ¯ã€‚è€Œåœ¨ä¸»ç‰ˆæœ¬å·ä¸º &lt;code>v2&lt;/code> åŠä»¥ä¸Šåˆ™éœ€è¦åœ¨å¯¼å…¥è·¯å¾„æœ«å°¾åŠ ä¸Šä¸»ç‰ˆæœ¬å·ã€‚&lt;/p>
&lt;h4>v0.0.0-xxx æ˜¯ä»€ä¹ˆç‰ˆæœ¬&lt;span class="hx-absolute -hx-mt-20" id="v000-xxx-æ˜¯ä»€ä¹ˆç‰ˆæœ¬">&lt;/span>
&lt;a href="#v000-xxx-%e6%98%af%e4%bb%80%e4%b9%88%e7%89%88%e6%9c%ac" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Go æ‹‰å»çš„ä¾èµ–å¦‚æœæ²¡æœ‰ tagï¼Œé‚£ä¹ˆé€‰æ‹©æœ€æ–°çš„ commitã€‚ä¾‹å¦‚ä¸Šé¢ç¤ºä¾‹ä¸­çš„ &lt;code>example.com/pineapple v0.0.0-20190924185754-1b0db40df49a&lt;/code>ã€‚&lt;/p>
&lt;p>&lt;code>v0.0.0&lt;/code> æ˜¯å› ä¸º &lt;code>example.com/pineapple&lt;/code> è¿™ä¸ªä¾èµ–ä¸å­˜åœ¨ tagï¼Œ&lt;code>20190924185754&lt;/code> æœ€æ–°ä¸€æ¬¡ commit çš„ commit æ—¶é—´ï¼Œ&lt;code>1b0db40df49a&lt;/code> æ˜¯ commit çš„å“ˆå¸Œå€¼ã€‚&lt;/p>
&lt;h4>indirect&lt;span class="hx-absolute -hx-mt-20" id="indirect">&lt;/span>
&lt;a href="#indirect" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä¸Šé¢ç¤ºä¾‹ä¸­çš„ &lt;code>example.com/banana/v2 v2.3.4 // indirect&lt;/code>ã€‚&lt;code>indirect&lt;/code> è¡¨ç¤ºè¯¥ä¾èµ–ä¸ºé—´æ¥ä¾èµ–ã€‚&lt;/p>
&lt;p>é€šå¸¸ä¸Š &lt;code>go.mod&lt;/code> ä¸­å‡ºç°çš„éƒ½åº”è¯¥æ˜¯ç›´æ¥ä¾èµ–ï¼Œä½†æ˜¯ä¸‹é¢çš„ä¸¤ç§æƒ…å†µä¼šåœ¨ &lt;code>go.mod&lt;/code> ä¸­æ·»åŠ é—´æ¥ä¾èµ–ï¼š&lt;/p>
&lt;ul>
&lt;li>å½“å‰é¡¹ç›®çš„æŸä¸ªç›´æ¥ä¾èµ–æ²¡æœ‰ä½¿ç”¨ Go Modulesã€‚&lt;/li>
&lt;li>å½“å‰é¡¹ç›®çš„æŸä¸ªç›´æ¥ä¾èµ–çš„ &lt;code>go.mod&lt;/code> æ–‡ä»¶ä¸­ç¼ºå¤±æŸä¸ªä¾èµ–ï¼Œé‚£ä¹ˆè¿™ä¸ªç¼ºå¤±çš„ä¾èµ–ä¼šè¢«æ·»åŠ åœ¨å½“å‰é¡¹ç›®çš„ &lt;code>go.mod&lt;/code> æ–‡ä»¶ä¸­ï¼Œä½œä¸ºé—´æ¥ä¾èµ–ã€‚&lt;/li>
&lt;/ul>
&lt;h4>incompatible&lt;span class="hx-absolute -hx-mt-20" id="incompatible">&lt;/span>
&lt;a href="#incompatible" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>ä¸Šé¢ç¤ºä¾‹ä¸­çš„ &lt;code>example.com/watermelon v3.3.10+incompatible&lt;/code>ã€‚&lt;code>incompatible&lt;/code> è¡¨ç¤ºè¯¥ä¾èµ–çš„è·¯å¾„è·Ÿç‰ˆæœ¬ä¸ç¬¦åˆè§„èŒƒï¼Œ&lt;code>v3.3.10&lt;/code> ç‰ˆæœ¬æŒ‰ç…§è§„èŒƒï¼Œå¼•ç”¨è·¯å¾„åº”è¯¥ä¸º &lt;code>example.com/watermelon/v3&lt;/code>ã€‚
æ‰€ä»¥ Go ä¼šåœ¨ç‰ˆæœ¬ååŠ ä¸Š &lt;code>+incompatible&lt;/code>ã€‚&lt;/p>
&lt;h3>go.sum æ–‡ä»¶&lt;span class="hx-absolute -hx-mt-20" id="gosum-æ–‡ä»¶">&lt;/span>
&lt;a href="#gosum-%e6%96%87%e4%bb%b6" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>go.sum&lt;/code> åˆ—å‡ºäº†å½“å‰é¡¹ç›®æ‰€æœ‰ç›´æ¥æˆ–é—´æ¥ä¾èµ–çš„ç‰ˆæœ¬ï¼Œè®°å½•æ¯ä¸ªä¾èµ–çš„å“ˆå¸Œå€¼ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯é¡¹ç›®æ‰€ä¾èµ–çš„ç‰ˆæœ¬ä¸ä¼šè¢«ç¯¡æ”¹ã€‚&lt;/p>
&lt;h2>go mod å‘½ä»¤&lt;span class="hx-absolute -hx-mt-20" id="go-mod-å‘½ä»¤">&lt;/span>
&lt;a href="#go-mod-%e5%91%bd%e4%bb%a4" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>go mod&lt;/code> å¸¸ç”¨çš„å‡ ä¸ªå­å‘½ä»¤ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>init&lt;/code>ï¼šåˆå§‹åŒ– &lt;code>go.mod&lt;/code> æ–‡ä»¶&lt;/li>
&lt;li>&lt;code>tidy&lt;/code>ï¼šè‡ªåŠ¨æ·»åŠ é¡¹ç›®ä¾èµ–ï¼Œå¹¶ç§»é™¤æ— ç”¨çš„ä¾èµ–&lt;/li>
&lt;li>&lt;code>download&lt;/code>ï¼šä¸‹è½½ä¾èµ–åˆ°æœ¬åœ°ç¼“å­˜ã€‚&lt;/li>
&lt;li>&lt;code>graph&lt;/code>ï¼šæŸ¥çœ‹ç°æœ‰çš„ä¾èµ–ç»“æ„&lt;/li>
&lt;li>&lt;code>why&lt;/code>ï¼šæŸ¥çœ‹ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªä¾èµ–&lt;/li>
&lt;/ul>
&lt;h3>è¿ç§»å› vendor æ¨¡å¼&lt;span class="hx-absolute -hx-mt-20" id="è¿ç§»å›-vendor-æ¨¡å¼">&lt;/span>
&lt;a href="#%e8%bf%81%e7%a7%bb%e5%9b%9e-vendor-%e6%a8%a1%e5%bc%8f" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>go mod vendor&lt;/code> å¯ä»¥å°† Go Modules è¿ç§»å›åˆ°æ¨¡å¼ã€‚&lt;/p>
&lt;p>è¿™ä¸ªå‘½ä»¤å¹¶åªæ˜¯å•çº¯åœ°æŠŠ &lt;code>go.sum&lt;/code> ä¸­çš„æ‰€æœ‰ä¾èµ–ä¸‹è½½åˆ° &lt;code>vendor&lt;/code> ç›®å½•é‡Œã€‚&lt;/p>
&lt;p>å†ä½¿ç”¨ &lt;code>go build -mod=vendor&lt;/code> æ¥æ„å»ºé¡¹ç›®ï¼Œå› ä¸ºåœ¨ Go Modules æ¨¡å¼ä¸‹ &lt;code>go build&lt;/code> æ˜¯å±è”½ vendor æœºåˆ¶çš„ã€‚&lt;/p>
&lt;p>æ³¨æ„å‘å¸ƒæ—¶éœ€è¦å¸¦ä¸Š vendor ç›®å½•ã€‚&lt;/p>
&lt;h2>å…¶ä»–&lt;span class="hx-absolute -hx-mt-20" id="å…¶ä»–">&lt;/span>
&lt;a href="#%e5%85%b6%e4%bb%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>è®¾ç½® HTTP Proxy å´ä»ç„¶æ— æ³•ä¸‹è½½ä¾èµ–&lt;span class="hx-absolute -hx-mt-20" id="è®¾ç½®-http-proxy-å´ä»ç„¶æ— æ³•ä¸‹è½½ä¾èµ–">&lt;/span>
&lt;a href="#%e8%ae%be%e7%bd%ae-http-proxy-%e5%8d%b4%e4%bb%8d%e7%84%b6%e6%97%a0%e6%b3%95%e4%b8%8b%e8%bd%bd%e4%be%9d%e8%b5%96" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>é€šå¸¸å¦‚æœè®¾ç½®äº† HTTP Proxyï¼Œ&lt;code>go get/install&lt;/code> ä¼šä½¿ç”¨æŒ‡å®šçš„ä»£ç†å»ä¸‹è½½ä¾èµ–ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># windows&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> &lt;span class="nv">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> &lt;span class="nv">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä½†æ˜¯ï¼Œå¦‚æœæ‹‰å–çš„ä¾èµ–æ˜¯ä½¿ç”¨ Git ä½œä¸ºæºæ§åˆ¶ç®¡ç†å™¨ï¼Œé‚£ä¹ˆè¿˜éœ€è¦é…ç½® Git çš„ Proxyï¼Œå¦åˆ™è¿˜æ˜¯æ— æ³•ä¸‹è½½ä¾èµ–ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">git config --global http.proxy http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git config --global https.proxy http://&lt;span class="o">[&lt;/span>user&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>pass&lt;span class="o">]&lt;/span>@&lt;span class="o">[&lt;/span>proxy_ip&lt;span class="o">]&lt;/span>:&lt;span class="o">[&lt;/span>proxy_port&lt;span class="o">]&lt;/span>/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>æ¸…ç†ç¼“å­˜&lt;span class="hx-absolute -hx-mt-20" id="æ¸…ç†ç¼“å­˜">&lt;/span>
&lt;a href="#%e6%b8%85%e7%90%86%e7%bc%93%e5%ad%98" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>&lt;code>go clean -modcache&lt;/code> å¯ä»¥ç”¨æ¥æ¸…ç†æ‰€æœ‰ç¼“å­˜çš„ä¾èµ–ã€‚&lt;/p></description></item><item><title>Gin é™æ€æœåŠ¡å™¨</title><link>https://shipengqi.github.io/golang-learn/docs/practice/09_gin/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/09_gin/</guid><description>
&lt;p>Gin ä½œä¸º Web æ¡†æ¶æä¾› API éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæ—¢æä¾› APIï¼Œåˆè¦ä½œä¸ºå‰ç«¯ç½‘é¡µçš„é™æ€æœåŠ¡å™¨ï¼Œå°±æ¯”è¾ƒéº»çƒ¦ã€‚é€šå¸¸ Angular (React/Vue)
é¡¹ç›®éœ€è¦åœ¨ Nginx æˆ–è€… Tomcat è½¬å‘æ‰å¯ä»¥ã€‚æœ‰äº›å°é¡¹ç›®å¹¶ä¸éœ€è¦å‰åç«¯åˆ†ç¦»ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ&lt;/p>
&lt;h2>åˆ©ç”¨ embed æ ‡ç­¾&lt;span class="hx-absolute -hx-mt-20" id="åˆ©ç”¨-embed-æ ‡ç­¾">&lt;/span>
&lt;a href="#%e5%88%a9%e7%94%a8-embed-%e6%a0%87%e7%ad%be" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go 1.16 å¢åŠ äº† &lt;code>embed&lt;/code> çš„æ ‡ç­¾ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ ‡ç­¾å°†é™æ€èµ„æºæ‰“åŒ…åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ controller
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ model
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ options
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ pkg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â””â”€â”€ response
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â””â”€â”€ response.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ resources
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”œâ”€â”€ dist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â””â”€â”€ html.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ html.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ resource.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ router.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ server.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€ store
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ audited.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ groups.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ mysql.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ settings.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ store.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€ tokens.go&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢é¡¹ç›®çš„ç›®å½•ç»“æ„ä¸­æ³¨æ„è¿™å‡ ä¸ªæ–‡ä»¶ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ resources
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”œâ”€â”€ dist
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â””â”€â”€ html.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ html.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ resource.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ router.go&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>dist&lt;/code> æ˜¯æ‰“åŒ…å¥½çš„é™æ€èµ„æºã€‚&lt;/p>
&lt;p>&lt;code>html.go&lt;/code> ä¸ºäº†åé¢æ¸²æŸ“ &lt;code>index.html&lt;/code> å’Œé™æ€èµ„æºæä¾›çš„å˜é‡ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">resources&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;embed&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//go:embed dist/stat-web/index.html
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">Html&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//go:embed dist/stat-web
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">Static&lt;/span> &lt;span class="nx">embed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">FS&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>resource.go&lt;/code> å®ç°äº† &lt;code>FS&lt;/code> æ¥å£ï¼š&lt;/p>
&lt;p>&lt;code>FS&lt;/code> æ¥å£ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">FS&lt;/span> &lt;span class="kd">interface&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Open opens the named file.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// When Open returns an error, it should be of type *PathError
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// with the Op field set to &amp;#34;open&amp;#34;, the Path field set to name,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// and the Err field describing the problem.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">//
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Open should reject attempts to open names that do not satisfy
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ValidPath(name), returning a *PathError with Err set to
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ErrInvalid or ErrNotExist.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">File&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>resource.go&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">apiserver&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;embed&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;io/fs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;path&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;project/resources&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Resource&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fs&lt;/span> &lt;span class="nx">embed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">FS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">NewResource&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">staticPath&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Resource&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">Resource&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fs&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">resources&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Static&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1">// resources/html.go ä¸­å®šä¹‰çš„ Static
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">path&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">staticPath&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">Resource&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">fs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">File&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// rewrite the static files path
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fullName&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">path&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// è¿™é‡Œæ‹¼å‡ºé™æ€èµ„æºçš„å®Œæ•´è·¯å¾„ï¼Œæ³¨æ„ windows ä¸‹ä½¿ç”¨ filepath.Joinï¼Œä¼šå¯¼è‡´æ‰¾ä¸åˆ°æ–‡ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="nx">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">fs&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">fullName&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>html.go&lt;/code> ä¸­å®ç°äº† &lt;code>HtmlHandler&lt;/code> ç”¨æ¥æ¸²æŸ“ &lt;code>index.html&lt;/code>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">apiserver&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;github.com/gin-gonic/gin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;project/resources&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">HtmlHandler&lt;/span> &lt;span class="kd">struct&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">NewHtmlHandler&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">HtmlHandler&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">HtmlHandler&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// RedirectIndex é‡å®šå‘
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">HtmlHandler&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">RedirectIndex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">gin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Context&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Redirect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StatusFound&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">h&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">HtmlHandler&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">Index&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">c&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">gin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Context&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Header&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;content-type&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;text/html;charset=utf-8&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">resources&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Html&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>&lt;code>router.go&lt;/code> ä¸­é…ç½®è·¯ç”±ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">installController&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">g&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">gin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Engine&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">html&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">NewHtmlHandler&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">g&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">GET&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Index&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">g&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StaticFS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/static&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">FS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">NewResource&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;dist/stat-web&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">g&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StaticFS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/assets&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">FS&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">NewResource&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;dist/stat-web/assets&amp;#34;&lt;/span>&lt;span class="p">)))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">g&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NoRoute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">RedirectIndex&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// APIs
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">v1&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">g&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Group&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/api/v1&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>ä¸Šé¢çš„è·¯ç”± &lt;code>g.StaticFS(&amp;quot;/static&amp;quot;, http.FS(NewResource(&amp;quot;dist/stat-web&amp;quot;)))&lt;/code> ï¼Œè·¯å¾„ä¹‹æ‰€ä»¥æ˜¯ &lt;code>/static&lt;/code> æ˜¯å› ä¸ºåœ¨æ‰“åŒ… Angular é¡¹ç›®æ—¶ä½¿ç”¨äº† &lt;code>--deploy-url&lt;/code>ï¼š&lt;/p>
&lt;p>&lt;code>assets&lt;/code> ç›®å½•ä¸‹ä¼šæœ‰ iconï¼Œimageï¼Œjson ç­‰é™æ€èµ„æºã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ³¨æ„ &lt;code>index.html&lt;/code> ä¸­ &lt;code>link rel=&amp;quot;icon&amp;quot; type=&amp;quot;image/x-icon&amp;quot; href=&amp;quot;assets/favicon.ico&amp;quot;&lt;/code>ï¼Œ&lt;code>href&lt;/code> çš„è·¯å¾„æ˜¯ &lt;code>assets/favicon.ico&lt;/code>ï¼Œ
&lt;code>deploy-url&lt;/code> å¹¶ä¸ä¼šç»™ &lt;code>href=&amp;quot;assets/favicon.ico&amp;quot;&lt;/code> æ·»åŠ  static å‰ç¼€ã€‚æ‰€ä»¥å¦‚æœæ˜¯ &lt;code>href=&amp;quot;favicon.ico&amp;quot;&lt;/code>ï¼Œç¼–è¯‘åä¼šæ‰¾ä¸åˆ°è¯¥æ–‡ä»¶ã€‚&lt;/p>
&lt;/blockquote>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ng build &amp;lt;project&amp;gt; --configuration production --deploy-url /static/&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;blockquote>
&lt;p>&lt;code>--deploy-url&lt;/code> å°†è¢«å¼ƒç”¨ï¼Œä¹‹åéœ€è¦è€ƒè™‘å…¶ä»–æ–¹å¼ã€‚æš‚æ—¶ä¸ä½¿ç”¨ &lt;code>--base-href&lt;/code> æ˜¯å› ä¸ºï¼š
deploy url å’Œ base href éƒ½å¯ç”¨äºåˆå§‹è„šæœ¬ã€æ ·å¼è¡¨ã€æƒ°æ€§è„šæœ¬å’Œ css èµ„æºã€‚ ä½†æ˜¯ï¼Œå®šä¹‰ base href æœ‰ä¸€äº›ç‹¬æœ‰çš„ä½œç”¨ã€‚
base href å¯ç”¨äºå®šä½ç›¸å¯¹è·¯å¾„æ¨¡æ¿ (HTML) èµ„äº§å’Œé’ˆå¯¹ç›¸å¯¹è·¯å¾„çš„ fetch/XMLHttpRequestsã€‚base href ä¹Ÿå¯ç”¨äºå®šä¹‰ Angular è·¯ç”±å™¨çš„é»˜è®¤åŸºåœ°å€ã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>Go è¿œç¨‹å¼€å‘è°ƒè¯•</title><link>https://shipengqi.github.io/golang-learn/docs/practice/10_remote_dev/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://shipengqi.github.io/golang-learn/docs/practice/10_remote_dev/</guid><description>
&lt;p>VS Code æ˜¯ä¸€æ¬¾å¼€æºçš„ä»£ç ç¼–è¾‘å™¨ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒè¿œç¨‹å¼€å‘è°ƒè¯•ã€‚&lt;/p>
&lt;h2>æ­å»ºç¯å¢ƒ&lt;span class="hx-absolute -hx-mt-20" id="æ­å»ºç¯å¢ƒ">&lt;/span>
&lt;a href="#%e6%90%ad%e5%bb%ba%e7%8e%af%e5%a2%83" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>è¦å®ç° Go è¿œç¨‹å¼€å‘è°ƒè¯•ï¼Œéœ€è¦å…ˆå®‰è£… &lt;a href="https://marketplace.visualstudio.com/items?itemName=golang.Go" target="_blank" rel="noopener">Go for Visual Studio Code&lt;/a> æ’ä»¶ã€‚&lt;/p>
&lt;p>VS Code çš„ Remote åŠŸèƒ½ç”±ä¸‰ä¸ªæ’ä»¶ç»„æˆï¼Œåˆ†åˆ«é€‚ç”¨äºä¸‰ç§ä¸åŒçš„åœºæ™¯ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://code.visualstudio.com/docs/remote/ssh" target="_blank" rel="noopener">Remote - SSH&lt;/a>ï¼šåˆ©ç”¨ SSH è¿æ¥è¿œç¨‹ä¸»æœºè¿›è¡Œå¼€å‘ã€‚&lt;/li>
&lt;li>&lt;a href="https://code.visualstudio.com/docs/devcontainers/containers" target="_blank" rel="noopener">Remote - Container&lt;/a>ï¼šè¿æ¥å½“å‰æœºå™¨ä¸Šçš„å®¹å™¨è¿›è¡Œå¼€å‘ã€‚&lt;/li>
&lt;li>&lt;a href="https://code.visualstudio.com/docs/remote/wsl" target="_blank" rel="noopener">Remote - WSL&lt;/a>ï¼šè¿æ¥å­ç³»ç»Ÿï¼ˆWindows Subsystem for Linuxï¼‰è¿›è¡Œå¼€å‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>SSH æ¨¡å¼çš„åŸç†ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/f453d238f302873f51c3859269a86bcc8248d6ce/go/architecture-vscode-ssh.png" alt="architecture-vscode-ssh" loading="lazy" />
å›¾ç‰‡æ¥è‡ªäº Visual Studio Code å®˜ç½‘&lt;/p>
&lt;h3>è¿æ¥è¿œç¨‹æœºå™¨&lt;span class="hx-absolute -hx-mt-20" id="è¿æ¥è¿œç¨‹æœºå™¨">&lt;/span>
&lt;a href="#%e8%bf%9e%e6%8e%a5%e8%bf%9c%e7%a8%8b%e6%9c%ba%e5%99%a8" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>å®‰è£…æ’ä»¶ &lt;a href="https://code.visualstudio.com/docs/remote/ssh" target="_blank" rel="noopener">Remote SSH&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æœåŠ¡å™¨éœ€è¦æ”¯æŒ SSH è¿æ¥ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>å®‰è£…åï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„ &lt;code>Open a Remote Window&lt;/code>ï¼Œé€‰æ‹© &lt;code>Connect to Host&lt;/code>ã€‚&lt;/p>
&lt;p>ç‚¹å‡» &lt;code>Add New SSH Host&lt;/code> é…ç½®ä½ çš„è¿œç¨‹æœºå™¨ï¼Œæˆ–è€…é€‰æ‹©å·²ç»é…ç½®å¥½çš„ Hostsã€‚&lt;/p>
&lt;p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¿«æ·é”® &lt;code>F1&lt;/code> æˆ–è€… &lt;code>ctrl+shift+p&lt;/code> æ‰“å¼€ commandsï¼Œè¾“å…¥ &lt;code>Open SSH Configuration File&lt;/code> ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># Read more about SSH config files: https://linux.die.net/man/5/ssh_config
Host shcCDFrh75vm8.hpeswlab.net
HostName shcCDFrh75vm8.hpeswlab.net
Port 22
User root
Host shccdfrh75vm7.hpeswlab.net
HostName shccdfrh75vm7.hpeswlab.net
User root&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>é…ç½®å¥½ä¹‹åï¼š&lt;/p>
&lt;ol>
&lt;li>è¿æ¥ hostã€‚&lt;/li>
&lt;li>é€‰æ‹© platformï¼šLinux, Windows, macOSã€‚&lt;/li>
&lt;li>è¾“å…¥å¯†ç å»ºç«‹è¿æ¥ã€‚&lt;/li>
&lt;li>ç‚¹å‡» &lt;code>Open Folder&lt;/code> å°±å¯ä»¥æ‰“å¼€è¿œç¨‹æœºå™¨ä¸Šçš„ä»£ç ç›®å½•äº†ã€‚&lt;/li>
&lt;li>VS Code ä¼šæç¤ºè¿œç¨‹æœºå™¨éœ€è¦å®‰è£… Go æ‰©å±•ï¼Œé€‰æ‹©å®‰è£…ã€‚&lt;/li>
&lt;/ol>
&lt;p>å·¦ä¾§è¾¹æ çš„ Remote Explorerï¼Œå¯ä»¥å¿«é€Ÿæ‰“å¼€è¿œç¨‹æœºå™¨ä¸Šçš„ä»£ç ç›®å½•ï¼š&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/c31f3c17d77e206a8abf012b5aac54744b185dbe/go/vscode-remote-usage.png" alt="vscode-remote-usage" loading="lazy" />&lt;/p>
&lt;h3>é…ç½®å…å¯†ç™»å½•&lt;span class="hx-absolute -hx-mt-20" id="é…ç½®å…å¯†ç™»å½•">&lt;/span>
&lt;a href="#%e9%85%8d%e7%bd%ae%e5%85%8d%e5%af%86%e7%99%bb%e5%bd%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>ä½¿ç”¨å¿«æ·é”® &lt;code>F1&lt;/code> æˆ–è€… &lt;code>ctrl+shift+p&lt;/code> æ‰“å¼€ commandsï¼Œè¾“å…¥ &lt;code>Open SSH Configuration File&lt;/code> ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>Host shccdfrh75vm7.hpeswlab.net
HostName shccdfrh75vm7.hpeswlab.net
User root
IdentityFile &amp;lt;absolute-path&amp;gt;/.ssh/id_rsa&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¦‚æœæ²¡æœ‰ç§˜é’¥ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>ssh-keygen -t rsa&lt;/code> å‘½ä»¤ç”Ÿæˆã€‚&lt;/p>
&lt;p>å°† SSH å…¬é’¥æ·»åŠ åˆ°è¿œç¨‹æœºå™¨ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ ssh-copy-id username@remote-host&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¦‚æœ &lt;code>ssh-copy-id&lt;/code> å‘½ä»¤ä¸å­˜åœ¨ï¼Œå°±æ‰‹åŠ¨å°† &lt;code>&amp;lt;absolute-path&amp;gt;/.ssh/id_rsa.pub&lt;/code> çš„å†…å®¹ï¼Œè¿½åŠ åˆ°è¿œç¨‹æœºå™¨çš„ &lt;code>~/.ssh/authorized_keys&lt;/code> æ–‡ä»¶åé¢ã€‚&lt;/p>
&lt;h2>è¿œç¨‹å¼€å‘&lt;span class="hx-absolute -hx-mt-20" id="è¿œç¨‹å¼€å‘">&lt;/span>
&lt;a href="#%e8%bf%9c%e7%a8%8b%e5%bc%80%e5%8f%91" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>è¿æ¥åˆ°è¿œç¨‹ä¸»æœºåï¼Œå°±å¯ä»¥è¿›è¡Œè¿œç¨‹å¼€å‘äº†ã€‚å¯ä»¥åƒæœ¬åœ°å¼€å‘ä¸€æ ·æŸ¥çœ‹ï¼Œä¿®æ”¹æ–‡ä»¶ã€‚&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/shipengqi/illustrations/c31f3c17d77e206a8abf012b5aac54744b185dbe/go/vscode-ssh-dev.png" alt="vscode-ssh-dev" loading="lazy" />&lt;/p>
&lt;h2>è¿œç¨‹è°ƒè¯•&lt;span class="hx-absolute -hx-mt-20" id="è¿œç¨‹è°ƒè¯•">&lt;/span>
&lt;a href="#%e8%bf%9c%e7%a8%8b%e8%b0%83%e8%af%95" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Go è¿œç¨‹è°ƒè¯•æœ¬åœ°æœºå™¨å’Œè¿œç¨‹æœºå™¨éƒ½éœ€è¦&lt;a href="https://github.com/derekparker/delve/blob/master/Documentation/installation/README.md" target="_blank" rel="noopener">å®‰è£… &amp;ldquo;delve&amp;rdquo;&lt;/a>ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code>$ go install github.com/go-delve/delve/cmd/dlv@latest&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å®‰è£…å®Œæˆåéœ€è¦é…ç½®è°ƒè¯•å·¥å…·ï¼Œç‚¹å‡»ä¾§è¾¹æ ä¸­çš„ &amp;ldquo;Run and Debug&amp;rdquo;ï¼Œç‚¹å‡» &amp;ldquo;create a launch.json file&amp;rdquo; ä¼šåœ¨ &lt;code>.vscode&lt;/code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªè¿è¡Œé…ç½®æ–‡ä»¶ &lt;code>launch.json&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä¸ªè°ƒè¯• Go ç¨‹åºçš„ &lt;code>launch.json&lt;/code> ç¤ºä¾‹ï¼š&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Use IntelliSense to learn about possible attributes.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// Hover to view descriptions of existing attributes.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nt">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;0.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;configurations&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Debug helm list -A&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;request&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;launch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;auto&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;program&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;${workspaceFolder}/cmd/helm&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;args&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;list&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-A&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;env&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;HELM_DRIVER&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;configmap&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Launch test function&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;request&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;launch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;test&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;program&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;${workspaceFolder}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;args&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;-test.run&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;MyTestFunction&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Launch executable&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;request&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;launch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;exec&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;program&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;absolute-path-to-the-executable&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Launch test package&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;request&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;launch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;test&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;program&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;${workspaceFolder}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;Attach to local process&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;type&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;go&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;request&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;attach&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mode&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;local&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;processId&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">12784&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>å¸¸ç”¨å±æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>type&lt;/code>ï¼šè°ƒè¯•å™¨ç±»å‹ã€‚&lt;code>node&lt;/code> ç”¨äºå†…ç½®çš„ Node è°ƒè¯•å™¨ï¼Œ&lt;code>php&lt;/code> å’Œ &lt;code>go&lt;/code> ç”¨äº PHP å’Œ Go æ‰©å±•ã€‚&lt;/li>
&lt;li>&lt;code>request&lt;/code>ï¼šå€¼å¯ä»¥æ˜¯ &lt;code>launch&lt;/code>ï¼Œ&lt;code>attach&lt;/code>ã€‚å½“éœ€è¦å¯¹ä¸€ä¸ªå·²ç»è¿è¡Œçš„çš„ç¨‹åº debug æ—¶æ‰ä½¿ç”¨ &lt;code>attach&lt;/code>ï¼Œå…¶ä»–æ—¶å€™ä½¿ç”¨ &lt;code>launch&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>mode&lt;/code>ï¼šå€¼å¯ä»¥æ˜¯ &lt;code>auto&lt;/code>ï¼Œ&lt;code>debug&lt;/code>ï¼Œ&lt;code>remote&lt;/code>ï¼Œ&lt;code>test&lt;/code>ï¼Œ&lt;code>exec&lt;/code>ã€‚ å¯¹äº &lt;code>attach&lt;/code> åªæœ‰ &lt;code>local&lt;/code>ï¼Œ&lt;code>remote&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>program&lt;/code>ï¼šå¯åŠ¨è°ƒè¯•å™¨æ—¶è¦è¿è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶æˆ–æ–‡ä»¶ã€‚&lt;/li>
&lt;li>&lt;code>args&lt;/code>ï¼š ä¼ é€’ç»™è°ƒè¯•ç¨‹åºçš„å‚æ•°ã€‚&lt;/li>
&lt;li>&lt;code>env&lt;/code>ï¼šç¯å¢ƒå˜é‡ï¼ˆç©ºå€¼å¯ç”¨äº &amp;ldquo;å–æ¶ˆå®šä¹‰ &amp;ldquo;å˜é‡ï¼‰ï¼Œ&lt;code>env&lt;/code> ä¸­çš„å€¼ä¼šè¦†ç›– &lt;code>envFile&lt;/code> ä¸­çš„å€¼ã€‚&lt;/li>
&lt;li>&lt;code>envFile&lt;/code>ï¼šåŒ…å«ç¯å¢ƒå˜é‡çš„ dotenv æ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/li>
&lt;li>&lt;code>cwd&lt;/code>ï¼šå½“å‰å·¥ä½œç›®å½•ï¼Œç”¨äºæŸ¥æ‰¾ä¾èµ–æ–‡ä»¶å’Œå…¶ä»–æ–‡ä»¶ã€‚&lt;/li>
&lt;li>&lt;code>port&lt;/code>ï¼šè¿æ¥åˆ°è¿è¡Œè¿›ç¨‹æ—¶çš„ç«¯å£ã€‚&lt;/li>
&lt;li>&lt;code>stopOnEntry&lt;/code>ï¼šç¨‹åºå¯åŠ¨æ—¶ç«‹å³ä¸­æ–­ã€‚&lt;/li>
&lt;li>&lt;code>console&lt;/code>ï¼šä½¿ç”¨å“ªç§æ§åˆ¶å°ï¼Œä¾‹å¦‚å†…éƒ¨æ§åˆ¶å°ã€é›†æˆç»ˆç«¯æˆ–å¤–éƒ¨ç»ˆç«¯ã€‚&lt;/li>
&lt;li>&lt;code>showLog&lt;/code>ï¼šæ˜¯å¦åœ¨è°ƒè¯•æ§åˆ¶å°æ‰“å°æ—¥å¿—, ä¸€èˆ¬ä¸º &lt;code>true&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>buildFlags&lt;/code>ï¼šæ„å»ºç¨‹åºæ—¶éœ€è¦ä¼ é€’ç»™ Go ç¼–è¯‘å™¨çš„ Flagsï¼Œä¾‹å¦‚ &lt;code>-tags=your_tag&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>remotePath&lt;/code>ï¼š&lt;code>mode&lt;/code> ä¸º &lt;code>remote&lt;/code> æ—¶, éœ€è¦æŒ‡å®šè°ƒè¯•æ–‡ä»¶æ‰€åœ¨æœåŠ¡å™¨çš„ç»å¯¹è·¯å¾„ã€‚&lt;/li>
&lt;li>&lt;code>processId&lt;/code>ï¼šè¿›ç¨‹ idã€‚&lt;/li>
&lt;li>&lt;code>host&lt;/code>ï¼šç›®æ ‡æœåŠ¡å™¨åœ°å€ã€‚&lt;/li>
&lt;li>&lt;code>port&lt;/code>ï¼šç›®æ ‡ç«¯å£ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¸¸ç”¨çš„å˜é‡ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>${workspaceFolder}&lt;/code> è°ƒè¯•å·¥ä½œç©ºé—´ä¸‹çš„æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚&lt;/li>
&lt;li>&lt;code>${file}&lt;/code> è°ƒè¯•å½“å‰æ–‡ä»¶ã€‚&lt;/li>
&lt;li>&lt;code>${fileDirname}&lt;/code> è°ƒè¯•å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šçš„å±æ€§å’Œå˜é‡å¯ä»¥æŸ¥çœ‹ &lt;a href="https://code.visualstudio.com/docs/editor/debugging" target="_blank" rel="noopener">VS Code Debugging æ–‡æ¡£&lt;/a>ã€‚&lt;/p>
&lt;p>é…ç½®å¥½ &lt;code>launch.json&lt;/code> åï¼Œåœ¨ä»£ç ä¸Šæ‰“ä¸Šæ–­ç‚¹ï¼Œæ‰“å¼€ä¾§è¾¹æ çš„ &amp;ldquo;Run and Debug&amp;rdquo;ï¼Œé€‰æ‹©è¿è¡Œçš„é…ç½®ï¼Œå°±å¯ä»¥å¼€å§‹è°ƒè¯•äº†ã€‚&lt;/p></description></item></channel></rss>